var ae=Object.defineProperty,oe=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var P=(n,d,p)=>d in n?ae(n,d,{enumerable:!0,configurable:!0,writable:!0,value:p}):n[d]=p,S=(n,d)=>{for(var p in d||(d={}))ue.call(d,p)&&P(n,p,d[p]);if(R)for(var p of R(d))ne.call(d,p)&&P(n,p,d[p]);return n},H=(n,d)=>oe(n,le(d));import{r as se,A as de,E as ie,_ as O,s as w,N as re}from"./index.1653003640069.js";import{a as $,m as L,Z as e,a3 as W,ag as Y,a2 as r,o as E,R as B,S as t,e as i,u as l,T,U as X,b as I,F as pe,a7 as ce,W as A,Y as V,az as Z,aA as G,X as h,ap as _e,aB as me,j as fe,O as ge,l as he}from"./vue.1653003640069.js";import{g as be,a as ve,c as xe}from"./translate.1653003640069.js";import{B as k}from"./store.1653003640069.js";const ye=async(n,d,p)=>{Fe(d,p),se.push({path:n.url+"/edit",query:{id:n.form.id}})},Fe=(n,d)=>{n.mittBus.emit("onCurrentContextmenuClick",Object.assign({},S({contextMenuClickId:1},d)))},j=n=>{n||window.close(),de.service({lock:!0,fullscreen:!0,spinner:"el-icon-loading",text:"",background:"rgba(0, 0, 0, 0.1)"}),ie({showClose:!0,message:"\u4FDD\u5B58\u6210\u529F\uFF0C"+n/1e3+"\u79D2\u540E\u9875\u9762\u6309\u81EA\u52A8\u5173\u95ED",type:"success",duration:n}),setTimeout(()=>{window.close()},n)};var Ee=$({name:"Modeler2",emits:["bpmnMounted"],setup(n,{emit:d}){const p=k;return L(()=>{p.initModeler({container:"#modeler-container",additionalModules:[{translate:["value",be("zh")],paletteProvider:["value",""],labelEditingProvider:["value",""],contextPadProvider:["value",""],bendpoints:["value",{}],zoomScroll:["value",""],move:["value",""]}],moddleExtensions:{activiti:ve}});const u="1";p.importXML(xe(u,u)).then(a=>{a.length&&console.warn("importSuccess warnings",a)}).catch(a=>{console.warn("importFail errors ",a)}),d("bpmnMounted")}),()=>e("div",{id:"modeler-container"},null)}});const N=n=>(Z("data-v-2f8741ba"),n=n(),G(),n),we=N(()=>i("div",{class:"zinput"}," \u8FD9\u662F\u4E00\u4E2A\u6D4B\u8BD5\u7684\u6D41\u7A0B\uFF0C\u76EE\u524D\u529F\u80FD\u8FD8\u4E0D\u5B8C\u5584 ",-1)),Ce={style:{"padding-left":"10px","border-right":"1px solid #ccc"}},Be=h("\u663E\u793A\u5BA1\u6279\u8BB0\u5F55"),De={style:{"border-right":"1px solid #ccc"}},Ae={key:0},Ve={class:"zinput"},ke=N(()=>i("span",null,"\u4E00\u822C",-1)),Ne=N(()=>i("span",{style:{color:"blue"}},"\u6025",-1)),ze=N(()=>i("span",{style:{color:"red"}},"\u7D27\u6025",-1)),Me={class:"zinput"},Se=h("\u901A\u8FC7"),Ie=h("\u9A73\u56DE"),$e=h("\u8F6C\u529E"),Le=h("\u6C9F\u901A"),Ue=h("\u5E9F\u5F03"),qe={class:"zinput"},Re=h("\u9A73\u56DE\u7684\u8282\u70B9\u901A\u8FC7\u540E\u76F4\u63A5\u8FD4\u56DE\u672C\u8282\u70B9"),Pe={class:"zinput"},He={class:"zinput",style:{height:"auto"}},Te={class:"au-flex"},Xe={class:"au-msg",style:{padding:"3px"}},je={class:"au-button"},Oe=h("\u63D0 \u4EA4"),We={class:"zinput",style:{height:"auto"}},Ye=h("\u4E0A \u4F20"),Ze={class:"zinput"},Ge={class:"zinput"},Je={style:{"padding-left":"10px","border-right":"1px solid #ccc"}},Ke=h("\u6D41\u7A0B\u56FE"),Qe={style:{padding:"10px","border-right":"1px solid #ccc",height:"1000px"}},et=$({props:{proid:String},emits:["submit"],setup(n,{emit:d}){const p=n,u=W({form:{items:[]},params:{path:"",query:""},audits:[],chtag:!0,autag:!0,xml:null,refNodes:[],cutag:!1,hiHamen:"",cuExmen:"",toExmen:""}),{form:a,params:z,audits:D}=Y(u);u.refNodes=[{id:"N2",name:"\u8D77\u8349\u8282\u70B9",exman:"sa"},{id:"N4",name:"\u5F20\u4E09",exman:"z3"},{id:"N5",name:"\u738B\u4E94",exman:"w5"}],L(async()=>{await M(),await b()});const M=async()=>{const s=await w({url:"/bpm/proc/main/zbpm/"+p.proid,method:"get"});if(D.value=s.audits,u.hiHamen=s.hiHamen,u.cuExmen=s.cuExmen,u.cutag=s.cutag,a.value=s.zbpm,u.cutag){const o=await w({url:"/bpm/proc/main/target",method:"get",params:{proid:a.value.proid,facno:a.value.facno}});a.value.tarno=o.tarno,a.value.tarna=o.tarna,a.value.tamen=o.tamen,a.value.bacid=o.bacid,o.tarno=="N3"?u.toExmen=o.tarno+"."+o.tarna:u.toExmen=o.tarno+"."+o.tarna+"("+o.tamen+")",a.value.opkey="pass",a.value.opurg="a"}},v=async()=>{if(a.value.opkey=="pass")await w({url:"/bpm/proc/main/hpass",method:"post",data:a.value});else if(a.value.opkey=="refuse"){const s=_e(a.value);s.tarno=s.refno,s.tarna=s.refna,s.exman=s.reman,await w({url:"/bpm/proc/main/hrefuse",method:"post",data:s})}console.log("86811"),d("submit"),console.log("86822")},b=async()=>{if(!u.xml){u.xml=await w({url:"/bpm/proc/main/xml/"+p.proid,method:"get"}),await k.importXML(u.xml);const s=k.getModeler().get("elementRegistry");console.log(s);const o=[];s.forEach(f=>{(f.id=="L7"||f.id=="N1"||f.id=="N2")&&o.push(f)});const g=[];s.forEach(f=>{f.id=="N4"&&g.push(f)});const c=[];s.forEach(f=>{(f.id=="L1"||f.id=="L3")&&c.push(f)});let _=k.modeler.get("modeling");_.setColor(o,{fill:"#e4feef"}),_.setColor(g,{fill:"#fed6d6"}),_.setColor(c,{stroke:"#009900"})}},x=s=>{for(let o=0;o<u.refNodes.length;o++)if(u.refNodes[o].id==s){a.value.refna=u.refNodes[o].name,a.value.reman=u.refNodes[o].exman;break}};return(s,o)=>{const g=r("el-form-item"),c=r("el-col"),_=r("el-row"),f=r("el-checkbox"),y=r("el-table-column"),C=r("el-table"),F=r("el-radio"),U=r("el-radio-group"),J=r("el-option"),K=r("el-select"),Q=r("el-input"),q=r("el-button"),ee=r("el-upload"),te=r("el-form");return E(),B(te,{class:"zform",model:l(a),"label-width":"160px","label-position":"left"},{default:t(()=>[e(_,{style:{"border-top":"1px solid #d2d2d2"}},{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u6D41\u7A0B\u8BF4\u660E",style:{"margin-left":"10px"}},{default:t(()=>[we]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[i("div",Ce,[e(f,{modelValue:l(u).autag,"onUpdate:modelValue":o[0]||(o[0]=m=>l(u).autag=m)},{default:t(()=>[Be]),_:1},8,["modelValue"])])]),_:1})]),_:1}),T(e(_,null,{default:t(()=>[e(c,{span:24,style:{"background-color":"white"}},{default:t(()=>[i("div",De,[e(C,{data:l(D),style:{width:"100%"}},{default:t(()=>[e(y,{prop:"crtim",label:"\u65F6\u95F4",width:"160"}),e(y,{prop:"facno",label:"\u8282\u70B9\u7F16\u53F7",width:"80"}),e(y,{prop:"facna",label:"\u8282\u70B9\u540D\u79F0",width:"200"}),e(y,{prop:"haman",label:"\u64CD\u4F5C\u8005",width:"90"}),e(y,{prop:"opinf",label:"\u64CD\u4F5C",width:"300"}),e(y,{prop:"opnot",label:"\u5904\u7406\u610F\u89C1"})]),_:1},8,["data"])])]),_:1})]),_:1},512),[[X,l(u).autag]]),l(u).cutag?(E(),I("div",Ae,[e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u901A\u77E5\u7D27\u6025\u7A0B\u5EA6",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Ve,[e(U,{modelValue:l(a).opurg,"onUpdate:modelValue":o[1]||(o[1]=m=>l(a).opurg=m)},{default:t(()=>[e(F,{label:"a"},{default:t(()=>[ke]),_:1}),e(F,{label:"b"},{default:t(()=>[Ne]),_:1}),e(F,{label:"c"},{default:t(()=>[ze]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u64CD\u4F5C",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Me,[e(U,{modelValue:l(a).opkey,"onUpdate:modelValue":o[2]||(o[2]=m=>l(a).opkey=m)},{default:t(()=>[e(F,{label:"pass"},{default:t(()=>[Se]),_:1}),e(F,{label:"refuse"},{default:t(()=>[Ie]),_:1}),e(F,{label:"commission"},{default:t(()=>[$e]),_:1}),e(F,{label:"communicate"},{default:t(()=>[Le]),_:1}),e(F,{label:"abandon"},{default:t(()=>[Ue]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1}),l(a).opkey=="refuse"?(E(),B(_,{key:0},{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u9A73\u56DE\u5230",style:{"margin-left":"10px"}},{default:t(()=>[i("div",qe,[e(K,{modelValue:l(a).refno,"onUpdate:modelValue":o[3]||(o[3]=m=>l(a).refno=m),placeholder:"\u8BF7\u9009\u62E9",style:{width:"300px","margin-right":"8px"},onChange:x},{default:t(()=>[(E(!0),I(pe,null,ce(l(u).refNodes,m=>(E(),B(J,{key:m.id,value:m.id,label:m.id+"."+m.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),e(f,{modelValue:l(a).retag,"onUpdate:modelValue":o[4]||(o[4]=m=>l(a).retag=m)},{default:t(()=>[Re]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1})):A("",!0),l(a).opkey=="pass"?(E(),B(_,{key:1},{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u5373\u5C06\u6D41\u5411",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Pe,V(l(u).toExmen),1)]),_:1})]),_:1})]),_:1})):A("",!0),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u5904\u7406\u610F\u89C1",style:{"margin-left":"10px"}},{default:t(()=>[i("div",He,[i("div",Te,[i("div",Xe,[e(Q,{modelValue:l(a).opnot,"onUpdate:modelValue":o[5]||(o[5]=m=>l(a).opnot=m),type:"textarea",rows:4,placeholder:" "},null,8,["modelValue"])]),i("div",je,[e(q,{type:"primary",onClick:o[6]||(o[6]=m=>v()),style:{width:"94px",height:"94px","margin-top":"3px","margin-left":"6px"}},{default:t(()=>[Oe]),_:1})])])])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u9644\u4EF6",style:{"margin-left":"10px"}},{default:t(()=>[i("div",We,[e(ee,{class:"upload-demo",action:"https://jsonplaceholder.typicode.com/posts/","file-list":s.fileList},{default:t(()=>[e(q,{type:"primary"},{default:t(()=>[Ye]),_:1})]),_:1},8,["file-list"])])]),_:1})]),_:1})]),_:1})])):A("",!0),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u5F53\u524D\u5904\u7406\u4EBA",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Ze,V(l(a).facno+"."+l(a).facna+"("+l(u).cuExmen+")"),1)]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[e(g,{label:"\u5DF2\u7ECF\u5904\u7406\u4EBA",style:{"margin-left":"10px"}},{default:t(()=>[i("div",Ge,V(l(u).hiHamen),1)]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{span:24},{default:t(()=>[i("div",Je,[e(f,{modelValue:l(u).chtag,"onUpdate:modelValue":o[7]||(o[7]=m=>l(u).chtag=m),onChange:b},{default:t(()=>[Ke]),_:1},8,["modelValue"])])]),_:1})]),_:1}),T(e(_,null,{default:t(()=>[e(c,{span:24,style:{"background-color":"white"}},{default:t(()=>[i("div",Qe,[e(l(Ee))])]),_:1})]),_:1},512),[[X,l(u).chtag]])]),_:1},8,["model"])}}});var tt=O(et,[["__scopeId","data-v-2f8741ba"]]);const at=n=>(Z("data-v-2fb01e9a"),n=n(),G(),n),ot=at(()=>i("div",{style:{"line-height":"32px"}},"\u6D41\u7A0B\u5B9E\u4F8B",-1)),lt=h("\u7F16 \u8F91"),ut=h("\u5173 \u95ED"),nt={style:{"margin-top":"8px","margin-bottom":"8px"}},st={class:"zinput"},dt=["src"],it={name:"oaFlowMainView"},rt=$(H(S({},it),{setup(n){const d=me(),{proxy:p}=he(),u=W({url:"/oa/flow/main",params:{path:"",query:""},form:{}}),{form:a}=Y(u),z=fe("tab1"),D=async(v,b)=>{var s;v.params=b;let x=(s=v.params.query)==null?void 0:s.id;x&&(v.form=await w({url:v.url+"/one/"+x,method:"get"}))},M=()=>{console.log("submit"),j(2e3)};return L(()=>{re.done(),D(u,d)}),(v,b)=>{const x=r("el-col"),s=r("el-button"),o=r("el-row"),g=r("el-form-item"),c=r("el-tab-pane"),_=r("el-tabs"),f=r("el-form"),y=r("el-card");return E(),I("div",{style:ge({height:"calc(100vh)"}),class:"zpage"},[e(y,{class:"box-card","body-style":{padding:"2px 8px"},shadow:"never"},{header:t(()=>[e(o,null,{default:t(()=>[e(x,{span:10},{default:t(()=>[ot]),_:1}),e(x,{span:14,style:{"text-align":"right"}},{default:t(()=>[e(s,{type:"success",onClick:b[0]||(b[0]=C=>l(ye)(l(u),l(p),l(d))),plain:""},{default:t(()=>[lt]),_:1}),e(s,{type:"info",onClick:b[1]||(b[1]=C=>l(j)()),plain:""},{default:t(()=>[ut]),_:1})]),_:1})]),_:1})]),default:t(()=>[i("div",nt,[e(f,{class:"zform",model:l(a),"label-width":"140px"},{default:t(()=>[e(_,{type:"card",modelValue:z.value,"onUpdate:modelValue":b[2]||(b[2]=C=>z.value=C)},{default:t(()=>[e(c,{label:"\u5BA1\u6279\u5185\u5BB9",name:"tab1"},{default:t(()=>[e(o,{style:{"border-top":"1px solid #d2d2d2"}},{default:t(()=>[e(x,{span:24},{default:t(()=>[e(g,{label:"\u7533\u8BF7\u6807\u9898\uFF1A",prop:"name",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:t(()=>[i("div",st,V(l(a).name),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{label:"\u6D41\u7A0B\u5904\u7406",name:"tab2"},{default:t(()=>[l(a).id?(E(),B(tt,{key:0,onSubmit:M,proid:l(a).id},null,8,["proid"])):A("",!0)]),_:1}),e(c,{label:"\u6743\u9650\u4FE1\u606F",name:"tab3"},{default:t(()=>[i("img",{src:v.qx,style:{width:"100%"}},null,8,dt)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])])]),_:1})],4)}}}));var gt=O(rt,[["__scopeId","data-v-2fb01e9a"]]);export{gt as default};
