var O=Object.defineProperty,G=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var S=(t,n,e)=>n in t?O(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,w=(t,n)=>{for(var e in n||(n={}))q.call(n,e)&&S(t,e,n[e]);if(k)for(var e of k(n))z.call(n,e)&&S(t,e,n[e]);return t},C=(t,n)=>G(t,j(n));var R=(t,n,e)=>new Promise((o,i)=>{var l=s=>{try{d(e.next(s))}catch(m){i(m)}},r=s=>{try{d(e.throw(s))}catch(m){i(m)}},d=s=>s.done?o(s.value):Promise.resolve(s.value).then(l,r);d((e=e.apply(t,n)).next())});import{A as K,r as Y,P as H,S as Q,B as P,D as h,w as f,a6 as U,u as g,J as W,ad as X,n as B,ao as y,ae as b}from"./vendor.af2fe88b.js";import{B as Z}from"./TableImg.ae08a7e1.js";import{T as ee}from"./BasicForm.84475e4b.js";import{u as te}from"./useTable.3b4e656a.js";import{_ as ae,h as ne}from"./index.6733effe.js";import{B as p,T as ie}from"./store.79fec13d.js";const oe={class:"sublist-div"},le=K({props:{value:{type:Array,default:()=>[],required:!0},columns:{type:Array,required:!0},model:{type:Object,default:()=>Object.assign({})},tableProps:{type:Object,default:()=>({striped:!0,bordered:!0,size:"small",canResize:!1,pagination:!1,showIndexColumn:!1,showTableSetting:!1,tableSetting:{fullScreen:!0},locale:{emptyText:"\u6CA1\u6709\u6570\u636E"}})},addTitle:{type:String,default:()=>"+ \u6DFB\u52A0"}},emits:["update:value"],setup(t,{emit:n}){const e=t,{createMessage:o}=ne(),i=Y(""),l=H({data:e.value?JSON.parse(JSON.stringify(e.value)):[],editing:!1,isNew:!1}),[r,{insertTableDataRecord:d,deleteTableDataRecord:s,setTableData:m,getDataSource:x}]=te(C(w({},e.tableProps),{dataSource:l.data,scroll:{x:0},columns:e.columns,actionColumn:{title:"\u64CD\u4F5C",dataIndex:"action",fixed:!1,slots:{customRender:"action"}}})),N=()=>{l.data=e.value?JSON.parse(JSON.stringify(e.value)):[],l.editing=!1,l.isNew=!1};Q(()=>e.value,()=>{N()});const _=()=>R(this,null,function*(){var c;let a=x();a.length===0?yield m([B(e.model)]):yield d(B(e.model)),a=x();const u=a[a.length-1];i.value=u.key,yield(c=u.onEdit)==null?void 0:c.call(u,!0),l.editing=!0,l.isNew=!0});function I(a){var u;i.value=a.key,(u=a.onEdit)==null||u.call(a,!0)}function V(a){var u;l.isNew?s(a.key):(u=a.onEdit)==null||u.call(a,!1,!1),l.isNew=!1,l.editing=!1,i.value=""}function L(a){i.value="",l.isNew=!1,l.editing=!1,s(a.key),n("update:value",l.data)}function $(a){return R(this,null,function*(){var c,v;if(o.loading({content:"\u6B63\u5728\u4FDD\u5B58...",duration:0,key:"saving"}),yield(c=a.onValid)==null?void 0:c.call(a))try{let T=x(),E=[];T.map(J=>{E.push(J.editValueRefs)}),console.log(E),n("update:value",E),(yield(v=a.onEdit)==null?void 0:v.call(a,!1,!0))&&(i.value=""),l.isNew=!1,l.editing=!1,o.success({content:"\u6570\u636E\u5DF2\u4FDD\u5B58",key:"saving"})}catch(T){o.error({content:"\u4FDD\u5B58\u5931\u8D25",key:"saving"})}else o.error({content:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u6570\u636E",key:"saving"})})}function A(a,u){return a.editable?[{label:"\u4FDD\u5B58",onClick:$.bind(null,a,u)},{label:"\u53D6\u6D88",popConfirm:{title:"\u662F\u5426\u53D6\u6D88\u7F16\u8F91",confirm:V.bind(null,a,u)}}]:[{label:"\u7F16\u8F91",disabled:i.value?i.value!==a.key:!1,onClick:I.bind(null,a)},{label:"\u5220\u9664",disabled:i.value?i.value!==a.key:!1,popConfirm:{title:"\u662F\u5426\u5220\u9664",confirm:L.bind(null,a)}}]}const M=({column:a,value:u,record:c})=>{a.dataIndex==="id"&&(c.editValueRefs.name4.value=`${u}`)};return(a,u)=>(P(),h("div",oe,[f(g(Z),{onRegister:g(r),onEditChange:M},{action:U(({record:c,column:v})=>[f(g(ee),{actions:A(c,v)},null,8,["actions"])]),_:1},8,["onRegister"]),g(l).editing?X("",!0):(P(),h("div",{key:0,class:"sublist-add",onClick:_},W(t.addTitle),1))]))}});var D=ae(le,[["__scopeId","data-v-7bccfb2c"]]);const se={id:{component:y,placeholder:"\u8282\u70B9\u7F16\u53F7",vSlots:{addonBefore:()=>f("div",null,[b("\u8282\u70B9\u7F16\u53F7")])},setValue(t,n,e){const o=e,i=e||" ",l=p.getShape();p.getModeling().updateProperties(l,{[n]:o?i.trim():i})}},name:{component:y,placeholder:"\u8282\u70B9\u540D\u79F0",vSlots:{addonBefore:()=>f("div",null,[b("\u8282\u70B9\u540D\u79F0")])}}},xe={name:"\u57FA\u7840\u4FE1\u606F",icon:"ant-design:info-circle-filled",properties:w({},se)},Ee={name:"\u5143\u7D20\u6587\u6863",icon:"el-icon-document",properties:{"documentation.text":{component:y.TextArea,type:"textarea",allowClear:"allow-clear",getValue:t=>{var n,e;return(e=(n=t.documentation)==null?void 0:n[0])==null?void 0:e.text},setValue(t,n,e){p.createElement("bpmn:Documentation","documentation",{text:e},!0)}}}},ue=[{label:"\u5F00\u59CB",value:"start"},{label:"\u7ED3\u675F",value:"end"}],re=[{label:"java\u7C7B",value:"class"},{label:"\u8C03\u7528\u8868\u8FBE\u5F0F",value:"expression"},{label:"\u6CE8\u5165\u8868\u8FBE\u5F0F",value:"delegateExpression"}],F=Object.keys(ie),we=function(t){const n=t.eventOptions||ue;return{name:t.name||"\u76D1\u542C\u5668",icon:t.icon||"ant-design:monitor-outlined",properties:{"extensionElements.listeners":{component:D,columns:[{dataIndex:"index",title:"\u5E8F\u53F7",align:"center",width:50,editRow:!1,customRender:({index:e})=>`${e+1}`},{title:"\u4E8B\u4EF6",dataIndex:"event",align:"center",editRow:!0,editRule:!0,editComponent:"Select",editComponentProps:{options:n}},{title:"\u6267\u884C\u7C7B\u578B",dataIndex:"type",align:"center",editRow:!0,editRule:!0,editComponent:"Select",editComponentProps:{options:re}},{dataIndex:"content",title:"\u6267\u884C\u5185\u5BB9",editRule:!0,align:"center",editRow:!0}],getValue:e=>{var i,l,r;const o=F.includes(e.$type)?"activiti:TaskListener":"activiti:ExecutionListener";return(r=(l=(i=e==null?void 0:e.extensionElements)==null?void 0:i.values)==null?void 0:l.filter(d=>d.$type===o))==null?void 0:r.map(d=>{const s=d.expression?"expression":d.delegateExpression?"delegateExpression":"class";return{event:d.event,type:s,content:d[s]}})},setValue(e,o,i){const l=p;console.warn("activeBusinessObject",e);const r=l.getModeler().get("moddle"),d=F.includes(e.$type)?"activiti:TaskListener":"activiti:ExecutionListener";l.updateExtensionElements(d,i.map(s=>r.create(d,{event:s.event,[s.type]:s.content})))}}}}},Re={name:"\u6269\u5C55\u5C5E\u6027",icon:"ant-design:file-add-outlined",properties:{"extensionElements.properties":{component:D,columns:[{dataIndex:"index",title:"\u5E8F\u53F7",width:50,align:"center",editRow:!1,customRender:({index:t})=>`${t+1}`},{dataIndex:"name",title:"\u5C5E\u6027\u540D",editRule:!0,align:"center",editRow:!0},{dataIndex:"value",title:"\u5C5E\u6027\u503C",editRule:!0,align:"center",editRow:!0}],getValue:t=>{var n,e,o;return(o=(e=(n=t==null?void 0:t.extensionElements)==null?void 0:n.values)==null?void 0:e.filter(i=>i.$type==="activiti:Properties")[0])==null?void 0:o.values.map(i=>({name:i.name,value:i.value}))},setValue(t,n,e){const o=p,i=o.getModeler().get("moddle"),l=i.create("activiti:Properties",{values:e.map(r=>i.create("activiti:Property",{name:r.name,value:r.value}))});o.updateExtensionElements("activiti:Properties",l)}}}},be={name:"\u8868\u5355\u4FE1\u606F",icon:"el-icon-edit",properties:{formKey:{component:y,placeholder:"\u8868\u5355key",vSlots:{addonBefore:()=>f("div",null,[b("\u8868\u5355key")])}},"extensionElements.formProperty":{component:D,columns:[{dataIndex:"id",title:"\u7F16\u7801",editRule:!0,align:"center",editRow:!0},{dataIndex:"type",title:"\u7C7B\u578B",editRule:!0,align:"center",editRow:!0},{dataIndex:"name",title:"\u540D\u79F0",editRule:!0,align:"center",editRow:!0}],getValue:t=>{var n,e;return(e=(n=t==null?void 0:t.extensionElements)==null?void 0:n.values)==null?void 0:e.filter(o=>o.$type==="activiti:FormProperty").map(o=>{var i;return console.warn("elem",o),{id:o==null?void 0:o.id,type:o.type,name:(i=o==null?void 0:o.$attrs)==null?void 0:i.name}})},setValue(t,n,e){const o=p,i=o.getModeler().get("moddle"),l=e.map(r=>i.create("activiti:FormProperty",{id:r.id,name:r.name,type:r.type}));o.updateExtensionElements("activiti:FormProperty",l)}}}};export{xe as C,Ee as D,Re as E,be as F,we as g};
