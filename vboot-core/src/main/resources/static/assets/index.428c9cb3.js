var tg=Object.defineProperty,ng=Object.defineProperties;var ig=Object.getOwnPropertyDescriptors;var yl=Object.getOwnPropertySymbols;var rg=Object.prototype.hasOwnProperty,ag=Object.prototype.propertyIsEnumerable;var El=(e,t,n)=>t in e?tg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bl=(e,t)=>{for(var n in t||(t={}))rg.call(t,n)&&El(e,n,t[n]);if(yl)for(var n of yl(t))ag.call(t,n)&&El(e,n,t[n]);return e},xl=(e,t)=>ng(e,ig(t));import{P as og}from"./index.4a6d20cf.js";import{I as _l}from"./index.esm.eaa71f61.js";import{b$ as ds,P as sg,$ as wl,t as cg,A as ug,_ as lg,B as pg,a1 as fg,a6 as hg,u as dg,H as vg}from"./vendor.8e08a5be.js";import"./index.1f50be75.js";/* empty css               *//* empty css                */import"./useWindowSizeFn.2016176c.js";import"./useContentViewHeight.78015564.js";var vs={exports:{}};typeof Object.create=="function"?vs.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:vs.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}};var Z=vs.exports;function la(e){return Array.prototype.concat.apply([],e)}var er=Object.prototype.toString,mg=Object.prototype.hasOwnProperty;function tr(e){return e===void 0}function Zt(e){return e!==void 0}function Sl(e){return e==null}function fe(e){return er.call(e)==="[object Array]"}function Ze(e){return er.call(e)==="[object Object]"}function ae(e){return er.call(e)==="[object Number]"}function at(e){var t=er.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"||t==="[object Proxy]"}function Pt(e){return er.call(e)==="[object String]"}function gg(e){if(!fe(e))throw new Error("must supply array")}function hn(e,t){return mg.call(e,t)}function _e(e,t){t=ys(t);var n;return C(e,function(i,r){if(t(i,r))return n=i,!1}),n}function yg(e,t){t=ys(t);var n=fe(e)?-1:void 0;return C(e,function(i,r){if(t(i,r))return n=r,!1}),n}function se(e,t){var n=[];return C(e,function(i,r){t(i,r)&&n.push(i)}),n}function C(e,t){var n,i;if(!tr(e)){var r=fe(e)?_g:xg;for(var a in e)if(hn(e,a)&&(n=e[a],i=t(n,r(a)),i===!1))return n}}function Eg(e,t){return tr(e)?[]:(gg(e),t=ys(t),e.filter(function(n,i){return!t(n,i)}))}function bt(e,t,n){return C(e,function(i,r){n=t(n,i,r)}),n}function yi(e,t){return!!bt(e,function(n,i,r){return n&&t(i,r)},!0)}function Jn(e,t){return!!_e(e,t)}function Ye(e,t){var n=[];return C(e,function(i,r){n.push(t(i,r))}),n}function pa(e){return e&&Object.keys(e)||[]}function nr(e){return pa(e).length}function ms(e){return Ye(e,function(t){return t})}function Ei(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=gs(t),C(e,function(i){var r=t(i)||"_",a=n[r];a||(a=n[r]=[]),a.push(i)}),n}function Tl(e){e=gs(e);for(var t={},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];C(i,function(o){return Ei(o,e,t)});var a=Ye(t,function(o,s){return o[0]});return a}var bg=Tl;function jt(e,t){t=gs(t);var n=[];return C(e,function(i,r){for(var a=t(i,r),o={d:a,v:i},s=0;s<n.length;s++){var c=n[s].d;if(a<c){n.splice(s,0,o);return}}n.push(o)}),Ye(n,function(i){return i.v})}function Ht(e){return function(t){return yi(e,function(n,i){return t[i]===n})}}function gs(e){return at(e)?e:function(t){return t[e]}}function ys(e){return at(e)?e:function(t){return t===e}}function xg(e){return e}function _g(e){return Number(e)}function Rl(e,t){var n,i,r,a;function o(p){var h=Date.now(),f=p?0:a+t-h;if(f>0)return s(f);e.apply(r,i),c()}function s(p){n=setTimeout(o,p)}function c(){n&&clearTimeout(n),n=a=i=r=void 0}function u(){n&&o(!0),c()}function l(){a=Date.now();for(var p=arguments.length,h=new Array(p),f=0;f<p;f++)h[f]=arguments[f];i=h,r=this,n||s(t)}return l.flush=u,l.cancel=c,l}function pt(e,t){return e.bind(t)}function Es(){return Es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Es.apply(this,arguments)}function I(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Es.apply(void 0,[e].concat(n))}function zt(e,t){var n={},i=Object(e);return C(t,function(r){r in i&&(n[r]=e[r])}),n}function Pn(e,t){var n={},i=Object(e);return C(i,function(r,a){t.indexOf(a)===-1&&(n[a]=r)}),n}function xt(e,t,n){return arguments.length==2?e.getAttribute(t):n===null?e.removeAttribute(t):(e.setAttribute(t,n),e)}var wg=[].indexOf,bs=function(e,t){if(wg)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},Sg=/\s+/,Tg=Object.prototype.toString;function je(e){return new An(e)}function An(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}An.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=bs(t,e);return~n||t.push(e),this.el.className=t.join(" "),this};An.prototype.remove=function(e){if(Tg.call(e)=="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=bs(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this};An.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};An.prototype.toggle=function(e,t){return this.list?(typeof t!="undefined"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t!="undefined"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};An.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(Sg);return n[0]===""&&n.shift(),n};An.prototype.has=An.prototype.contains=function(e){return this.list?this.list.contains(e):!!~bs(this.array(),e)};function fa(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}var bi=typeof Element!="undefined"?Element.prototype:{},Cl=bi.matches||bi.matchesSelector||bi.webkitMatchesSelector||bi.mozMatchesSelector||bi.msMatchesSelector||bi.oMatchesSelector,ha=Rg;function Rg(e,t){if(!e||e.nodeType!==1)return!1;if(Cl)return Cl.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1}function ei(e,t,n){for(var i=n?e:e.parentNode;i&&i.nodeType!==document.DOCUMENT_NODE&&i.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(ha(i,t))return i;i=i.parentNode}return ha(i,t)?i:null}var Pl=window.addEventListener?"addEventListener":"attachEvent",Cg=window.removeEventListener?"removeEventListener":"detachEvent",Al=Pl!=="addEventListener"?"on":"",Pg=function(e,t,n,i){return e[Pl](Al+t,n,i||!1),n},Ag=function(e,t,n,i){return e[Cg](Al+t,n,i||!1),n},te={bind:Pg,unbind:Ag},Ml=["focus","blur"];function Mg(e,t,n,i,r){return Ml.indexOf(n)!==-1&&(r=!0),te.bind(e,n,function(a){var o=a.target||a.srcElement;a.delegateTarget=ei(o,t,!0),a.delegateTarget&&i.call(e,a)},r)}function Dg(e,t,n,i){return Ml.indexOf(t)!==-1&&(i=!0),te.unbind(e,t,n,i)}var _t={bind:Mg,unbind:Dg},Ce=Ng,Dl=!1,da;typeof document!="undefined"&&(da=document.createElement("div"),da.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Dl=!da.getElementsByTagName("link").length,da=void 0);var He={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Dl?[1,"X<div>","</div>"]:[0,"",""]};He.td=He.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];He.option=He.optgroup=[1,'<select multiple="multiple">',"</select>"];He.thead=He.tbody=He.colgroup=He.caption=He.tfoot=[1,"<table>","</table>"];He.polyline=He.ellipse=He.polygon=He.circle=He.text=He.line=He.path=He.rect=He.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function Ng(e,t){if(typeof e!="string")throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if(i=="body"){var c=t.createElement("html");return c.innerHTML=e,c.removeChild(c.lastChild)}var r=He[i]||He._default,a=r[0],o=r[1],s=r[2],c=t.createElement("div");for(c.innerHTML=o+e+s;a--;)c=c.lastChild;if(c.firstChild==c.lastChild)return c.removeChild(c.firstChild);for(var u=t.createDocumentFragment();c.firstChild;)u.appendChild(c.removeChild(c.firstChild));return u}function Oe(e,t){return t=t||document,t.querySelector(e)}function xs(e,t){return t=t||document,t.querySelectorAll(e)}function Qt(e){e.parentNode&&e.parentNode.removeChild(e)}function Og(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(n){}return e}function Nl(e,t){return t.appendChild(Og(e,t))}function ne(e,t){return Nl(t,e),e}var _s=2,Ol={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":_s,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":_s,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function Ig(e,t){return Ol[t]?e.style[t]:e.getAttributeNS(null,t)}function Il(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=Ol[i];r?(r===_s&&typeof n=="number"&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function kg(e,t){var n=Object.keys(t),i,r;for(i=0,r;r=n[i];i++)Il(e,r,t[r])}function H(e,t,n){if(typeof t=="string")if(n!==void 0)Il(e,t,n);else return Ig(e,t);else kg(e,t);return e}function ws(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var Lg=/\s+/,Bg=Object.prototype.toString;function Ss(e){return typeof e!="undefined"}function he(e){return new Mn(e)}function Mn(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}Mn.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=ws(t,e);return~n||t.push(e),Ss(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this};Mn.prototype.remove=function(e){if(Bg.call(e)==="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=ws(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this};Mn.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};Mn.prototype.toggle=function(e,t){return this.list?(Ss(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(Ss(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};Mn.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(Lg);return n[0]===""&&n.shift(),n};Mn.prototype.has=Mn.prototype.contains=function(e){return this.list?this.list.contains(e):!!~ws(this.array(),e)};function Be(e){var t=e.parentNode;return t&&t.removeChild(e),e}function Ts(e){for(var t;t=e.firstChild;)Be(t);return e}function kl(e){return e.cloneNode(!0)}var Rs={svg:"http://www.w3.org/2000/svg"},Ll='<svg xmlns="'+Rs.svg+'"';function Bl(e){var t=!1;e.substring(0,4)==="<svg"?e.indexOf(Rs.svg)===-1&&(e=Ll+e.substring(4)):(e=Ll+">"+e+"</svg>",t=!0);var n=$g(e);if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function $g(e){var t;return t=new DOMParser,t.async=!1,t.parseFromString(e,"text/xml")}function Q(e,t){var n;return e.charAt(0)==="<"?(n=Bl(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(Rs.svg,e),t&&H(n,t),n}var Cs=Q("svg");function $l(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)e[i]=t[i];return e}function Fg(e,t,n,i,r,a){var o=Cs.createSVGMatrix();switch(arguments.length){case 0:return o;case 1:return $l(o,e);case 6:return $l(o,{a:e,b:t,c:n,d:i,e:r,f:a})}}function ir(e){return e?Cs.createSVGTransformFromMatrix(e):Cs.createSVGTransform()}var Fl=/([&<>]{1})/g,jg=/([\n\r"]{1})/g,Hg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Ps(e,t){function n(i,r){return Hg[r]||r}return e.replace(t,n)}function jl(e,t){var n,i,r,a,o;switch(e.nodeType){case 3:t.push(Ps(e.textContent,Fl));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(r=e.attributes,n=0,i=r.length;n<i;++n)a=r.item(n),t.push(" ",a.name,'="',Ps(a.value,jg),'"');if(e.hasChildNodes()){for(t.push(">"),o=e.childNodes,n=0,i=o.length;n<i;++n)jl(o.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("<!--",Ps(e.nodeValue,Fl),"-->");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function zg(e,t){var n=Bl(t);if(Ts(e),!!t){Vg(n)||(n=n.documentElement);for(var i=Wg(n.childNodes),r=0;r<i.length;r++)Nl(i[r],e)}}function Gg(e){for(var t=e.firstChild,n=[];t;)jl(t,n),t=t.nextSibling;return n.join("")}function Vg(e){return e.nodeName==="#document-fragment"}function Hl(e,t){if(t!==void 0){try{zg(e,t)}catch(n){throw new Error("error parsing SVG: "+n.message)}return e}else return Gg(e)}function Wg(e){return Array.prototype.slice.call(e)}function Ug(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function Yg(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(Ug(e,i))}function rr(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),Yg(n,t)),n.consolidate()}var qg=/^class /;function Kg(e){return qg.test(e.toString())}function As(e){return Object.prototype.toString.call(e)==="[object Array]"}function Ms(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function va(){var e=Array.prototype.slice.call(arguments);e.length===1&&As(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Xg=/constructor\s*[^(]*\(\s*([^)]*)\)/m,Zg=/^(?:async )?(?:function\s*)?[^(]*\(\s*([^)]*)\)/m,Qg=/\/\*([^*]*)\*\//m;function Jg(e){if(typeof e!="function")throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(Kg(e)?Xg:Zg);return t?t[1]&&t[1].split(",").map(function(n){return t=n.match(Qg),t?t[1].trim():n.trim()})||[]:[]}function ey(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}function Ds(e,t){t=t||{get:function(d,y){if(n.push(d),y===!1)return null;throw o('No provider for "'+d+'"!')}};var n=[],i=this._providers=Object.create(t._providers||null),r=this._instances=Object.create(null),a=r.injector=this,o=function(d){var y=n.join(" -> ");return n.length=0,new Error(y?d+" (Resolving: "+y+")":d)},s=function(d,y){if(!i[d]&&d.indexOf(".")!==-1){for(var x=d.split("."),D=s(x.shift());x.length;)D=D[x.shift()];return D}if(Ms(r,d))return r[d];if(Ms(i,d)){if(n.indexOf(d)!==-1)throw n.push(d),o("Cannot resolve circular dependency!");return n.push(d),r[d]=i[d][0](i[d][1]),n.pop(),r[d]}return t.get(d,y)},c=function(d,y){if(typeof y=="undefined"&&(y={}),typeof d!="function")if(As(d))d=va(d.slice());else throw new Error('Cannot invoke "'+d+'". Expected a function!');var x=d.$inject||Jg(d),D=x.map(function(A){return Ms(y,A)?y[A]:s(A)});return{fn:d,dependencies:D}},u=function(d){var y=c(d),x=y.fn,D=y.dependencies,A=Function.prototype.bind.apply(x,[null].concat(D));return new A},l=function(d,y,x){var D=c(d,x),A=D.fn,w=D.dependencies;return A.apply(y,w)},p=function(d){return va(function(y){return d.get(y)})},h=function(d,y){if(y&&y.length){var x=Object.create(null),D=Object.create(null),A=[],w=[],b=[],_,M,N,P;for(var $ in i)_=i[$],y.indexOf($)!==-1&&(_[2]==="private"?(M=A.indexOf(_[3]),M===-1?(N=_[3].createChild([],y),P=p(N),A.push(_[3]),w.push(N),b.push(P),x[$]=[P,$,"private",N]):x[$]=[b[M],$,"private",w[M]]):x[$]=[_[2],_[1]],D[$]=!0),(_[2]==="factory"||_[2]==="type")&&_[1].$scope&&y.forEach(function(z){_[1].$scope.indexOf(z)!==-1&&(x[$]=[_[2],_[1]],D[z]=!0)});y.forEach(function(z){if(!D[z])throw new Error('No provider for "'+z+'". Cannot use provider from the parent!')}),d.unshift(x)}return new Ds(d,a)},f={factory:l,type:u,value:function(d){return d}};e.forEach(function(d){function y(w,b){return w!=="value"&&As(b)&&(b=va(b.slice())),b}if(d instanceof ey)d.forEach(function(w){var b=w[0],_=w[1],M=w[2];i[b]=[f[_],y(_,M),_]});else if(typeof d=="object")if(d.__exports__){var x=Object.keys(d).reduce(function(w,b){return b.substring(0,2)!=="__"&&(w[b]=d[b]),w},Object.create(null)),D=new Ds((d.__modules__||[]).concat([x]),a),A=va(function(w){return D.get(w)});d.__exports__.forEach(function(w){i[w]=[A,w,"private",D]})}else Object.keys(d).forEach(function(w){if(d[w][2]==="private"){i[w]=d[w];return}var b=d[w][0],_=d[w][1];i[w]=[f[b],y(b,_),b]})}),this.get=s,this.invoke=l,this.instantiate=u,this.createChild=h}var ty=1e3;function dn(e,t){var n=this;t=t||ty,e.on(["render.shape","render.connection"],t,function(i,r){var a=i.type,o=r.element,s=r.gfx,c=r.attrs;if(n.canRender(o))return a==="render.shape"?n.drawShape(s,o,c):n.drawConnection(s,o,c)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,r){if(n.canRender(r))return i.type==="render.getShapePath"?n.getShapePath(r):n.getConnectionPath(r)})}dn.prototype.canRender=function(){};dn.prototype.drawShape=function(){};dn.prototype.drawConnection=function(){};dn.prototype.getShapePath=function(){};dn.prototype.getConnectionPath=function(){};function xi(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function zl(e){for(var t="",n=0,i;i=e[n];n++)t+=i.x+","+i.y+" ";return t}function Ns(e,t){var n=Q("polyline");return H(n,{points:zl(e)}),t&&H(n,t),n}function ny(e,t){return H(e,{points:zl(t)}),e}function Gl(e){return se(e,function(t){return!_e(e,function(n){return n!==t&&Vl(t,n)})})}function Vl(e,t){if(!!t){if(e===t)return t;if(!!e.parent)return Vl(e.parent,t)}}function Wl(e,t,n){var i=!n||e.indexOf(t)===-1;return i&&e.push(t),i}function ti(e,t,n){n=n||0,fe(e)||(e=[e]),C(e,function(i,r){var a=t(i,r,n);fe(a)&&a.length&&ti(a,t,n+1)})}function iy(e,t,n){var i=[],r=[];return ti(e,function(a,o,s){Wl(i,a,t);var c=a.children;if((n===-1||s<n)&&c&&Wl(r,c,t))return c}),i}function ma(e,t){return iy(e,!t,-1)}function ry(e,t,n){tr(t)&&(t=!0),Ze(t)&&(n=t,t=!0),n=n||{};var i=ar(n.allShapes),r=ar(n.allConnections),a=ar(n.enclosedElements),o=ar(n.enclosedConnections),s=ar(n.topLevel,t&&Ei(e,function(l){return l.id}));function c(l){s[l.source.id]&&s[l.target.id]&&(s[l.id]=[l]),i[l.source.id]&&i[l.target.id]&&(o[l.id]=a[l.id]=l),r[l.id]=l}function u(l){if(a[l.id]=l,l.waypoints)o[l.id]=r[l.id]=l;else return i[l.id]=l,C(l.incoming,c),C(l.outgoing,c),l.children}return ti(e,u),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:o,enclosedElements:a}}function Qe(e,t){t=!!t,fe(e)||(e=[e]);var n,i,r,a;return C(e,function(o){var s=o;o.waypoints&&!t&&(s=Qe(o.waypoints,!0));var c=s.x,u=s.y,l=s.height||0,p=s.width||0;(c<n||n===void 0)&&(n=c),(u<i||i===void 0)&&(i=u),(c+p>r||r===void 0)&&(r=c+p),(u+l>a||a===void 0)&&(a=u+l)}),{x:n,y:i,height:a-i,width:r-n}}function ay(e,t){var n={};return C(e,function(i){var r=i;r.waypoints&&(r=Qe(r)),!ae(t.y)&&r.x>t.x&&(n[i.id]=i),!ae(t.x)&&r.y>t.y&&(n[i.id]=i),r.x>t.x&&r.y>t.y&&(ae(t.width)&&ae(t.height)&&r.width+r.x<t.width+t.x&&r.height+r.y<t.height+t.y||!ae(t.width)||!ae(t.height))&&(n[i.id]=i)}),n}function Ul(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function Yl(e){return!!(e&&e.isFrame)}function ar(e,t){return I({},e||{},t||{})}var oy=1;function Dn(e,t){dn.call(this,e,oy),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}Z(Dn,dn);Dn.prototype.canRender=function(){return!0};Dn.prototype.drawShape=function(t,n,i){var r=Q("rect");return H(r,{x:0,y:0,width:n.width||0,height:n.height||0}),Yl(n)?H(r,I({},this.FRAME_STYLE,i||{})):H(r,I({},this.SHAPE_STYLE,i||{})),ne(t,r),r};Dn.prototype.drawConnection=function(t,n,i){var r=Ns(n.waypoints,I({},this.CONNECTION_STYLE,i||{}));return ne(t,r),r};Dn.prototype.getShapePath=function(t){var n=t.x,i=t.y,r=t.width,a=t.height,o=[["M",n,i],["l",r,0],["l",0,a],["l",-r,0],["z"]];return xi(o)};Dn.prototype.getConnectionPath=function(t){var n=t.waypoints,i,r,a=[];for(i=0;r=n[i];i++)r=r.original||r,a.push([i===0?"M":"L",r.x,r.y]);return xi(a)};Dn.$inject=["eventBus","styles"];function sy(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(n,i,r){var a=this.style(i,r);return I(a,{class:n})},this.style=function(n,i){!fe(n)&&!i&&(i=n,n=[]);var r=bt(n,function(a,o){return I(a,e[o]||{})},{});return i?I(r,i):r},this.computeStyle=function(n,i,r){return fe(i)||(r=i,i=[]),t.style(i||[],I({},r,n||{}))}}var cy={__init__:["defaultRenderer"],defaultRenderer:["type",Dn],styles:["type",sy]};function Ie(e,t){if(!e||!t)return-1;var n=e.indexOf(t);return n!==-1&&e.splice(n,1),n}function ke(e,t,n){if(!(!e||!t)){typeof n!="number"&&(n=-1);var i=e.indexOf(t);if(i!==-1){if(i===n)return;if(n!==-1)e.splice(i,1);else return}n!==-1?e.splice(n,0,t):e.push(t)}}function Os(e,t){return!e||!t?-1:e.indexOf(t)}function or(e,t){return!e||!t?-1:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Is(e,t,n,i){if(typeof i=="undefined"&&(i=5),!e||!t||!n)return!1;var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),a=or(e,t);return Math.abs(r/a)<=i}var ql=2;function vn(e,t){var n;return fe(e)?n=e:n=[e,t],uy(n)?"h":ly(n)?"v":!1}function uy(e,t){var n;fe(e)?n=e:n=[e,t];var i=n.slice().shift();return yi(n,function(r){return Math.abs(i.y-r.y)<=ql})}function ly(e,t){var n;fe(e)?n=e:n=[e,t];var i=n.slice().shift();return yi(n,function(r){return Math.abs(i.x-r.x)<=ql})}function Kl(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n}function ks(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var py=/,?([a-z]),?/gi,Xl=parseFloat,Le=Math,Nn=Le.PI,Jt=Le.min,en=Le.max,Zl=Le.pow,On=Le.abs,fy=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/ig,hy=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/ig,ga=Array.isArray||function(e){return e instanceof Array};function Ls(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function sr(e){if(typeof e=="function"||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)Ls(e,n)&&(t[n]=sr(e[n]));return t}function dy(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function vy(e){function t(){var n=Array.prototype.slice.call(arguments,0),i=n.join("\u2400"),r=t.cache=t.cache||{},a=t.count=t.count||[];return Ls(r,i)?(dy(a,i),r[i]):(a.length>=1e3&&delete r[a.shift()],a.push(i),r[i]=e.apply(0,n),r[i])}return t}function my(e){if(!e)return null;var t=_i(e);if(t.arr)return sr(t.arr);var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=[];return ga(e)&&ga(e[0])&&(i=sr(e)),i.length||String(e).replace(fy,function(r,a,o){var s=[],c=a.toLowerCase();for(o.replace(hy,function(u,l){l&&s.push(+l)}),c=="m"&&s.length>2&&(i.push([a].concat(s.splice(0,2))),c="l",a=a=="m"?"l":"L");s.length>=n[c]&&(i.push([a].concat(s.splice(0,n[c]))),!!n[c]););}),i.toString=_i.toString,t.arr=sr(i),i}function _i(e){var t=_i.ps=_i.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)Ls(t,n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function Bs(e,t,n,i){return arguments.length===1&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,height:i,x2:e+n,y2:t+i}}function Ql(){return this.join(",").replace(py,"$1")}function ya(e){var t=sr(e);return t.toString=Ql,t}function Jl(e,t,n,i,r,a,o,s,c){var u=1-c,l=Zl(u,3),p=Zl(u,2),h=c*c,f=h*c,d=l*e+p*3*c*n+u*3*c*c*r+f*o,y=l*t+p*3*c*i+u*3*c*c*a+f*s;return{x:Ea(d),y:Ea(y)}}function ep(e){var t=_y.apply(null,e);return Bs(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}function In(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function gy(e,t){return e=Bs(e),t=Bs(t),In(t,e.x,e.y)||In(t,e.x2,e.y)||In(t,e.x,e.y2)||In(t,e.x2,e.y2)||In(e,t.x,t.y)||In(e,t.x2,t.y)||In(e,t.x,t.y2)||In(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function tp(e,t,n,i,r){var a=-3*t+9*n-9*i+3*r,o=e*a+6*t-12*n+6*i;return e*o-3*t+3*n}function np(e,t,n,i,r,a,o,s,c){c==null&&(c=1),c=c>1?1:c<0?0:c;for(var u=c/2,l=12,p=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,d=0;d<l;d++){var y=u*p[d]+u,x=tp(y,e,n,r,o),D=tp(y,t,i,a,s),A=x*x+D*D;f+=h[d]*Le.sqrt(A)}return u*f}function yy(e,t,n,i,r,a,o,s){if(!(en(e,n)<Jt(r,o)||Jt(e,n)>en(r,o)||en(t,i)<Jt(a,s)||Jt(t,i)>en(a,s))){var c=(e*i-t*n)*(r-o)-(e-n)*(r*s-a*o),u=(e*i-t*n)*(a-s)-(t-i)*(r*s-a*o),l=(e-n)*(a-s)-(t-i)*(r-o);if(!!l){var p=Ea(c/l),h=Ea(u/l),f=+p.toFixed(2),d=+h.toFixed(2);if(!(f<+Jt(e,n).toFixed(2)||f>+en(e,n).toFixed(2)||f<+Jt(r,o).toFixed(2)||f>+en(r,o).toFixed(2)||d<+Jt(t,i).toFixed(2)||d>+en(t,i).toFixed(2)||d<+Jt(a,s).toFixed(2)||d>+en(a,s).toFixed(2)))return{x:p,y:h}}}}function Ea(e){return Math.round(e*1e11)/1e11}function Ey(e,t,n){var i=ep(e),r=ep(t);if(!gy(i,r))return n?0:[];for(var a=np.apply(0,e),o=np.apply(0,t),s=ip(e)?1:~~(a/5)||1,c=ip(t)?1:~~(o/5)||1,u=[],l=[],p={},h=n?0:[],f=0;f<s+1;f++){var d=Jl.apply(0,e.concat(f/s));u.push({x:d.x,y:d.y,t:f/s})}for(f=0;f<c+1;f++)d=Jl.apply(0,t.concat(f/c)),l.push({x:d.x,y:d.y,t:f/c});for(f=0;f<s;f++)for(var y=0;y<c;y++){var x=u[f],D=u[f+1],A=l[y],w=l[y+1],b=On(D.x-x.x)<.01?"y":"x",_=On(w.x-A.x)<.01?"y":"x",M=yy(x.x,x.y,D.x,D.y,A.x,A.y,w.x,w.y),N;if(M){if(N=M.x.toFixed(9)+"#"+M.y.toFixed(9),p[N])continue;p[N]=!0;var P=x.t+On((M[b]-x[b])/(D[b]-x[b]))*(D.t-x.t),$=A.t+On((M[_]-A[_])/(w[_]-A[_]))*(w.t-A.t);P>=0&&P<=1&&$>=0&&$<=1&&(n?h++:h.push({x:M.x,y:M.y,t1:P,t2:$}))}}return h}function by(e,t,n){e=op(e),t=op(t);for(var i,r,a,o,s,c,u,l,p,h,f=n?0:[],d=0,y=e.length;d<y;d++){var x=e[d];if(x[0]=="M")i=s=x[1],r=c=x[2];else{x[0]=="C"?(p=[i,r].concat(x.slice(1)),i=p[6],r=p[7]):(p=[i,r,i,r,s,c,s,c],i=s,r=c);for(var D=0,A=t.length;D<A;D++){var w=t[D];if(w[0]=="M")a=u=w[1],o=l=w[2];else{w[0]=="C"?(h=[a,o].concat(w.slice(1)),a=h[6],o=h[7]):(h=[a,o,a,o,u,l,u,l],a=u,o=l);var b=Ey(p,h,n);if(n)f+=b;else{for(var _=0,M=b.length;_<M;_++)b[_].segment1=d,b[_].segment2=D,b[_].bez1=p,b[_].bez2=h;f=f.concat(b)}}}}}return f}function xy(e){var t=_i(e);if(t.abs)return ya(t.abs);if((!ga(e)||!ga(e&&e[0]))&&(e=my(e)),!e||!e.length)return[["M",0,0]];var n=[],i=0,r=0,a=0,o=0,s=0,c;e[0][0]=="M"&&(i=+e[0][1],r=+e[0][2],a=i,o=r,s++,n[0]=["M",i,r]);for(var u,l,p=s,h=e.length;p<h;p++){if(n.push(u=[]),l=e[p],c=l[0],c!=c.toUpperCase())switch(u[0]=c.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+i,u[7]=+l[7]+r;break;case"V":u[1]=+l[1]+r;break;case"H":u[1]=+l[1]+i;break;case"M":a=+l[1]+i,o=+l[2]+r;default:for(var f=1,d=l.length;f<d;f++)u[f]=+l[f]+(f%2?i:r)}else for(var y=0,x=l.length;y<x;y++)u[y]=l[y];switch(c=c.toUpperCase(),u[0]){case"Z":i=+a,r=+o;break;case"H":i=u[1];break;case"V":r=u[1];break;case"M":a=u[u.length-2],o=u[u.length-1];default:i=u[u.length-2],r=u[u.length-1]}}return n.toString=Ql,t.abs=ya(n),n}function ip(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function ba(e,t,n,i){return[e,t,n,i,n,i]}function rp(e,t,n,i,r,a){var o=1/3,s=2/3;return[o*e+s*n,o*t+s*i,o*r+s*n,o*a+s*i,r,a]}function ap(e,t,n,i,r,a,o,s,c,u){var l=Nn*120/180,p=Nn/180*(+r||0),h=[],f,d=vy(function(oe,Re,pe){var de=oe*Le.cos(pe)-Re*Le.sin(pe),Ve=oe*Le.sin(pe)+Re*Le.cos(pe);return{x:de,y:Ve}});if(u)N=u[0],P=u[1],_=u[2],M=u[3];else{f=d(e,t,-p),e=f.x,t=f.y,f=d(s,c,-p),s=f.x,c=f.y;var y=(e-s)/2,x=(t-c)/2,D=y*y/(n*n)+x*x/(i*i);D>1&&(D=Le.sqrt(D),n=D*n,i=D*i);var A=n*n,w=i*i,b=(a==o?-1:1)*Le.sqrt(On((A*w-A*x*x-w*y*y)/(A*x*x+w*y*y))),_=b*n*x/i+(e+s)/2,M=b*-i*y/n+(t+c)/2,N=Le.asin(((t-M)/i).toFixed(9)),P=Le.asin(((c-M)/i).toFixed(9));N=e<_?Nn-N:N,P=s<_?Nn-P:P,N<0&&(N=Nn*2+N),P<0&&(P=Nn*2+P),o&&N>P&&(N=N-Nn*2),!o&&P>N&&(P=P-Nn*2)}var $=P-N;if(On($)>l){var z=P,Y=s,W=c;P=N+l*(o&&P>N?1:-1),s=_+n*Le.cos(P),c=M+i*Le.sin(P),h=ap(s,c,n,i,r,0,o,Y,W,[P,z,_,M])}$=P-N;var X=Le.cos(N),ge=Le.sin(N),$t=Le.cos(P),be=Le.sin(P),le=Le.tan($/4),S=4/3*n*le,v=4/3*i*le,R=[e,t],O=[e+S*ge,t-v*X],F=[s+S*be,c-v*$t],k=[s,c];if(O[0]=2*R[0]-O[0],O[1]=2*R[1]-O[1],u)return[O,F,k].concat(h);h=[O,F,k].concat(h).join().split(",");for(var B=[],G=0,re=h.length;G<re;G++)B[G]=G%2?d(h[G-1],h[G],p).y:d(h[G],h[G+1],p).x;return B}function _y(e,t,n,i,r,a,o,s){for(var c=[],u=[[],[]],l,p,h,f,d,y,x,D,A=0;A<2;++A){if(A==0?(p=6*e-12*n+6*r,l=-3*e+9*n-9*r+3*o,h=3*n-3*e):(p=6*t-12*i+6*a,l=-3*t+9*i-9*a+3*s,h=3*i-3*t),On(l)<1e-12){if(On(p)<1e-12)continue;f=-h/p,0<f&&f<1&&c.push(f);continue}x=p*p-4*h*l,D=Le.sqrt(x),!(x<0)&&(d=(-p+D)/(2*l),0<d&&d<1&&c.push(d),y=(-p-D)/(2*l),0<y&&y<1&&c.push(y))}for(var w=c.length,b=w,_;w--;)f=c[w],_=1-f,u[0][w]=_*_*_*e+3*_*_*f*n+3*_*f*f*r+f*f*f*o,u[1][w]=_*_*_*t+3*_*_*f*i+3*_*f*f*a+f*f*f*s;return u[0][b]=e,u[1][b]=t,u[0][b+1]=o,u[1][b+1]=s,u[0].length=u[1].length=b+2,{x0:Jt.apply(0,u[0]),y0:Jt.apply(0,u[1]),x1:en.apply(0,u[0]),y1:en.apply(0,u[1])}}function op(e){var t=_i(e);if(t.curve)return ya(t.curve);for(var n=xy(e),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r=function(f,d,y){var x,D;if(!f)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch(!(f[0]in{T:1,Q:1})&&(d.qx=d.qy=null),f[0]){case"M":d.X=f[1],d.Y=f[2];break;case"A":f=["C"].concat(ap.apply(0,[d.x,d.y].concat(f.slice(1))));break;case"S":y=="C"||y=="S"?(x=d.x*2-d.bx,D=d.y*2-d.by):(x=d.x,D=d.y),f=["C",x,D].concat(f.slice(1));break;case"T":y=="Q"||y=="T"?(d.qx=d.x*2-d.qx,d.qy=d.y*2-d.qy):(d.qx=d.x,d.qy=d.y),f=["C"].concat(rp(d.x,d.y,d.qx,d.qy,f[1],f[2]));break;case"Q":d.qx=f[1],d.qy=f[2],f=["C"].concat(rp(d.x,d.y,f[1],f[2],f[3],f[4]));break;case"L":f=["C"].concat(ba(d.x,d.y,f[1],f[2]));break;case"H":f=["C"].concat(ba(d.x,d.y,f[1],d.y));break;case"V":f=["C"].concat(ba(d.x,d.y,d.x,f[1]));break;case"Z":f=["C"].concat(ba(d.x,d.y,d.X,d.Y));break}return f},a=function(f,d){if(f[d].length>7){f[d].shift();for(var y=f[d];y.length;)o[d]="A",f.splice(d++,0,["C"].concat(y.splice(0,6)));f.splice(d,1),l=n.length}},o=[],s="",c="",u=0,l=n.length;u<l;u++){n[u]&&(s=n[u][0]),s!="C"&&(o[u]=s,u&&(c=o[u-1])),n[u]=r(n[u],i,c),o[u]!="A"&&s=="C"&&(o[u]="C"),a(n,u);var p=n[u],h=p.length;i.x=p[h-2],i.y=p[h-1],i.bx=Xl(p[h-4])||i.x,i.by=Xl(p[h-3])||i.y}return t.curve=ya(n),n}var wy=by,sp=wy;function cp(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function kn(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function ee(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function $s(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function ce(e){return kn({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function Je(e,t,n){n=n||0,Ze(n)||(n={x:n,y:n});var i=ee(e),r=ee(t),a=i.bottom+n.y<=r.top,o=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,c=i.right+n.x<=r.left,u=a?"top":s?"bottom":null,l=c?"left":o?"right":null;return l&&u?u+"-"+l:l||u||"intersect"}function Fs(e,t,n){var i=Sy(e,t);return i.length===1||i.length===2&&or(i[0],i[1])<1?kn(i[0]):i.length>1?(i=jt(i,function(r){var a=Math.floor(r.t2*100)||1;return a=100-a,a=(a<10?"0":"")+a,r.segment2+"#"+a}),kn(i[n?0:i.length-1])):null}function Sy(e,t){return sp(e,t)}function Ty(e){e=e.slice();for(var t=0,n,i,r;e[t];)n=e[t],i=e[t-1],r=e[t+1],or(n,r)===0||Is(i,r,n)?e.splice(t,1):t++;return e}function xa(e,t){return Math.round(e*t)/t}function up(e){return ae(e)?e+"px":e}function Ry(e){for(;e.parent;)e=e.parent;return e}function Cy(e){e=I({},{width:"100%",height:"100%"},e);var t=e.container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),I(n.style,{position:"relative",overflow:"hidden",width:up(e.width),height:up(e.height)}),t.appendChild(n),n}function lp(e,t,n){var i=Q("g");he(i).add(t);var r=n!==void 0?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[r]||null),i}var _a="base",js="djs-element-hidden",pp=0,Py=1,Ay={shape:["x","y","width","height"],connection:["waypoints"]};function ue(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}ue.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"];ue.prototype._init=function(e){var t=this._eventBus,n=this._container=Cy(e),i=this._svg=Q("svg");H(i,{width:"100%",height:"100%"}),ne(n,i);var r=this._viewport=lp(i,"viewport");this._layers={},this._planes={},e.deferUpdate!==!1&&(this._viewboxChanged=Rl(pt(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:r})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","plane.set"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)};ue.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._activePlane,delete this._viewport};ue.prototype._clear=function(){var e=this,t=this._elementRegistry.getAll();t.forEach(function(n){var i=Ul(n);i==="root"?e.setRootElementForPlane(null,e.findPlane(n),!0):e._removeElement(n,i)}),this._activePlane=null,this._planes={},delete this._cachedViewbox};ue.prototype.getDefaultLayer=function(){return this.getLayer(_a,pp)};ue.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),typeof t!="undefined"&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group};ue.prototype._createLayer=function(e,t){typeof t=="undefined"&&(t=Py);var n=bt(this._layers,function(i,r){return t>=r.index&&i++,i},0);return{group:lp(this._viewport,"layer-"+e,n),index:t}};ue.prototype.getPlane=function(e){if(!e)throw new Error("must specify a name");return this._planes[e]};ue.prototype.createPlane=function(e,t){if(!e)throw new Error("must specify a name");if(this._planes[e])throw new Error("plane "+e+" already exists");t||(t={id:"__implicitroot"+e,children:[],isImplicit:!0});var n=this.getLayer(e,pp);he(n).add(js);var i=this._planes[e]={layer:n,name:e,rootElement:null};return this.setRootElementForPlane(t,i),i};ue.prototype.setActivePlane=function(e){if(!e)throw new Error("must specify a plane");return typeof e=="string"&&(e=this.getPlane(e)),this._activePlane&&he(this._activePlane.layer).add(js),this._activePlane=e,he(e.layer).remove(js),e.rootElement&&this._elementRegistry.updateGraphics(e.rootElement,this._svg,!0),this._eventBus.fire("plane.set",{plane:e}),e};ue.prototype.getActiveLayer=function(){return this.getActivePlane().layer};ue.prototype.getActivePlane=function(){var e=this._activePlane;return e||(e=this.createPlane(_a),this.setActivePlane(_a)),e};ue.prototype.findPlane=function(e){typeof e=="string"&&(e=this._elementRegistry.get(e));var t=Ry(e);return _e(this._planes,function(n){return n.rootElement===t})};ue.prototype.getContainer=function(){return this._container};ue.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),i=this._elementRegistry._elements[e.id],!!i&&(C([i.gfx,i.secondaryGfx],function(r){r&&(n?he(r).add(t):he(r).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))};ue.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)};ue.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)};ue.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return he(n).has(t)};ue.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)};ue.prototype.getRootElement=function(){var e=this.getActivePlane();return e.rootElement};ue.prototype.setRootElement=function(e,t){var n=this._activePlane;if(n)return this.setRootElementForPlane(e,n,t);var i=this.createPlane(_a,e);return this.setActivePlane(i),i.rootElement};ue.prototype.setRootElementForPlane=function(e,t,n){typeof t=="string"&&(t=this.getPlane(t)),e&&this._ensureValid("root",e);var i=t.rootElement,r=this._elementRegistry,a=this._eventBus;if(i){if(!n)throw new Error("rootElement already set, need to specify override");a.fire("root.remove",{element:i}),a.fire("root.removed",{element:i}),r.remove(i)}if(e){var o=t.layer;a.fire("root.add",{element:e}),r.add(e,o),a.fire("root.added",{element:e,gfx:o}),t===this._activePlane&&this._elementRegistry.updateGraphics(e,this._svg,!0)}return t.rootElement=e,e};ue.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=Ay[e],i=yi(n,function(r){return typeof t[r]!="undefined"});if(!i)throw new Error("must supply { "+n.join(", ")+" } with "+e)};ue.prototype._setParent=function(e,t,n){ke(t.children,e,n),e.parent=t};ue.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,a=this._graphicsFactory;this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var o=a.create(e,t,i);return this._elementRegistry.add(t,o),a.update(e,t,o),r.fire(e+".added",{element:t,gfx:o}),t};ue.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)};ue.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)};ue.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e),!!e)return r.fire(t+".remove",{element:e}),i.remove(e),Ie(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e};ue.prototype.removeShape=function(e){return this._removeElement(e,"shape")};ue.prototype.removeConnection=function(e){return this._removeElement(e,"connection")};ue.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)};ue.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()};ue.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})};ue.prototype.viewbox=function(e){if(e===void 0&&this._cachedViewbox)return this._cachedViewbox;var t=this._viewport,n,i=this.getSize(),r,a,o,s,c;if(e)this._changeViewbox(function(){o=Math.min(i.width/e.width,i.height/e.height);var u=this._svg.createSVGMatrix().scale(o).translate(-e.x,-e.y);rr(t,u)});else return n=this._activePlane&&this._activePlane.layer.getBBox()||{},a=rr(t),r=a?a.matrix:Fg(),o=xa(r.a,1e3),s=xa(-r.e||0,1e3),c=xa(-r.f||0,1e3),e=this._cachedViewbox={x:s?s/o:0,y:c?c/o:0,width:i.width/o,height:i.height/o,scale:o,inner:{width:n.width||0,height:n.height||0,x:n.x||0,y:n.y||0},outer:i},e;return e};ue.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=I({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),fp(t,n)}),{x:n.e,y:n.f}};ue.prototype.scrollToElement=function(e,t){var n=100;typeof e=="string"&&(e=this._elementRegistry.get(e));var i=this.findPlane(e);i!==this._activePlane&&this.setActivePlane(i),t||(t={}),typeof t=="number"&&(n=t),t={top:t.top||n,right:t.right||n,bottom:t.bottom||n,left:t.left||n};var r=Qe(e),a=ee(r),o=this.viewbox(),s=this.zoom(),c,u;o.y+=t.top/s,o.x+=t.left/s,o.width-=(t.right+t.left)/s,o.height-=(t.bottom+t.top)/s;var l=ee(o),p=r.width<o.width&&r.height<o.height;if(!p)c=r.x-o.x,u=r.y-o.y;else{var h=Math.max(0,a.right-l.right),f=Math.min(0,a.left-l.left),d=Math.max(0,a.bottom-l.bottom),y=Math.min(0,a.top-l.top);c=h||f,u=d||y}this.scroll({dx:-c*s,dy:-u*s})};ue.prototype.zoom=function(e,t){if(!e)return this.viewbox(e).scale;if(e==="fit-viewport")return this._fitViewport(t);var n,i;return this._changeViewbox(function(){typeof t!="object"&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),xa(i.a,1e3)};function fp(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}ue.prototype._fitViewport=function(e){var t=this.viewbox(),n=t.outer,i=t.inner,r,a;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!e?a={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(r=Math.min(1,n.width/i.width,n.height/i.height),a={x:i.x+(e?i.width/2-n.width/r/2:0),y:i.y+(e?i.height/2-n.height/r/2:0),width:n.width/r,height:n.height/r}),this.viewbox(a),this.viewbox(!1).scale};ue.prototype._setZoom=function(e,t){var n=this._svg,i=this._viewport,r=n.createSVGMatrix(),a=n.createSVGPoint(),o,s,c,u,l;c=i.getCTM();var p=c.a;return t?(o=I(a,t),s=o.matrixTransform(c.inverse()),u=r.translate(s.x,s.y).scale(1/p*e).translate(-s.x,-s.y),l=c.multiply(u)):l=r.scale(e),fp(this._viewport,l),l};ue.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}};ue.prototype.getAbsoluteBBox=function(e){var t=this.viewbox(),n;if(e.waypoints){var i=this.getGraphics(e);n=i.getBBox()}else n=e;var r=n.x*t.scale-t.x*t.scale,a=n.y*t.scale-t.y*t.scale,o=n.width*t.scale,s=n.height*t.scale;return{x:r,y:a,width:o,height:s}};ue.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var wi="data-element-id";function wt(e){this._elements={},this._eventBus=e}wt.$inject=["eventBus"];wt.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),H(t,wi,i),n&&H(n,wi,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}};wt.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&(H(i.gfx,wi,""),i.secondaryGfx&&H(i.secondaryGfx,wi,""),delete t[n])};wt.prototype.updateId=function(e,t){this._validateId(t),typeof e=="string"&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)};wt.prototype.updateGraphics=function(e,t,n){var i=e.id||e,r=this._elements[i];return n?r.secondaryGfx=t:r.gfx=t,H(t,wi,i),t};wt.prototype.get=function(e){var t;typeof e=="string"?t=e:t=e&&H(e,wi);var n=this._elements[t];return n&&n.element};wt.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t};wt.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],a=t[r],o=a.element,s=a.gfx;if(e(o,s))return o}};wt.prototype.getAll=function(){return this.filter(function(e){return e})};wt.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],r=i.element,a=i.gfx;return e(r,a)})};wt.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)};wt.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Hs={exports:{}},wa={};function My(e,t,n,i){var r=n.inverse;return Object.defineProperty(e,"remove",{value:function(a){var o=this.indexOf(a);return o!==-1&&(this.splice(o,1),t.unset(a,r,i)),a}}),Object.defineProperty(e,"contains",{value:function(a){return this.indexOf(a)!==-1}}),Object.defineProperty(e,"add",{value:function(a,o){var s=this.indexOf(a);if(typeof o=="undefined"){if(s!==-1)return;o=this.length}s!==-1&&this.splice(s,1),this.splice(o,0,a),s===-1&&t.set(a,r,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e}function Dy(e){return e.__refs_collection===!0}wa.extend=My;wa.isExtended=Dy;var hp=wa;function Ny(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)}function dp(e,t,n){var i=hp.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(r){e.set(r,t.inverse,n)})}function Oy(e,t,n){var i=t.inverse,r=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return r},set:function(a){if(a!==r){var o=r;r=null,o&&e.unset(o,i,n),r=a,e.set(r,i,n)}}})}function Ln(e,t){if(!(this instanceof Ln))return new Ln(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}Ln.prototype.bind=function(e,t){if(typeof t=="string"){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?dp(this,t,e):Oy(this,t,e)};Ln.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return hp.isExtended(n)||dp(this,t,e),n};Ln.prototype.ensureBound=function(e,t){Ny(e,t)||this.bind(e,t)};Ln.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)};Ln.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var Iy=Ln;Hs.exports=Iy;Hs.exports.Collection=wa;var Si=Hs.exports,vp=new Si({name:"children",enumerable:!0,collection:!0},{name:"parent"}),mp=new Si({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),gp=new Si({name:"attachers",collection:!0},{name:"host"}),yp=new Si({name:"outgoing",collection:!0},{name:"source"}),Ep=new Si({name:"incoming",collection:!0},{name:"target"});function cr(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),vp.bind(this,"parent"),mp.bind(this,"labels"),yp.bind(this,"outgoing"),Ep.bind(this,"incoming")}function Ti(){cr.call(this),vp.bind(this,"children"),gp.bind(this,"host"),gp.bind(this,"attachers")}Z(Ti,cr);function bp(){Ti.call(this)}Z(bp,Ti);function Sa(){Ti.call(this),mp.bind(this,"labelTarget")}Z(Sa,Ti);function xp(){cr.call(this),yp.bind(this,"source"),Ep.bind(this,"target")}Z(xp,cr);var ky={connection:xp,shape:Ti,label:Sa,root:bp};function Ly(e,t){var n=ky[e];if(!n)throw new Error("unknown type: <"+e+">");return I(new n,t)}function mn(){this._uid=12}mn.prototype.createRoot=function(e){return this.create("root",e)};mn.prototype.createLabel=function(e){return this.create("label",e)};mn.prototype.createShape=function(e){return this.create("shape",e)};mn.prototype.createConnection=function(e){return this.create("connection",e)};mn.prototype.create=function(e,t){return t=I({},t||{}),t.id||(t.id=e+"_"+this._uid++),Ly(e,t)};var Ta="__fn",_p=1e3,By=Array.prototype.slice;function dt(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}dt.prototype.on=function(e,t,n,i){if(e=fe(e)?e:[e],at(t)&&(i=n,n=t,t=_p),!ae(t))throw new Error("priority must be a number");var r=n;i&&(r=pt(n,i),r[Ta]=n[Ta]||n);var a=this;e.forEach(function(o){a._addListener(o,{priority:t,callback:r,next:null})})};dt.prototype.once=function(e,t,n,i){var r=this;if(at(t)&&(i=n,n=t,t=_p),!ae(t))throw new Error("priority must be a number");function a(){a.__isTomb=!0;var o=n.apply(i,arguments);return r.off(e,a),o}a[Ta]=n,this.on(e,t,a)};dt.prototype.off=function(e,t){e=fe(e)?e:[e];var n=this;e.forEach(function(i){n._removeListener(i,t)})};dt.prototype.createEvent=function(e){var t=new ur;return t.init(e),t};dt.prototype.fire=function(e,t){var n,i,r,a;if(a=By.call(arguments),typeof e=="object"&&(t=e,e=t.type),!e)throw new Error("no event type specified");if(i=this._listeners[e],!!i){t instanceof ur?n=t:n=this.createEvent(t),a[0]=n;var o=n.type;e!==o&&(n.type=e);try{r=this._invokeListeners(n,a,i)}finally{e!==o&&(n.type=o)}return r===void 0&&n.defaultPrevented&&(r=!1),r}};dt.prototype.handleError=function(e){return this.fire("error",{error:e})===!1};dt.prototype._destroy=function(){this._listeners={}};dt.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i};dt.prototype._invokeListener=function(e,t,n){var i;if(n.callback.__isTomb)return i;try{i=$y(n.callback,t),i!==void 0&&(e.returnValue=i,e.stopPropagation()),i===!1&&e.preventDefault()}catch(r){if(!this.handleError(r))throw console.error("unhandled error in event listener",r),r}return i};dt.prototype._addListener=function(e,t){var n=this._getListeners(e),i;if(!n){this._setListeners(e,t);return}for(;n;){if(n.priority<t.priority){t.next=n,i?i.next=t:this._setListeners(e,t);return}i=n,n=n.next}i.next=t};dt.prototype._getListeners=function(e){return this._listeners[e]};dt.prototype._setListeners=function(e,t){this._listeners[e]=t};dt.prototype._removeListener=function(e,t){var n=this._getListeners(e),i,r,a;if(!t){this._setListeners(e,null);return}for(;n;)i=n.next,a=n.callback,(a===t||a[Ta]===t)&&(r?r.next=i:this._setListeners(e,i)),r=n,n=i};function ur(){}ur.prototype.stopPropagation=function(){this.cancelBubble=!0};ur.prototype.preventDefault=function(){this.defaultPrevented=!0};ur.prototype.init=function(e){I(this,e||{})};function $y(e,t){return e.apply(null,t)}function Ra(e){return e.childNodes[0]}function Fy(e){return e.parentNode.childNodes[1]}function zs(e,t,n,i,r){var a=ir();a.setTranslate(t,n);var o=ir();o.setRotate(i||0,0,0);var s=ir();s.setScale(r||1,r||1),rr(e,[a,o,s])}function vt(e,t,n){var i=ir();i.setTranslate(t,n),rr(e,i)}function wp(e,t){var n=ir();n.setRotate(t,0,0),rr(e,n)}function St(e,t){this._eventBus=e,this._elementRegistry=t}St.$inject=["eventBus","elementRegistry"];St.prototype._getChildrenContainer=function(e){var t=this._elementRegistry.getGraphics(e),n;return e.parent?(n=Fy(t),n||(n=Q("g"),he(n).add("djs-children"),ne(t.parentNode,n))):n=t,n};St.prototype._clear=function(e){var t=Ra(e);return fa(t),t};St.prototype._createContainer=function(e,t,n,i){var r=Q("g");he(r).add("djs-group"),typeof n!="undefined"?Sp(r,t,t.childNodes[n]):ne(t,r);var a=Q("g");he(a).add("djs-element"),he(a).add("djs-"+e),i&&he(a).add("djs-frame"),ne(r,a);var o=Q("g");return he(o).add("djs-visual"),ne(a,o),a};St.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,Yl(t))};St.prototype.updateContainments=function(e){var t=this,n=this._elementRegistry,i;i=bt(e,function(r,a){return a.parent&&(r[a.parent.id]=a.parent),r},{}),C(i,function(r){var a=r.children;if(!!a){var o=t._getChildrenContainer(r);C(a.slice().reverse(),function(s){var c=n.getGraphics(s);Sp(c.parentNode,o)})}})};St.prototype.drawShape=function(e,t){var n=this._eventBus;return n.fire("render.shape",{gfx:e,element:t})};St.prototype.getShapePath=function(e){var t=this._eventBus;return t.fire("render.getShapePath",e)};St.prototype.drawConnection=function(e,t){var n=this._eventBus;return n.fire("render.connection",{gfx:e,element:t})};St.prototype.getConnectionPath=function(e){var t=this._eventBus;return t.fire("render.getConnectionPath",e)};St.prototype.update=function(e,t,n){if(!!t.parent){var i=this._clear(n);if(e==="shape")this.drawShape(i,t),vt(n,t.x,t.y);else if(e==="connection")this.drawConnection(i,t);else throw new Error("unknown type: "+e);t.hidden?H(n,"display","none"):H(n,"display","block")}};St.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);Be(t.parentNode)};function Sp(e,t,n){var i=n||t.firstChild;e!==i&&t.insertBefore(e,i)}var jy={__depends__:[cy],__init__:["canvas"],canvas:["type",ue],elementRegistry:["type",wt],elementFactory:["type",mn],eventBus:["type",dt],graphicsFactory:["type",St]};function Hy(e){var t=[],n=[];function i(s){return t.indexOf(s)>=0}function r(s){t.push(s)}function a(s){i(s)||((s.__depends__||[]).forEach(a),!i(s)&&(r(s),(s.__init__||[]).forEach(function(c){n.push(c)})))}e.forEach(a);var o=new Ds(t);return n.forEach(function(s){try{o[typeof s=="string"?"get":"invoke"](s)}catch(c){throw console.error("Failed to instantiate component"),console.error(c.stack),c}}),o}function zy(e){e=e||{};var t={config:["value",e]},n=[t,jy].concat(e.modules||[]);return Hy(n)}function Ri(e,t){this.injector=t=t||zy(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}Ri.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")};Ri.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};function Gs(){}Gs.prototype.get=function(e){return this.$model.properties.get(this,e)};Gs.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};function Tp(e,t){this.model=e,this.properties=t}Tp.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(Gs.prototype);C(e.properties,function(o){!o.isMany&&o.default!==void 0&&(i[o.name]=o.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var r=e.ns.name;function a(o){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),C(o,pt(function(s,c){this.set(c,s)},this))}return a.prototype=i,a.hasType=i.$instanceOf=this.model.hasType,n.defineModel(a,t),n.defineDescriptor(a,e),a};var Gy={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},Rp={String:function(e){return e},Boolean:function(e){return e==="true"},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function Vs(e,t){var n=Rp[e];return n?n(t):t}function Ws(e){return!!Gy[e]}function Cp(e){return!!Rp[e]}function ft(e,t){var n=e.split(/:/),i,r;if(n.length===1)i=e,r=t;else if(n.length===2)i=n[1],r=n[0];else throw new Error("expected <prefix:localName> or <localName>, got "+e);return e=(r?r+":":"")+i,{name:e,prefix:r,localName:i}}function At(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}At.prototype.build=function(){return zt(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])};At.prototype.addProperty=function(e,t,n){typeof t=="boolean"&&(n=t,t=void 0),this.addNamedProperty(e,n!==!1);var i=this.properties;t!==void 0?i.splice(t,0,e):i.push(e)};At.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,a=this.propertiesByName,o=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=r.indexOf(e);if(s===-1)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(t,n?void 0:s,o),a[i.name]=a[i.localName]=t};At.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,r=t.split("#"),a=ft(r[0],i),o=ft(r[1],a.prefix).name,s=this.propertiesByName[o];if(s)this.replaceProperty(s,e,n);else throw new Error("refined property <"+o+"> not found");delete e.redefines};At.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e};At.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]};At.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e};At.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e};At.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")};At.prototype.hasProperty=function(e){return this.propertiesByName[e]};At.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,r=e.name;r in n||(C(e.properties,pt(function(a){a=I({},a,{name:a.ns.localName,inherited:t}),Object.defineProperty(a,"definedBy",{value:e});var o=a.replaces,s=a.redefines;o||s?this.redefineProperty(a,o||s,o):(a.isBody&&this.setBodyProperty(a),a.isId&&this.setIdProperty(a),this.addProperty(a))},this)),i.push(e),n[r]=e)};function Bn(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,C(e,pt(this.registerPackage,this))}Bn.prototype.getPackage=function(e){return this.packageMap[e]};Bn.prototype.getPackages=function(){return this.packages};Bn.prototype.registerPackage=function(e){e=I({},e);var t=this.packageMap;Pp(t,e,"prefix"),Pp(t,e,"uri"),C(e.types,pt(function(n){this.registerType(n,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)};Bn.prototype.registerType=function(e,t){e=I({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:I(e.meta||{})});var n=ft(e.name,t.prefix),i=n.name,r={};C(e.properties,pt(function(a){var o=ft(a.name,n.prefix),s=o.name;Ws(a.type)||(a.type=ft(a.type,o.prefix).name),I(a,{ns:o,name:s}),r[s]=a},this)),I(e,{ns:n,name:i,propertiesByName:r}),C(e.extends,pt(function(a){var o=this.typeMap[a];o.traits=o.traits||[],o.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e};Bn.prototype.mapTypes=function(e,t,n){var i=Ws(e.name)?{name:e.name}:this.typeMap[e.name],r=this;function a(s){return o(s,!0)}function o(s,c){var u=ft(s,Ws(s)?"":e.prefix);r.mapTypes(u,t,c)}if(!i)throw new Error("unknown type <"+e.name+">");C(i.superClass,n?a:o),t(i,!n),C(i.traits,a)};Bn.prototype.getEffectiveDescriptor=function(e){var t=ft(e),n=new At(t);this.mapTypes(t,function(r,a){n.addTrait(r,a)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i};Bn.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};function Pp(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}function Ci(e){this.model=e}Ci.prototype.set=function(e,t,n){var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;Vy(n)?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:Ap(e,i,n):e.$attrs[t]=n};Ci.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&Ap(e,n,[]),e[i]};Ci.prototype.define=function(e,t,n){Object.defineProperty(e,t,n)};Ci.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})};Ci.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};function Vy(e){return typeof e=="undefined"}function Ap(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function Mt(e){this.properties=new Ci(this),this.factory=new Tp(this,this.properties),this.registry=new Bn(e,this.properties),this.typeCache={}}Mt.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)};Mt.prototype.getType=function(e){var t=this.typeCache,n=Pt(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i};Mt.prototype.createAny=function(e,t,n){var i=ft(e),r={$type:e,$instanceOf:function(o){return o===this.$type}},a={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,a),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),this.properties.define(r,"$instanceOf",{enumerable:!1,writable:!0}),C(n,function(o,s){Ze(o)&&o.value!==void 0?r[o.name]=o.value:r[s]=o}),r};Mt.prototype.getPackage=function(e){return this.registry.getPackage(e)};Mt.prototype.getPackages=function(){return this.registry.getPackages()};Mt.prototype.getElementDescriptor=function(e){return e.$descriptor};Mt.prototype.hasType=function(e,t){t===void 0&&(t=e,e=this);var n=e.$model.getElementDescriptor(e);return t in n.allTypesByName};Mt.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]};Mt.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var Mp=String.fromCharCode,Wy=Object.prototype.hasOwnProperty,Uy=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/ig,lr={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};Object.keys(lr).forEach(function(e){lr[e.toUpperCase()]=lr[e]});function Yy(e,t,n,i){return i?Wy.call(lr,i)?lr[i]:"&"+i+";":Mp(t||parseInt(n,16))}function ni(e){return e.length>3&&e.indexOf("&")!==-1?e.replace(Uy,Yy):e}var qy="http://www.w3.org/2001/XMLSchema-instance",Ky="xsi",Dp="xsi:type",Np="non-whitespace outside of root node";function Pi(e){return new Error(e)}function Op(e){return"missing namespace for prefix <"+e+">"}function Ca(e){return{get:e,enumerable:!0}}function Xy(e){var t={},n;for(n in e)t[n]=e[n];return t}function Us(e){return e+"$uri"}function Zy(e){var t={},n,i;for(n in e)i=e[n],t[i]=i,t[Us(i)]=n;return t}function Ip(){return{line:0,column:0}}function Qy(e){throw e}function kp(e){if(!this)return new kp(e);var t=e&&e.proxy,n,i,r,a,o=Qy,s,c,u,l,p=Ip,h=!1,f=!1,d=null,y=!1,x;function D(b){b instanceof Error||(b=Pi(b)),d=b,o(b,p)}function A(b){!s||(b instanceof Error||(b=Pi(b)),s(b,p))}this.on=function(b,_){if(typeof _!="function")throw Pi("required args <name, cb>");switch(b){case"openTag":i=_;break;case"text":n=_;break;case"closeTag":r=_;break;case"error":o=_;break;case"warn":s=_;break;case"cdata":a=_;break;case"attention":l=_;break;case"question":u=_;break;case"comment":c=_;break;default:throw Pi("unsupported event: "+b)}return this},this.ns=function(b){if(typeof b=="undefined"&&(b={}),typeof b!="object")throw Pi("required args <nsMap={}>");var _={},M;for(M in b)_[M]=b[M];return _[qy]=Ky,f=!0,x=_,this},this.parse=function(b){if(typeof b!="string")throw Pi("required args <xml=string>");return d=null,w(b),p=Ip,y=!1,d},this.stop=function(){y=!0};function w(b){var _=f?[]:null,M=f?Zy(x):null,N,P=[],$=0,z=!1,Y=!1,W=0,X=0,ge,$t,be,le,S,v,R,O,F,k="",B=0,G;function re(){if(G!==null)return G;var Re,pe,de,Ve=f&&M.xmlns,We=f&&h?[]:null,we=B,Pe=k,ct=Pe.length,ut,rt,Ne,yt,Ee,Ge={},ta={},Et,J,xe;e:for(;we<ct;we++)if(Et=!1,J=Pe.charCodeAt(we),!(J===32||J<14&&J>8)){for((J<65||J>122||J>90&&J<97)&&J!==95&&J!==58&&(A("illegal first char attribute name"),Et=!0),xe=we+1;xe<ct;xe++)if(J=Pe.charCodeAt(xe),!(J>96&&J<123||J>64&&J<91||J>47&&J<59||J===46||J===45||J===95)){if(J===32||J<14&&J>8){A("missing attribute value"),we=xe;continue e}if(J===61)break;A("illegal attribute name char"),Et=!0}if(Ee=Pe.substring(we,xe),Ee==="xmlns:xmlns"&&(A("illegal declaration of xmlns"),Et=!0),J=Pe.charCodeAt(xe+1),J===34)xe=Pe.indexOf('"',we=xe+2),xe===-1&&(xe=Pe.indexOf("'",we),xe!==-1&&(A("attribute value quote missmatch"),Et=!0));else if(J===39)xe=Pe.indexOf("'",we=xe+2),xe===-1&&(xe=Pe.indexOf('"',we),xe!==-1&&(A("attribute value quote missmatch"),Et=!0));else for(A("missing attribute value quotes"),Et=!0,xe=xe+1;xe<ct&&(J=Pe.charCodeAt(xe+1),!(J===32||J<14&&J>8));xe++);for(xe===-1&&(A("missing closing quotes"),xe=ct,Et=!0),Et||(Ne=Pe.substring(we,xe)),we=xe;xe+1<ct&&(J=Pe.charCodeAt(xe+1),!(J===32||J<14&&J>8));xe++)we===xe&&(A("illegal character after attribute end"),Et=!0);if(we=xe+1,Et)continue e;if(Ee in ta){A("attribute <"+Ee+"> already defined");continue}if(ta[Ee]=!0,!f){Ge[Ee]=Ne;continue}if(h){if(rt=Ee==="xmlns"?"xmlns":Ee.charCodeAt(0)===120&&Ee.substr(0,6)==="xmlns:"?Ee.substr(6):null,rt!==null){if(Re=ni(Ne),pe=Us(rt),yt=x[Re],!yt){if(rt==="xmlns"||pe in M&&M[pe]!==Re)do yt="ns"+$++;while(typeof M[yt]!="undefined");else yt=rt;x[Re]=yt}M[rt]!==yt&&(ut||(M=Xy(M),ut=!0),M[rt]=yt,rt==="xmlns"&&(M[Us(yt)]=Re,Ve=yt),M[pe]=Re),Ge[Ee]=Ne;continue}We.push(Ee,Ne);continue}if(J=Ee.indexOf(":"),J===-1){Ge[Ee]=Ne;continue}if(!(de=M[Ee.substring(0,J)])){A(Op(Ee.substring(0,J)));continue}Ee=Ve===de?Ee.substr(J+1):de+Ee.substr(J),Ee===Dp&&(J=Ne.indexOf(":"),J!==-1?(de=Ne.substring(0,J),de=M[de]||de,Ne=de+Ne.substring(J)):Ne=Ve+":"+Ne),Ge[Ee]=Ne}if(h)for(we=0,ct=We.length;we<ct;we++){if(Ee=We[we++],Ne=We[we],J=Ee.indexOf(":"),J!==-1){if(!(de=M[Ee.substring(0,J)])){A(Op(Ee.substring(0,J)));continue}Ee=Ve===de?Ee.substr(J+1):de+Ee.substr(J),Ee===Dp&&(J=Ne.indexOf(":"),J!==-1?(de=Ne.substring(0,J),de=M[de]||de,Ne=de+Ne.substring(J)):Ne=Ve+":"+Ne)}Ge[Ee]=Ne}return G=Ge}function oe(){for(var Re=/(\r\n|\r|\n)/g,pe=0,de=0,Ve=0,We=X,we,Pe;W>=Ve&&(we=Re.exec(b),!(!we||(We=we[0].length+we.index,We>W)));)pe+=1,Ve=We;return W==-1?(de=We,Pe=b.substring(X)):X===0?Pe=b.substring(X,W):(de=W-Ve,Pe=X==-1?b.substring(W):b.substring(W,X+1)),{data:Pe,line:pe,column:de}}for(p=oe,t&&(F=Object.create({},{name:Ca(function(){return R}),originalName:Ca(function(){return O}),attrs:Ca(re),ns:Ca(function(){return M})}));X!==-1;){if(b.charCodeAt(X)===60?W=X:W=b.indexOf("<",X),W===-1){if(P.length)return D("unexpected end of file");if(X===0)return D("missing start tag");X<b.length&&b.substring(X).trim()&&A(Np);return}if(X!==W){if(P.length){if(n&&(n(b.substring(X,W),ni,p),y))return}else if(b.substring(X,W).trim()&&(A(Np),y))return}if(le=b.charCodeAt(W+1),le===33){if(be=b.charCodeAt(W+2),be===91&&b.substr(W+3,6)==="CDATA["){if(X=b.indexOf("]]>",W),X===-1)return D("unclosed cdata");if(a&&(a(b.substring(W+9,X),p),y))return;X+=3;continue}if(be===45&&b.charCodeAt(W+3)===45){if(X=b.indexOf("-->",W),X===-1)return D("unclosed comment");if(c&&(c(b.substring(W+4,X),ni,p),y))return;X+=3;continue}}if(le===63){if(X=b.indexOf("?>",W),X===-1)return D("unclosed question");if(u&&(u(b.substring(W,X+2),p),y))return;X+=2;continue}for(ge=W+1;;ge++){if(S=b.charCodeAt(ge),isNaN(S))return X=-1,D("unclosed tag");if(S===34)be=b.indexOf('"',ge+1),ge=be!==-1?be:ge;else if(S===39)be=b.indexOf("'",ge+1),ge=be!==-1?be:ge;else if(S===62){X=ge;break}}if(le===33){if(l&&(l(b.substring(W,X+1),ni,p),y))return;X+=1;continue}if(G={},le===47){if(z=!1,Y=!0,!P.length)return D("missing open tag");if(ge=R=P.pop(),be=W+2+ge.length,b.substring(W+2,be)!==ge)return D("closing tag mismatch");for(;be<X;be++)if(le=b.charCodeAt(be),!(le===32||le>8&&le<14))return D("close tag")}else{if(b.charCodeAt(X-1)===47?(ge=R=b.substring(W+1,X-1),z=!0,Y=!0):(ge=R=b.substring(W+1,X),z=!0,Y=!1),!(le>96&&le<123||le>64&&le<91||le===95||le===58))return D("illegal first char nodeName");for(be=1,$t=ge.length;be<$t;be++)if(le=ge.charCodeAt(be),!(le>96&&le<123||le>64&&le<91||le>47&&le<59||le===45||le===95||le==46)){if(le===32||le<14&&le>8){R=ge.substring(0,be),G=null;break}return D("invalid nodeName")}Y||P.push(R)}if(f){if(N=M,z&&(Y||_.push(N),G===null&&(h=ge.indexOf("xmlns",be)!==-1)&&(B=be,k=ge,re(),h=!1)),O=R,le=R.indexOf(":"),le!==-1){if(v=M[R.substring(0,le)],!v)return D("missing namespace on <"+O+">");R=R.substr(le+1)}else v=M.xmlns;v&&(R=v+":"+R)}if(z&&(B=be,k=ge,i&&(t?i(F,ni,Y,p):i(R,re,ni,Y,p),y)))return;if(Y){if(r&&(r(t?F:R,ni,z,p),y))return;f&&(z?M=N:M=_.pop())}X+=1}}}function Lp(e){return e.xml&&e.xml.tagAlias==="lowerCase"}var Jy={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},Pa="xsi:type";function Bp(e){return e.xml&&e.xml.serialize}function $p(e){return Bp(e)===Pa}function eE(e){return Bp(e)==="property"}function tE(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Fp(e,t){return Lp(t)?e.prefix+":"+tE(e.localName):e.name}function nE(e,t){var n=e.name,i=e.localName,r=t.xml&&t.xml.typePrefix;return r&&i.indexOf(r)===0?e.prefix+":"+i.slice(r.length):n}function iE(e,t){var n=ft(e),i=t.getPackage(n.prefix);return nE(n,i)}function $n(e){return new Error(e)}function gn(e){return e.$descriptor}function rE(e){I(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(t){this.references.push(t)},this.addElement=function(t){if(!t)throw $n("expected element");var n=this.elementsById,i=gn(t),r=i.idProperty,a;if(r&&(a=t.get(r.name),a)){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(a))throw new Error("illegal ID <"+a+">");if(n[a])throw $n("duplicate ID <"+a+">");n[a]=t}},this.addWarning=function(t){this.warnings.push(t)}}function pr(){}pr.prototype.handleEnd=function(){};pr.prototype.handleText=function(){};pr.prototype.handleNode=function(){};function Ys(){}Ys.prototype=Object.create(pr.prototype);Ys.prototype.handleNode=function(){return this};function Ai(){}Ai.prototype=Object.create(pr.prototype);Ai.prototype.handleText=function(e){this.body=(this.body||"")+e};function fr(e,t){this.property=e,this.context=t}fr.prototype=Object.create(Ai.prototype);fr.prototype.handleNode=function(e){if(this.element)throw $n("expected no sub nodes");return this.element=this.createReference(e),this};fr.prototype.handleEnd=function(){this.element.id=this.body};fr.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}};function qs(e,t){this.element=t,this.propertyDesc=e}qs.prototype=Object.create(Ai.prototype);qs.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=Vs(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)};function Aa(){}Aa.prototype=Object.create(Ai.prototype);Aa.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t};function ot(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}ot.prototype=Object.create(Aa.prototype);ot.prototype.addReference=function(e){this.context.addReference(e)};ot.prototype.handleText=function(e){var t=this.element,n=gn(t),i=n.bodyProperty;if(!i)throw $n("unexpected body text <"+e+">");Ai.prototype.handleText.call(this,e)};ot.prototype.handleEnd=function(){var e=this.body,t=this.element,n=gn(t),i=n.bodyProperty;i&&e!==void 0&&(e=Vs(i.type,e),t.set(i.name,e))};ot.prototype.createElement=function(e){var t=e.attributes,n=this.type,i=gn(n),r=this.context,a=new n({}),o=this.model,s;return C(t,function(c,u){var l=i.propertiesByName[u],p;l&&l.isReference?l.isMany?(p=c.split(" "),C(p,function(h){r.addReference({element:a,property:l.ns.name,id:h})})):r.addReference({element:a,property:l.ns.name,id:c}):(l?c=Vs(l.type,c):u!=="xmlns"&&(s=ft(u,i.ns.prefix),o.getPackage(s.prefix)&&r.addWarning({message:"unknown attribute <"+u+">",element:a,property:u,value:c})),a.set(u,c))}),a};ot.prototype.getPropertyForNode=function(e){var t=e.name,n=ft(t),i=this.type,r=this.model,a=gn(i),o=n.name,s=a.propertiesByName[o],c,u;if(s&&!s.isAttr)return $p(s)&&(c=e.attributes[Pa],c)?(c=iE(c,r),u=r.getType(c),I({},s,{effectiveType:gn(u).name})):s;var l=r.getPackage(n.prefix);if(l){if(c=Fp(n,l),u=r.getType(c),s=_e(a.properties,function(p){return!p.isVirtual&&!p.isReference&&!p.isAttribute&&u.hasType(p.type)}),s)return I({},s,{effectiveType:gn(u).name})}else if(s=_e(a.properties,function(p){return!p.isReference&&!p.isAttribute&&p.type==="Element"}),s)return s;throw $n("unrecognized element <"+n.name+">")};ot.prototype.toString=function(){return"ElementDescriptor["+gn(this.type).name+"]"};ot.prototype.valueHandler=function(e,t){return new qs(e,t)};ot.prototype.referenceHandler=function(e){return new fr(e,this.context)};ot.prototype.handler=function(e){return e==="Element"?new Mi(this.model,e,this.context):new ot(this.model,e,this.context)};ot.prototype.handleChild=function(e){var t,n,i,r;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,Cp(n))return this.valueHandler(t,i);t.isReference?r=this.referenceHandler(t).handleNode(e):r=this.handler(n).handleNode(e);var a=r.element;return a!==void 0&&(t.isMany?i.get(t.name).push(a):i.set(t.name,a),t.isReference?(I(a,{element:i}),this.context.addReference(a)):a.$parent=i),r};function Ks(e,t,n){ot.call(this,e,t,n)}Ks.prototype=Object.create(ot.prototype);Ks.prototype.createElement=function(e){var t=e.name,n=ft(t),i=this.model,r=this.type,a=i.getPackage(n.prefix),o=a&&Fp(n,a)||t;if(!r.hasType(o))throw $n("unexpected element <"+e.originalName+">");return ot.prototype.createElement.call(this,e)};function Mi(e,t,n){this.model=e,this.context=n}Mi.prototype=Object.create(Aa.prototype);Mi.prototype.createElement=function(e){var t=e.name,n=ft(t),i=n.prefix,r=e.ns[i+"$uri"],a=e.attributes;return this.model.createAny(t,r,a)};Mi.prototype.handleChild=function(e){var t=new Mi(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element,r;return i!==void 0&&(r=n.$children=n.$children||[],r.push(i),i.$parent=n),t};Mi.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)};function Xs(e){e instanceof Mt&&(e={model:e}),I(this,{lax:!1},e)}Xs.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof ot?(i=t,t={}):typeof t=="string"?(i=this.handler(t),t={}):typeof i=="string"&&(i=this.handler(i));var r=this.model,a=this.lax,o=new rE(I({},t,{rootHandler:i})),s=new kp({proxy:!0}),c=aE();i.context=o,c.push(i);function u(_,M,N){var P=M(),$=P.line,z=P.column,Y=P.data;Y.charAt(0)==="<"&&Y.indexOf(" ")!==-1&&(Y=Y.slice(0,Y.indexOf(" "))+">");var W="unparsable content "+(Y?Y+" ":"")+`detected
	line: `+$+`
	column: `+z+`
	nested error: `+_.message;if(N)return o.addWarning({message:W,error:_}),!0;throw $n(W)}function l(_,M){return u(_,M,!0)}function p(){var _=o.elementsById,M=o.references,N,P;for(N=0;P=M[N];N++){var $=P.element,z=_[P.id],Y=gn($).propertiesByName[P.property];if(z||o.addWarning({message:"unresolved reference <"+P.id+">",element:P.element,property:P.property,value:P.id}),Y.isMany){var W=$.get(Y.name),X=W.indexOf(P);X===-1&&(X=W.length),z?W[X]=z:W.splice(X,1)}else $.set(Y.name,z)}}function h(){c.pop().handleEnd()}var f=/^<\?xml /i,d=/ encoding="([^"]+)"/i,y=/^utf-8$/i;function x(_){if(!!f.test(_)){var M=d.exec(_),N=M&&M[1];!N||y.test(N)||o.addWarning({message:"unsupported document encoding <"+N+">, falling back to UTF-8"})}}function D(_,M){var N=c.peek();try{c.push(N.handleNode(_))}catch(P){u(P,M,a)&&c.push(new Ys)}}function A(_,M){try{c.peek().handleText(_)}catch(N){l(N,M)}}function w(_,M){!_.trim()||A(_,M)}var b=r.getPackages().reduce(function(_,M){return _[M.uri]=M.prefix,_},{"http://www.w3.org/XML/1998/namespace":"xml"});return s.ns(b).on("openTag",function(_,M,N,P){var $=_.attrs||{},z=Object.keys($).reduce(function(W,X){var ge=M($[X]);return W[X]=ge,W},{}),Y={name:_.name,originalName:_.originalName,attributes:z,ns:_.ns};D(Y,P)}).on("question",x).on("closeTag",h).on("cdata",A).on("text",function(_,M,N){w(M(_),N)}).on("error",u).on("warn",l),new Promise(function(_,M){var N;try{s.parse(e),p()}catch(W){N=W}var P=i.element;!N&&!P&&(N=$n("failed to parse document as <"+i.type.$descriptor.name+">"));var $=o.warnings,z=o.references,Y=o.elementsById;return N?(N.warnings=$,M(N)):_({rootElement:P,elementsById:Y,references:z,warnings:$})})};Xs.prototype.handler=function(e){return new Ks(this.model,e)};function aE(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}var oE=`<?xml version="1.0" encoding="UTF-8"?>
`,sE=/<|>|'|"|&|\n\r|\n/g,jp=/<|>|&/g;function cE(e){var t={},n={},i={},r=[],a=[];this.byUri=function(o){return n[o]||e&&e.byUri(o)},this.add=function(o,s){n[o.uri]=o,s?r.push(o):a.push(o),this.mapPrefix(o.prefix,o.uri)},this.uriByPrefix=function(o){return t[o||"xmlns"]},this.mapPrefix=function(o,s){t[o||"xmlns"]=s},this.getNSKey=function(o){return o.prefix!==void 0?o.uri+"|"+o.prefix:o.uri},this.logUsed=function(o){var s=o.uri,c=this.getNSKey(o);i[c]=this.byUri(s),e&&e.logUsed(o)},this.getUsed=function(o){function s(l){var p=c.getNSKey(l);return i[p]}var c=this,u=[].concat(r,a);return u.filter(s)}}function uE(e){return e.charAt(0).toLowerCase()+e.slice(1)}function lE(e,t){return Lp(t)?uE(e):e}function Hp(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function zp(e){return Pt(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function pE(e){return e.getUsed().filter(function(t){return t.prefix!=="xml"}).map(function(t){var n="xmlns"+(t.prefix?":"+t.prefix:"");return{name:n,value:t.uri}})}function fE(e,t){return t.isGeneric?I({localName:t.ns.localName},e):I({localName:lE(t.ns.localName,t.$pkg)},e)}function hE(e,t){return I({localName:t.ns.localName},e)}function dE(e){var t=e.$descriptor;return se(t.properties,function(n){var i=n.name;if(n.isVirtual||!hn(e,i))return!1;var r=e[i];return r===n.default||r===null?!1:n.isMany?r.length:!0})}var vE={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},mE={"<":"lt",">":"gt","&":"amp"};function Gp(e,t,n){return e=Pt(e)?e:""+e,e.replace(t,function(i){return"&"+n[i]+";"})}function gE(e){return Gp(e,sE,vE)}function yE(e){return Gp(e,jp,mE)}function EE(e){return se(e,function(t){return t.isAttr})}function bE(e){return se(e,function(t){return!t.isAttr})}function Zs(e){this.tagName=e}Zs.prototype.build=function(e){return this.element=e,this};Zs.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()};function ii(){}ii.prototype.serializeValue=ii.prototype.serializeTo=function(e){e.append(this.escape?yE(this.value):this.value)};ii.prototype.build=function(e,t){return this.value=t,e.type==="String"&&t.search(jp)!==-1&&(this.escape=!0),this};function Qs(e){this.tagName=e}Hp(Qs,ii);Qs.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()};function Ae(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}Ae.prototype.build=function(e){this.element=e;var t=e.$descriptor,n=this.propertyDescriptor,i,r,a=t.isGeneric;return a?i=this.parseGeneric(e):i=this.parseNsAttributes(e),n?this.ns=this.nsPropertyTagName(n):this.ns=this.nsTagName(t),this.tagName=this.addTagName(this.ns),a||(r=dE(e),this.parseAttributes(EE(r)),this.parseContainments(bE(r))),this.parseGenericAttributes(e,i),this};Ae.prototype.nsTagName=function(e){var t=this.logNamespaceUsed(e.ns);return fE(t,e)};Ae.prototype.nsPropertyTagName=function(e){var t=this.logNamespaceUsed(e.ns);return hE(t,e)};Ae.prototype.isLocalNs=function(e){return e.uri===this.ns.uri};Ae.prototype.nsAttributeName=function(e){var t;if(Pt(e)?t=ft(e):t=e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:I({localName:t.localName},n)};Ae.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return C(e,function(r,a){var o;a==="$body"?n.push(new ii().build({type:"String"},r)):a==="$children"?C(r,function(s){n.push(new Ae(t).build(s))}):a.indexOf("$")!==0&&(o=t.parseNsAttribute(e,a,r),o&&i.push({name:a,value:r}))}),i};Ae.prototype.parseNsAttribute=function(e,t,n){var i=e.$model,r=ft(t),a;if(r.prefix==="xmlns"&&(a={prefix:r.localName,uri:n}),!r.prefix&&r.localName==="xmlns"&&(a={uri:n}),!a)return{name:t,value:n};if(i&&i.getPackage(n))this.logNamespace(a,!0,!0);else{var o=this.logNamespaceUsed(a,!0);this.getNamespaces().logUsed(o)}};Ae.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,r=[];return C(i,function(a,o){var s=n.parseNsAttribute(e,o,a);s&&r.push(s)}),r};Ae.prototype.parseGenericAttributes=function(e,t){var n=this;C(t,function(i){if(i.name!==Pa)try{n.addAttribute(n.nsAttributeName(i.name),i.value)}catch(r){console.warn("missing namespace information for ",i.name,"=",i.value,"on",e,r)}})};Ae.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;C(e,function(r){var a=i.get(r.name),o=r.isReference,s=r.isMany;if(s||(a=[a]),r.isBody)n.push(new ii().build(r,a[0]));else if(Cp(r.type))C(a,function(l){n.push(new Qs(t.addTagName(t.nsPropertyTagName(r))).build(r,l))});else if(o)C(a,function(l){n.push(new Zs(t.addTagName(t.nsPropertyTagName(r))).build(l))});else{var c=$p(r),u=eE(r);C(a,function(l){var p;c?p=new Ma(t,r):u?p=new Ae(t,r):p=new Ae(t),n.push(p.build(l))})}})};Ae.prototype.getNamespaces=function(e){var t=this.namespaces,n=this.parent,i;return t||(i=n&&n.getNamespaces(),e||!i?this.namespaces=t=new cE(i):t=i),t};Ae.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,a=e.prefix,o=i.byUri(r);return(!o||n)&&i.add(e,t),i.mapPrefix(a,r),e};Ae.prototype.logNamespaceUsed=function(e,t){var n=this.element,i=n.$model,r=this.getNamespaces(t),a=e.prefix,o=e.uri,s,c,u;if(!a&&!o)return{localName:e.localName};if(u=Jy[a]||i&&(i.getPackage(a)||{}).uri,o=o||u||r.uriByPrefix(a),!o)throw new Error("no namespace uri given for prefix <"+a+">");if(e=r.byUri(o),!e){for(s=a,c=1;r.uriByPrefix(s);)s=a+"_"+c++;e=this.logNamespace({prefix:s,uri:o},u===o)}return a&&r.mapPrefix(a,o),e};Ae.prototype.parseAttributes=function(e){var t=this,n=this.element;C(e,function(i){var r=n.get(i.name);if(i.isReference)if(!i.isMany)r=r.id;else{var a=[];C(r,function(o){a.push(o.id)}),r=a.join(" ")}t.addAttribute(t.nsAttributeName(i),r)})};Ae.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),zp(e)};Ae.prototype.addAttribute=function(e,t){var n=this.attrs;Pt(t)&&(t=gE(t)),n.push({name:e,value:t})};Ae.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=pE(n).concat(t)),C(t,function(i){e.append(" ").append(zp(i.name)).append('="').append(i.value).append('"')})};Ae.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==ii;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),C(this.body,function(i){i.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()};function Ma(e,t){Ae.call(this,e,t)}Hp(Ma,Ae);Ma.prototype.parseNsAttributes=function(e){var t=Ae.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=e.$model.getPackage(i.uri),a=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(Pa),(i.prefix?i.prefix+":":"")+a+n.ns.localName),t};Ma.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};function xE(){this.value="",this.write=function(e){this.value+=e}}function _E(e,t){var n=[""];this.append=function(i){return e.write(i),this},this.appendNewLine=function(){return t&&e.write(`
`),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function wE(e){e=I({format:!1,preamble:!0},e||{});function t(n,i){var r=i||new xE,a=new _E(r,e.format);if(e.preamble&&a.append(oE),new Ae().build(n).serializeTo(a),!i)return r.value}return{toXML:t}}function Da(e,t){Mt.call(this,e,t)}Da.prototype=Object.create(Mt.prototype);Da.prototype.fromXML=function(e,t,n){Pt(t)||(n=t,t="bpmn:Definitions");var i=new Xs(I({model:this,lax:!0},n)),r=i.handler(t);return i.fromXML(e,r)};Da.prototype.toXML=function(e,t){var n=new wE(t);return new Promise(function(i,r){try{var a=n.toXML(e);return i({xml:a})}catch(o){return r(o)}})};var SE="BPMN20",TE="http://www.omg.org/spec/BPMN/20100524/MODEL",RE="bpmn",CE=[],PE=[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],AE=[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],ME={tagAlias:"lowerCase",typePrefix:"t"},DE={name:SE,uri:TE,prefix:RE,associations:CE,types:PE,enumerations:AE,xml:ME},NE="BPMNDI",OE="http://www.omg.org/spec/BPMN/20100524/DI",IE="bpmndi",kE=[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],LE=[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],BE=[],$E={name:NE,uri:OE,prefix:IE,types:kE,enumerations:LE,associations:BE},FE="DC",jE="http://www.omg.org/spec/DD/20100524/DC",HE="dc",zE=[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],GE=[],VE={name:FE,uri:jE,prefix:HE,types:zE,associations:GE},WE="DI",UE="http://www.omg.org/spec/DD/20100524/DI",YE="di",qE=[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],KE=[],XE={tagAlias:"lowerCase"},ZE={name:WE,uri:UE,prefix:YE,types:qE,associations:KE,xml:XE},QE="bpmn.io colors for BPMN",JE="http://bpmn.io/schema/bpmn/biocolor/1.0",eb="bioc",tb=[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],nb=[],ib=[],rb={name:QE,uri:JE,prefix:eb,types:tb,enumerations:nb,associations:ib},ab="BPMN in Color",ob="http://www.omg.org/spec/BPMN/non-normative/color/1.0",sb="color",cb=[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],ub=[],lb=[],pb={name:ab,uri:ob,prefix:sb,types:cb,enumerations:ub,associations:lb},fb={bpmn:DE,bpmndi:$E,dc:VE,di:ZE,bioc:rb,color:pb};function hb(e,t){var n=I({},fb,e);return new Da(n,t)}function et(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}var db=new Si({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function mt(e,t){return e.$instanceOf(t)}function vb(e){return _e(e.rootElements,function(t){return mt(t,"bpmn:Process")||mt(t,"bpmn:Collaboration")})}function mb(e,t){var n={},i=[];function r(k,B){return function(G){k(G,B)}}function a(k){n[k.id]=k}function o(k){return n[k.id]}function s(k,B){var G=k.gfx;if(G)throw new Error(t("already rendered {element}",{element:et(k)}));return e.element(k,B)}function c(k,B){return e.root(k,B)}function u(k,B){try{var G=k.di&&s(k,B);return a(k),G}catch(re){l(re.message,{element:k,error:re}),console.error(t("failed to import {element}",{element:et(k)})),console.error(re)}}function l(k,B){e.error(k,B)}function p(k){var B=k.bpmnElement;B?B.di?l(t("multiple DI elements defined for {element}",{element:et(B)}),{element:B}):(db.bind(B,"di"),B.di=k):l(t("no bpmnElement referenced in {element}",{element:et(k)}),{element:k})}function h(k){f(k.plane)}function f(k){p(k),C(k.planeElement,d)}function d(k){p(k)}function y(k,B){var G=k.diagrams;if(B&&G.indexOf(B)===-1)throw new Error(t("diagram not part of bpmn:Definitions"));if(!B&&G&&G.length&&(B=G[0]),!B)throw new Error(t("no diagram to display"));h(B);var re=B.plane;if(!re)throw new Error(t("no plane for {element}",{element:et(B)}));var oe=re.bpmnElement;if(!oe)if(oe=vb(k),oe)l(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:et(re),rootElement:et(oe)})),re.bpmnElement=oe,p(re);else throw new Error(t("no process or collaboration to display"));var Re=c(oe,re);if(mt(oe,"bpmn:Process"))D(oe,Re);else if(mt(oe,"bpmn:Collaboration"))O(oe),A(k.rootElements,Re);else throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:et(re),rootElement:et(oe)}));x()}function x(){for(var k;i.length;)k=i.shift(),k()}function D(k,B){S(k,B),z(k.ioSpecification,B),$(k.artifacts,B),a(k)}function A(k,B){var G=se(k,function(re){return!o(re)&&mt(re,"bpmn:Process")&&re.laneSets});G.forEach(r(D,B))}function w(k,B){u(k,B)}function b(k,B){C(k,r(w,B))}function _(k,B){u(k,B)}function M(k,B){u(k,B)}function N(k,B){u(k,B)}function P(k,B){u(k,B)}function $(k,B){C(k,function(G){mt(G,"bpmn:Association")?i.push(function(){P(G,B)}):P(G,B)})}function z(k,B){!k||(C(k.dataInputs,r(M,B)),C(k.dataOutputs,r(N,B)))}function Y(k,B){S(k,B),$(k.artifacts,B)}function W(k,B){var G=u(k,B);mt(k,"bpmn:SubProcess")&&Y(k,G||B),mt(k,"bpmn:Activity")&&z(k.ioSpecification,B),i.push(function(){C(k.dataInputAssociations,r(_,B)),C(k.dataOutputAssociations,r(_,B))})}function X(k,B){u(k,B)}function ge(k,B){u(k,B)}function $t(k,B){i.push(function(){var G=u(k,B);k.childLaneSet&&be(k.childLaneSet,G||B),F(k)})}function be(k,B){C(k.lanes,r($t,B))}function le(k,B){C(k,r(be,B))}function S(k,B){v(k.flowElements,B),k.laneSets&&le(k.laneSets,B)}function v(k,B){C(k,function(G){mt(G,"bpmn:SequenceFlow")?i.push(function(){X(G,B)}):mt(G,"bpmn:BoundaryEvent")?i.unshift(function(){W(G,B)}):mt(G,"bpmn:FlowNode")?W(G,B):mt(G,"bpmn:DataObject")||(mt(G,"bpmn:DataStoreReference")||mt(G,"bpmn:DataObjectReference")?ge(G,B):l(t("unrecognized flowElement {element} in context {context}",{element:et(G),context:B?et(B.businessObject):"null"}),{element:G,context:B}))})}function R(k,B){var G=u(k,B),re=k.processRef;re&&D(re,G||B)}function O(k){C(k.participants,r(R)),$(k.artifacts),i.push(function(){b(k.messageFlows)})}function F(k){C(k.flowNodeRef,function(B){var G=B.get("lanes");G&&G.push(k)})}return{handleDeferred:x,handleDefinitions:y,handleSubProcess:Y,registerDi:p}}function gb(e,t,n){var i,r,a,o,s=[];function c(u,l){var p={root:function(f){return i.add(f)},element:function(f,d){return i.add(f,d)},error:function(f,d){s.push({message:f,context:d})}},h=new mb(p,a);h.handleDefinitions(u,l)}return new Promise(function(u,l){try{return i=e.get("bpmnImporter"),r=e.get("eventBus"),a=e.get("translate"),r.fire("import.render.start",{definitions:t}),c(t,n),r.fire("import.render.complete",{error:o,warnings:s}),u({warnings:s})}catch(p){return p.warnings=s,l(p)}})}function Di(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(t>=1&&at(arguments[t-1])){var n=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var i=Array.prototype.slice.call(arguments,0,-1);e.apply(this,i).then(function(r){var a=Object.keys(r)[0];return n(null,r[a])},function(r){return n(r,r.warnings)})}else return e.apply(this,arguments)}}var yb='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',Vp=yb;function Na(e){return e.join(";")}var Wp=Na(["color: #404040"]),Eb=Na(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"]),bb=Na(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"]),xb=Na(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"]),_b='<div class="bjs-powered-by-lightbox" style="'+Eb+'"><div class="backdrop" style="'+bb+'"></div><div class="notice" style="'+xb+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+Wp+'">'+Vp+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>',hr;function wb(){hr||(hr=Ce(_b),_t.bind(hr,".backdrop","click",function(e){document.body.removeChild(hr)})),document.body.appendChild(hr)}function Me(e){e=I({},Tb,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),Cb(this._container),this._init(this._container,this._moddle,e)}Z(Me,Ri);Me.prototype.importXML=Di(function(t,n){var i=this;function r(a){var o=i.get("eventBus").createEvent(a);return Object.defineProperty(o,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:a.warnings,references:a.references,elementsById:a.elementsById}}}),o}return new Promise(function(a,o){t=i._emit("import.parse.start",{xml:t})||t,i._moddle.fromXML(t,"bpmn:Definitions").then(function(s){var c=s.rootElement,u=s.references,l=s.warnings,p=s.elementsById;c=i._emit("import.parse.complete",r({error:null,definitions:c,elementsById:p,references:u,warnings:l}))||c,i.importDefinitions(c,n).then(function(h){var f=[].concat(l,h.warnings||[]);return i._emit("import.done",{error:null,warnings:f}),a({warnings:f})}).catch(function(h){var f=[].concat(l,h.warnings||[]);return i._emit("import.done",{error:h,warnings:f}),o(Oa(h,f))})}).catch(function(s){return i._emit("import.parse.complete",{error:s}),s=Sb(s),i._emit("import.done",{error:s,warnings:s.warnings}),o(s)})})});Me.prototype.importDefinitions=Di(function(t,n){var i=this;return new Promise(function(r,a){i._setDefinitions(t),i.open(n).then(function(o){var s=o.warnings;return r({warnings:s})}).catch(function(o){return a(o)})})});Me.prototype.open=Di(function(t){var n=this._definitions,i=t,r=this;return new Promise(function(a,o){if(!n){var s=new Error("no XML imported");return o(Oa(s,[]))}if(typeof t=="string"&&(i=Rb(n,t),!i)){var c=new Error("BPMNDiagram <"+t+"> not found");return o(Oa(c,[]))}try{r.clear()}catch(u){return o(Oa(u,[]))}gb(r,n,i).then(function(u){var l=u.warnings;return a({warnings:l})}).catch(function(u){return o(u)})})});Me.prototype.saveXML=Di(function(t){t=t||{};var n=this,i=this._definitions;return new Promise(function(r){if(!i)return r({error:new Error("no definitions loaded")});i=n._emit("saveXML.start",{definitions:i})||i,n._moddle.toXML(i,t).then(function(a){var o=a.xml;return o=n._emit("saveXML.serialized",{xml:o})||o,r({xml:o})})}).catch(function(r){return{error:r}}).then(function(r){n._emit("saveXML.done",r);var a=r.error;return a?Promise.reject(a):r})});Me.prototype.saveSVG=Di(function(t){var n=this;return new Promise(function(i,r){n._emit("saveSVG.start");var a,o;try{var s=n.get("canvas"),c=s.getDefaultLayer(),u=Oe("defs",s._svg),l=Hl(c),p=u?"<defs>"+Hl(u)+"</defs>":"",h=c.getBBox();a=`<?xml version="1.0" encoding="utf-8"?>
<!-- created with bpmn-js / http://bpmn.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="`+h.width+'" height="'+h.height+'" viewBox="'+h.x+" "+h.y+" "+h.width+" "+h.height+'" version="1.1">'+p+l+"</svg>"}catch(f){o=f}return n._emit("saveSVG.done",{error:o,svg:a}),o?r(o):i({svg:a})})});Me.prototype._setDefinitions=function(e){this._definitions=e};Me.prototype.getModules=function(){return this._modules};Me.prototype.clear=function(){!this.getDefinitions()||(this.get("elementRegistry").forEach(function(e){var t=e.businessObject;t&&t.di&&delete t.di}),Ri.prototype.clear.call(this))};Me.prototype.destroy=function(){Ri.prototype.destroy.call(this),Qt(this._container)};Me.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)};Me.prototype.off=function(e,t){this.get("eventBus").off(e,t)};Me.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),typeof e=="string"&&(e=Oe(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()};Me.prototype.getDefinitions=function(){return this._definitions};Me.prototype.detach=function(){var e=this._container,t=e.parentNode;!t||(this._emit("detach",{}),t.removeChild(e))};Me.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],a=[{bpmnjs:["value",this],moddle:["value",t]}],o=[].concat(a,i,r),s=I(Pn(n,["additionalModules"]),{canvas:I({},n.canvas,{container:e}),modules:o});Ri.call(this,s),n&&n.container&&this.attachTo(n.container)};Me.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)};Me.prototype._createContainer=function(e){var t=Ce('<div class="bjs-container"></div>');return I(t.style,{width:Up(e.width),height:Up(e.height),position:e.position}),t};Me.prototype._createModdle=function(e){var t=I({},this._moddleExtensions,e.moddleExtensions);return new hb(t)};Me.prototype._modules=[];function Oa(e,t){return e.warnings=t,e}function Sb(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/,n=t.exec(e.message);return n&&(e.message="unparsable content <"+n[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+n[2]),e}var Tb={width:"100%",height:"100%",position:"relative"};function Up(e){return e+(ae(e)?"px":"")}function Rb(e,t){return t&&_e(e.diagrams,function(n){return n.id===t})||null}function Cb(e){var t=Vp,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+Wp+'">'+t+"</a>",i=Ce(n);e.appendChild(i),te.bind(i,"click",function(r){wb(),r.preventDefault()})}function dr(e){Me.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}Z(dr,Me);dr.prototype._createModdle=function(e){var t=Me.prototype._createModdle.call(this,e);return t.ids=new _l([32,36,1]),t};dr.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,r;i.clear();for(r in t)i.claim(r,t[r])};function m(e,t){var n=K(e);return n&&typeof n.$instanceOf=="function"&&n.$instanceOf(t)}function K(e){return e&&e.businessObject||e}function Se(e){return m(e,"bpmn:CallActivity")?!1:m(e,"bpmn:SubProcess")?K(e).di&&!!K(e).di.isExpanded:m(e,"bpmn:Participant")?!!K(e).processRef:!0}function Pb(e){return e&&K(e).isInterrupting!==!1}function Tt(e){return e&&!!K(e).triggeredByEvent}function Ia(e,t){var n=K(e),i=!1;return n.eventDefinitions&&C(n.eventDefinitions,function(r){m(r,t)&&(i=!0)}),i}function Ab(e){return Ia(e,"bpmn:ErrorEventDefinition")}function Mb(e){return Ia(e,"bpmn:EscalationEventDefinition")}function Db(e){return Ia(e,"bpmn:CompensateEventDefinition")}function Yp(e){if(m(e,"bpmn:FlowElement")||m(e,"bpmn:Participant")||m(e,"bpmn:Lane")||m(e,"bpmn:SequenceFlow")||m(e,"bpmn:MessageFlow")||m(e,"bpmn:DataInput")||m(e,"bpmn:DataOutput"))return"name";if(m(e,"bpmn:TextAnnotation"))return"text";if(m(e,"bpmn:Group"))return"categoryValueRef"}function Nb(e){var t=e.categoryValueRef;return t&&t.value||""}function Gt(e){var t=e.businessObject,n=Yp(t);if(n)return n==="categoryValueRef"?Nb(t):t[n]||""}function Ob(e,t,n){var i=e.businessObject,r=Yp(i);return r&&(r==="categoryValueRef"?i.categoryValueRef.value=t:i[r]=t),e}function tn(e,t,n){function i(r,a){return yi(a,function(o,s){return r[s]==o})}return Jn(e.eventDefinitions,function(r){return r.$type===t&&i(e,n)})}function Ib(e){return e.$type==="bpmn:IntermediateThrowEvent"||e.$type==="bpmn:EndEvent"}function kb(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}function Ni(e){return e.businessObject.di}function st(e){return e.businessObject}function ve(e,t){var n=Ni(e);return n.get("color:background-color")||n.get("bioc:fill")||t||"white"}function V(e,t){var n=Ni(e);return n.get("color:border-color")||n.get("bioc:stroke")||t||"black"}function vr(e,t,n){var i=Ni(e),r=i.get("label");return r&&r.get("color:color")||t||V(e,n)}function Lb(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,r=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return xi(r)}function Bb(e,t){var n=e.x,i=e.y,r=e.width,a=e.height,o=[["M",n+t,i],["l",r-t*2,0],["a",t,t,0,0,1,t,t],["l",0,a-t*2],["a",t,t,0,0,1,-t,t],["l",t*2-r,0],["a",t,t,0,0,1,-t,-t],["l",0,t*2-a],["a",t,t,0,0,1,t,-t],["z"]];return xi(o)}function $b(e){var t=e.width,n=e.height,i=e.x,r=e.y,a=t/2,o=n/2,s=[["M",i+a,r],["l",a,o],["l",-a,o],["l",-a,-o],["z"]];return xi(s)}function Fb(e){var t=e.x,n=e.y,i=e.width,r=e.height,a=[["M",t,n],["l",i,0],["l",0,r],["l",-i,0],["z"]];return xi(a)}var jb=new _l,ka=10,Js=3,Oi=.95,Hb=.35,zb=10;function ri(e,t,n,i,r,a,o){dn.call(this,t,o);var s=e&&e.defaultFillColor,c=e&&e.defaultStrokeColor,u=e&&e.defaultLabelColor,l=jb.next(),p={},h=n.computeStyle;function f(S,v){var R=I({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},v.attrs),O=v.ref||{x:0,y:0},F=v.scale||1;R.strokeDasharray==="none"&&(R.strokeDasharray=[1e4,1]);var k=Q("marker");H(v.element,R),ne(k,v.element),H(k,{id:S,viewBox:"0 0 20 20",refX:O.x,refY:O.y,markerWidth:20*F,markerHeight:20*F,orient:"auto"});var B=Oe("defs",r._svg);B||(B=Q("defs"),ne(r._svg,B)),ne(B,k),p[S]=k}function d(S){return S.replace(/[^0-9a-zA-z]+/g,"_")}function y(S,v,R){var O=S+"-"+d(v)+"-"+d(R)+"-"+l;return p[O]||x(O,S,v,R),"url(#"+O+")"}function x(S,v,R,O){if(v==="sequenceflow-end"){var F=Q("path");H(F,{d:"M 1 5 L 11 10 L 1 15 Z"}),f(S,{element:F,ref:{x:11,y:10},scale:.5,attrs:{fill:O,stroke:O}})}if(v==="messageflow-start"){var k=Q("circle");H(k,{cx:6,cy:6,r:3.5}),f(S,{element:k,attrs:{fill:R,stroke:O},ref:{x:6,y:6}})}if(v==="messageflow-end"){var B=Q("path");H(B,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),f(S,{element:B,attrs:{fill:R,stroke:O,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if(v==="association-start"){var G=Q("path");H(G,{d:"M 11 5 L 1 10 L 11 15"}),f(S,{element:G,attrs:{fill:"none",stroke:O,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if(v==="association-end"){var re=Q("path");H(re,{d:"M 1 5 L 11 10 L 1 15"}),f(S,{element:re,attrs:{fill:"none",stroke:O,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if(v==="conditional-flow-marker"){var oe=Q("path");H(oe,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),f(S,{element:oe,attrs:{fill:R,stroke:O},ref:{x:-1,y:10},scale:.5})}if(v==="conditional-default-flow-marker"){var Re=Q("path");H(Re,{d:"M 6 4 L 10 16"}),f(S,{element:Re,attrs:{stroke:O},ref:{x:0,y:10},scale:.5})}}function D(S,v,R,O,F){Ze(O)&&(F=O,O=0),O=O||0,F=h(F,{stroke:"black",strokeWidth:2,fill:"white"}),F.fill==="none"&&delete F.fillOpacity;var k=v/2,B=R/2,G=Q("circle");return H(G,{cx:k,cy:B,r:Math.round((v+R)/4-O)}),H(G,F),ne(S,G),G}function A(S,v,R,O,F,k){Ze(F)&&(k=F,F=0),F=F||0,k=h(k,{stroke:"black",strokeWidth:2,fill:"white"});var B=Q("rect");return H(B,{x:F,y:F,width:v-F*2,height:R-F*2,rx:O,ry:O}),H(B,k),ne(S,B),B}function w(S,v,R,O){var F=v/2,k=R/2,B=[{x:F,y:0},{x:v,y:k},{x:F,y:R},{x:0,y:k}],G=B.map(function(oe){return oe.x+","+oe.y}).join(" ");O=h(O,{stroke:"black",strokeWidth:2,fill:"white"});var re=Q("polygon");return H(re,{points:G}),H(re,O),ne(S,re),re}function b(S,v,R){R=h(R,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var O=Ns(v,R);return ne(S,O),O}function _(S,v,R){R=h(R,["no-fill"],{strokeWidth:2,stroke:"black"});var O=Q("path");return H(O,{d:v}),H(O,R),ne(S,O),O}function M(S,v,R,O){return _(v,R,I({"data-marker":S},O))}function N(S){return function(v,R){return $t[S](v,R)}}function P(S){return $t[S]}function $(S,v){var R=st(S),O=Ib(R);return R.eventDefinitions&&R.eventDefinitions.length>1?R.parallelMultiple?P("bpmn:ParallelMultipleEventDefinition")(v,S,O):P("bpmn:MultipleEventDefinition")(v,S,O):tn(R,"bpmn:MessageEventDefinition")?P("bpmn:MessageEventDefinition")(v,S,O):tn(R,"bpmn:TimerEventDefinition")?P("bpmn:TimerEventDefinition")(v,S,O):tn(R,"bpmn:ConditionalEventDefinition")?P("bpmn:ConditionalEventDefinition")(v,S):tn(R,"bpmn:SignalEventDefinition")?P("bpmn:SignalEventDefinition")(v,S,O):tn(R,"bpmn:EscalationEventDefinition")?P("bpmn:EscalationEventDefinition")(v,S,O):tn(R,"bpmn:LinkEventDefinition")?P("bpmn:LinkEventDefinition")(v,S,O):tn(R,"bpmn:ErrorEventDefinition")?P("bpmn:ErrorEventDefinition")(v,S,O):tn(R,"bpmn:CancelEventDefinition")?P("bpmn:CancelEventDefinition")(v,S,O):tn(R,"bpmn:CompensateEventDefinition")?P("bpmn:CompensateEventDefinition")(v,S,O):tn(R,"bpmn:TerminateEventDefinition")?P("bpmn:TerminateEventDefinition")(v,S,O):null}function z(S,v,R){R=I({size:{width:100}},R);var O=a.createText(v||"",R);return he(O).add("djs-label"),ne(S,O),O}function Y(S,v,R){var O=st(v);return z(S,O.name,{box:v,align:R,padding:5,style:{fill:vr(v,u,c)}})}function W(S,v){var R={width:90,height:30,x:v.width/2+v.x,y:v.height/2+v.y};return z(S,Gt(v),{box:R,fitBox:!0,style:I({},a.getExternalStyle(),{fill:vr(v,u,c)})})}function X(S,v,R){var O=z(S,v,{box:{height:30,width:R.height},align:"center-middle",style:{fill:vr(R,u,c)}}),F=-1*R.height;zs(O,0,-F,270)}function ge(S){for(var v=S.waypoints,R="m  "+v[0].x+","+v[0].y,O=1;O<v.length;O++)R+="L"+v[O].x+","+v[O].y+" ";return R}var $t=this.handlers={"bpmn:Event":function(S,v,R){return"fillOpacity"in R||(R.fillOpacity=Oi),D(S,v.width,v.height,R)},"bpmn:StartEvent":function(S,v){var R={fill:ve(v,s),stroke:V(v,c)},O=st(v);O.isInterrupting||(R={strokeDasharray:"6",strokeLinecap:"round",fill:ve(v,s),stroke:V(v,c)});var F=P("bpmn:Event")(S,v,R);return $(v,S),F},"bpmn:MessageEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:v.width,containerHeight:v.height,position:{mx:.235,my:.315}}),F=R?V(v,c):ve(v,s),k=R?ve(v,s):V(v,c),B=_(S,O,{strokeWidth:1,fill:F,stroke:k});return B},"bpmn:TimerEventDefinition":function(S,v){var R=D(S,v.width,v.height,.2*v.height,{strokeWidth:2,fill:ve(v,s),stroke:V(v,c)}),O=i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:v.width,containerHeight:v.height,position:{mx:.5,my:.5}});_(S,O,{strokeWidth:2,strokeLinecap:"square",stroke:V(v,c)});for(var F=0;F<12;F++){var k=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:v.width,containerHeight:v.height,position:{mx:.5,my:.5}}),B=v.width/2,G=v.height/2;_(S,k,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+F*30+","+G+","+B+")",stroke:V(v,c)})}return R},"bpmn:EscalationEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.5,my:.2}}),F=R?V(v,c):"none";return _(S,O,{strokeWidth:1,fill:F,stroke:V(v,c)})},"bpmn:ConditionalEventDefinition":function(S,v){var R=i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.5,my:.222}});return _(S,R,{strokeWidth:1,stroke:V(v,c)})},"bpmn:LinkEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.57,my:.263}}),F=R?V(v,c):"none";return _(S,O,{strokeWidth:1,fill:F,stroke:V(v,c)})},"bpmn:ErrorEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:v.width,containerHeight:v.height,position:{mx:.2,my:.722}}),F=R?V(v,c):"none";return _(S,O,{strokeWidth:1,fill:F,stroke:V(v,c)})},"bpmn:CancelEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.638,my:-.055}}),F=R?V(v,c):"none",k=_(S,O,{strokeWidth:1,fill:F,stroke:V(v,c)});return wp(k,45),k},"bpmn:CompensateEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.22,my:.5}}),F=R?V(v,c):"none";return _(S,O,{strokeWidth:1,fill:F,stroke:V(v,c)})},"bpmn:SignalEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:v.width,containerHeight:v.height,position:{mx:.5,my:.2}}),F=R?V(v,c):"none";return _(S,O,{strokeWidth:1,fill:F,stroke:V(v,c)})},"bpmn:MultipleEventDefinition":function(S,v,R){var O=i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:v.width,containerHeight:v.height,position:{mx:.222,my:.36}}),F=R?V(v,c):"none";return _(S,O,{strokeWidth:1,fill:F})},"bpmn:ParallelMultipleEventDefinition":function(S,v){var R=i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:v.width,containerHeight:v.height,position:{mx:.458,my:.194}});return _(S,R,{strokeWidth:1,fill:V(v,c),stroke:V(v,c)})},"bpmn:EndEvent":function(S,v){var R=P("bpmn:Event")(S,v,{strokeWidth:4,fill:ve(v,s),stroke:V(v,c)});return $(v,S),R},"bpmn:TerminateEventDefinition":function(S,v){var R=D(S,v.width,v.height,8,{strokeWidth:4,fill:V(v,c),stroke:V(v,c)});return R},"bpmn:IntermediateEvent":function(S,v){var R=P("bpmn:Event")(S,v,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c)});return D(S,v.width,v.height,Js,{strokeWidth:1,fill:ve(v,"none"),stroke:V(v,c)}),$(v,S),R},"bpmn:IntermediateCatchEvent":N("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":N("bpmn:IntermediateEvent"),"bpmn:Activity":function(S,v,R){return R=R||{},"fillOpacity"in R||(R.fillOpacity=Oi),A(S,v.width,v.height,ka,R)},"bpmn:Task":function(S,v){var R={fill:ve(v,s),stroke:V(v,c)},O=P("bpmn:Activity")(S,v,R);return Y(S,v,"center-middle"),be(S,v),O},"bpmn:ServiceTask":function(S,v){var R=P("bpmn:Task")(S,v),O=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}});_(S,O,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c)});var F=i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}});_(S,F,{strokeWidth:0,fill:ve(v,s)});var k=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}});return _(S,k,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c)}),R},"bpmn:UserTask":function(S,v){var R=P("bpmn:Task")(S,v),O=15,F=12,k=i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:O,y:F}});_(S,k,{strokeWidth:.5,fill:ve(v,s),stroke:V(v,c)});var B=i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:O,y:F}});_(S,B,{strokeWidth:.5,fill:ve(v,s),stroke:V(v,c)});var G=i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:O,y:F}});return _(S,G,{strokeWidth:.5,fill:V(v,c),stroke:V(v,c)}),R},"bpmn:ManualTask":function(S,v){var R=P("bpmn:Task")(S,v),O=i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}});return _(S,O,{strokeWidth:.5,fill:ve(v,s),stroke:V(v,c)}),R},"bpmn:SendTask":function(S,v){var R=P("bpmn:Task")(S,v),O=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}});return _(S,O,{strokeWidth:1,fill:V(v,c),stroke:ve(v,s)}),R},"bpmn:ReceiveTask":function(S,v){var R=st(v),O=P("bpmn:Task")(S,v),F;return R.instantiate?(D(S,28,28,20*.22,{strokeWidth:1}),F=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):F=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),_(S,F,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c)}),O},"bpmn:ScriptTask":function(S,v){var R=P("bpmn:Task")(S,v),O=i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}});return _(S,O,{strokeWidth:1,stroke:V(v,c)}),R},"bpmn:BusinessRuleTask":function(S,v){var R=P("bpmn:Task")(S,v),O=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),F=_(S,O);H(F,{strokeWidth:1,fill:ve(v,"#aaaaaa"),stroke:V(v,c)});var k=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),B=_(S,k);return H(B,{strokeWidth:1,stroke:V(v,c)}),R},"bpmn:SubProcess":function(S,v,R){R=I({fill:ve(v,s),stroke:V(v,c)},R);var O=P("bpmn:Activity")(S,v,R),F=Se(v);return Tt(v)&&H(O,{strokeDasharray:"1,2"}),Y(S,v,F?"center-top":"center-middle"),F?be(S,v):be(S,v,["SubProcessMarker"]),O},"bpmn:AdHocSubProcess":function(S,v){return P("bpmn:SubProcess")(S,v)},"bpmn:Transaction":function(S,v){var R=P("bpmn:SubProcess")(S,v),O=n.style(["no-fill","no-events"],{stroke:V(v,c)});return A(S,v.width,v.height,ka-2,Js,O),R},"bpmn:CallActivity":function(S,v){return P("bpmn:SubProcess")(S,v,{strokeWidth:5})},"bpmn:Participant":function(S,v){var R={fillOpacity:Oi,fill:ve(v,s),stroke:V(v,c)},O=P("bpmn:Lane")(S,v,R),F=Se(v);if(F){b(S,[{x:30,y:0},{x:30,y:v.height}],{stroke:V(v,c)});var k=st(v).name;X(S,k,v)}else{var B=st(v).name;z(S,B,{box:v,align:"center-middle",style:{fill:vr(v,u,c)}})}var G=!!st(v).participantMultiplicity;return G&&P("ParticipantMultiplicityMarker")(S,v),O},"bpmn:Lane":function(S,v,R){var O=A(S,v.width,v.height,0,I({fill:ve(v,s),fillOpacity:Hb,stroke:V(v,c)},R)),F=st(v);if(F.$type==="bpmn:Lane"){var k=F.name;X(S,k,v)}return O},"bpmn:InclusiveGateway":function(S,v){var R=P("bpmn:Gateway")(S,v);return D(S,v.width,v.height,v.height*.24,{strokeWidth:2.5,fill:ve(v,s),stroke:V(v,c)}),R},"bpmn:ExclusiveGateway":function(S,v){var R=P("bpmn:Gateway")(S,v),O=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:v.width,containerHeight:v.height,position:{mx:.32,my:.3}});return Ni(v).isMarkerVisible&&_(S,O,{strokeWidth:1,fill:V(v,c),stroke:V(v,c)}),R},"bpmn:ComplexGateway":function(S,v){var R=P("bpmn:Gateway")(S,v),O=i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:v.width,containerHeight:v.height,position:{mx:.46,my:.26}});return _(S,O,{strokeWidth:1,fill:V(v,c),stroke:V(v,c)}),R},"bpmn:ParallelGateway":function(S,v){var R=P("bpmn:Gateway")(S,v),O=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:v.width,containerHeight:v.height,position:{mx:.46,my:.2}});return _(S,O,{strokeWidth:1,fill:V(v,c),stroke:V(v,c)}),R},"bpmn:EventBasedGateway":function(S,v){var R=st(v),O=P("bpmn:Gateway")(S,v);D(S,v.width,v.height,v.height*.2,{strokeWidth:1,fill:"none",stroke:V(v,c)});var F=R.eventGatewayType,k=!!R.instantiate;function B(){var Re=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:v.width,containerHeight:v.height,position:{mx:.36,my:.44}}),pe={strokeWidth:2,fill:ve(v,"none"),stroke:V(v,c)};_(S,Re,pe)}if(F==="Parallel"){var G=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:v.width,containerHeight:v.height,position:{mx:.474,my:.296}}),re=_(S,G);H(re,{strokeWidth:1,fill:"none"})}else if(F==="Exclusive"){if(!k){var oe=D(S,v.width,v.height,v.height*.26);H(oe,{strokeWidth:1,fill:"none",stroke:V(v,c)})}B()}return O},"bpmn:Gateway":function(S,v){var R={fill:ve(v,s),fillOpacity:Oi,stroke:V(v,c)};return w(S,v.width,v.height,R)},"bpmn:SequenceFlow":function(S,v){var R=ge(v),O=ve(v,s),F=V(v,c),k={strokeLinejoin:"round",markerEnd:y("sequenceflow-end",O,F),stroke:V(v,c)},B=_(S,R,k),G=st(v),re;return v.source&&(re=v.source.businessObject,G.conditionExpression&&re.$instanceOf("bpmn:Activity")&&H(B,{markerStart:y("conditional-flow-marker",O,F)}),re.default&&(re.$instanceOf("bpmn:Gateway")||re.$instanceOf("bpmn:Activity"))&&re.default===G&&H(B,{markerStart:y("conditional-default-flow-marker",O,F)})),B},"bpmn:Association":function(S,v,R){var O=st(v),F=ve(v,s),k=V(v,c);return R=I({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:V(v,c)},R||{}),(O.associationDirection==="One"||O.associationDirection==="Both")&&(R.markerEnd=y("association-end",F,k)),O.associationDirection==="Both"&&(R.markerStart=y("association-start",F,k)),b(S,v.waypoints,R)},"bpmn:DataInputAssociation":function(S,v){var R=ve(v,s),O=V(v,c);return P("bpmn:Association")(S,v,{markerEnd:y("association-end",R,O)})},"bpmn:DataOutputAssociation":function(S,v){var R=ve(v,s),O=V(v,c);return P("bpmn:Association")(S,v,{markerEnd:y("association-end",R,O)})},"bpmn:MessageFlow":function(S,v){var R=st(v),O=Ni(v),F=ve(v,s),k=V(v,c),B=ge(v),G={markerEnd:y("messageflow-end",F,k),markerStart:y("messageflow-start",F,k),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:V(v,c)},re=_(S,B,G);if(R.messageRef){var oe=re.getPointAtLength(re.getTotalLength()/2),Re=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:oe.x,y:oe.y}}),pe={strokeWidth:1};O.messageVisibleKind==="initiating"?(pe.fill="white",pe.stroke="black"):(pe.fill="#888",pe.stroke="white");var de=_(S,Re,pe),Ve=R.messageRef.name,We=z(S,Ve,{align:"center-top",fitBox:!0,style:{fill:V(v,u)}}),we=de.getBBox(),Pe=We.getBBox(),ct=oe.x-Pe.width/2,ut=oe.y+we.height/2+zb;zs(We,ct,ut,0)}return re},"bpmn:DataObject":function(S,v){var R=i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.474,my:.296}}),O=_(S,R,{fill:ve(v,s),fillOpacity:Oi,stroke:V(v,c)}),F=st(v);return kb(F)&&le(S,v),O},"bpmn:DataObjectReference":N("bpmn:DataObject"),"bpmn:DataInput":function(S,v){var R=i.getRawPath("DATA_ARROW"),O=P("bpmn:DataObject")(S,v);return _(S,R,{strokeWidth:1}),O},"bpmn:DataOutput":function(S,v){var R=i.getRawPath("DATA_ARROW"),O=P("bpmn:DataObject")(S,v);return _(S,R,{strokeWidth:1,fill:"black"}),O},"bpmn:DataStoreReference":function(S,v){var R=i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:0,my:.133}}),O=_(S,R,{strokeWidth:2,fill:ve(v,s),fillOpacity:Oi,stroke:V(v,c)});return O},"bpmn:BoundaryEvent":function(S,v){var R=st(v),O=R.cancelActivity,F={strokeWidth:1,fill:ve(v,s),stroke:V(v,c)};O||(F.strokeDasharray="6",F.strokeLinecap="round");var k=I({},F,{fillOpacity:1}),B=I({},F,{fill:"none"}),G=P("bpmn:Event")(S,v,k);return D(S,v.width,v.height,Js,B),$(v,S),G},"bpmn:Group":function(S,v){var R=A(S,v.width,v.height,ka,{stroke:V(v,c),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"});return R},label:function(S,v){return W(S,v)},"bpmn:TextAnnotation":function(S,v){var R={fill:"none",stroke:"none"},O=A(S,v.width,v.height,0,0,R),F=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:0,my:0}});_(S,F,{stroke:V(v,c)});var k=st(v).text||"";return z(S,k,{box:v,align:"left-top",padding:5,style:{fill:vr(v,u,c)}}),O},ParticipantMultiplicityMarker:function(S,v){var R=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:v.width/2/v.width,my:(v.height-15)/v.height}});M("participant-multiplicity",S,R,{strokeWidth:2,fill:ve(v,s),stroke:V(v,c)})},SubProcessMarker:function(S,v){var R=A(S,14,14,0,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c)});vt(R,v.width/2-7.5,v.height-20);var O=i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:v.width,containerHeight:v.height,position:{mx:(v.width/2-7.5)/v.width,my:(v.height-20)/v.height}});M("sub-process",S,O,{fill:ve(v,s),stroke:V(v,c)})},ParallelMarker:function(S,v,R){var O=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:(v.width/2+R.parallel)/v.width,my:(v.height-20)/v.height}});M("parallel",S,O,{fill:ve(v,s),stroke:V(v,c)})},SequentialMarker:function(S,v,R){var O=i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:(v.width/2+R.seq)/v.width,my:(v.height-19)/v.height}});M("sequential",S,O,{fill:ve(v,s),stroke:V(v,c)})},CompensationMarker:function(S,v,R){var O=i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:(v.width/2+R.compensation)/v.width,my:(v.height-13)/v.height}});M("compensation",S,O,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c)})},LoopMarker:function(S,v,R){var O=i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:(v.width/2+R.loop)/v.width,my:(v.height-7)/v.height}});M("loop",S,O,{strokeWidth:1,fill:ve(v,s),stroke:V(v,c),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(S,v,R){var O=i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:(v.width/2+R.adhoc)/v.width,my:(v.height-15)/v.height}});M("adhoc",S,O,{strokeWidth:1,fill:V(v,c),stroke:V(v,c)})}};function be(S,v,R){var O=st(v),F=R&&R.indexOf("SubProcessMarker")!==-1,k;F?k={seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:k={seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},C(R,function(re){P(re)(S,v,k)}),O.isForCompensation&&P("CompensationMarker")(S,v,k),O.$type==="bpmn:AdHocSubProcess"&&P("AdhocMarker")(S,v,k);var B=O.loopCharacteristics,G=B&&B.isSequential;B&&(G===void 0&&P("LoopMarker")(S,v,k),G===!1&&P("ParallelMarker")(S,v,k),G===!0&&P("SequentialMarker")(S,v,k))}function le(S,v){var R=(v.height-18)/v.height,O=i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:v.width,containerHeight:v.height,position:{mx:.33,my:R}});_(S,O,{strokeWidth:2})}this._drawPath=_}Z(ri,dn);ri.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"];ri.prototype.canRender=function(e){return m(e,"bpmn:BaseElement")};ri.prototype.drawShape=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};ri.prototype.drawConnection=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};ri.prototype.getShapePath=function(e){return m(e,"bpmn:Event")?Lb(e):m(e,"bpmn:Activity")?Bb(e,ka):m(e,"bpmn:Gateway")?$b(e):Fb(e)};var Gb=0,Vb={width:150,height:50};function Wb(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}function Ub(e){return Ze(e)?I({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}function Yb(e,t){t.textContent=e;var n;try{var i,r=e==="";return t.textContent=r?"dummy":e,n=t.getBBox(),i={width:n.width+n.x*2,height:n.height},r&&(i.width=0),i}catch(a){return{width:0,height:0}}}function qb(e,t,n){for(var i=e.shift(),r=i,a;;){if(a=Yb(r,n),a.width=r?a.width:0,r===" "||r===""||a.width<Math.round(t)||r.length<2)return Kb(e,r,i,a);r=Zb(r,a.width,t)}}function Kb(e,t,n,i){if(t.length<n.length){var r=n.slice(t.length).trim();e.unshift(r)}return{width:i.width,height:i.height,text:t}}var qp="\xAD";function Xb(e,t){var n=e.split(/(\s|-|\u00AD)/g),i,r=[],a=0;if(n.length>1)for(;i=n.shift();)if(i.length+a<t)r.push(i),a+=i.length;else{(i==="-"||i===qp)&&r.pop();break}var o=r[r.length-1];return o&&o===qp&&(r[r.length-1]="-"),r.join("")}function Zb(e,t,n){var i=Math.max(e.length*(n/t),1),r=Xb(e,i);return r||(r=e.slice(0,Math.max(Math.round(i-1),1))),r}function Qb(){var e=document.getElementById("helper-svg");return e||(e=Q("svg"),H(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}function La(e){this._config=I({},{size:Vb,padding:Gb,style:{},align:"center-top"},e||{})}La.prototype.createText=function(e,t){return this.layoutText(e,t).element};La.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions};La.prototype.layoutText=function(e,t){var n=I({},this._config.size,t.box),i=I({},this._config.style,t.style),r=Wb(t.align||this._config.align),a=Ub(t.padding!==void 0?t.padding:this._config.padding),o=t.fitBox||!1,s=Jb(i),c=e.split(/\u00AD?\r?\n/),u=[],l=n.width-a.left-a.right,p=Q("text");H(p,{x:0,y:0}),H(p,i);var h=Qb();for(ne(h,p);c.length;)u.push(qb(c,l,p));r.vertical==="middle"&&(a.top=a.bottom=0);var f=bt(u,function(A,w,b){return A+(s||w.height)},0)+a.top+a.bottom,d=bt(u,function(A,w,b){return w.width>A?w.width:A},0),y=a.top;r.vertical==="middle"&&(y+=(n.height-f)/2),y-=(s||u[0].height)/4;var x=Q("text");H(x,i),C(u,function(A){var w;switch(y+=s||A.height,r.horizontal){case"left":w=a.left;break;case"right":w=(o?d:l)-a.right-A.width;break;default:w=Math.max(((o?d:l)-A.width)/2+a.left,0)}var b=Q("tspan");H(b,{x:w,y}),b.textContent=A.text,ne(x,b)}),Be(p);var D={width:d,height:f};return{dimensions:D,element:x}};function Jb(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}var ex=12,tx=1.2,nx=30;function Kp(e){var t=I({fontFamily:"Arial, sans-serif",fontSize:ex,fontWeight:"normal",lineHeight:tx},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=I({},t,{fontSize:n},e&&e.externalStyle||{}),r=new La({style:t});this.getExternalLabelBounds=function(a,o){var s=r.getDimensions(o,{box:{width:90,height:30,x:a.width/2+a.x,y:a.height/2+a.y},style:i});return{x:Math.round(a.x+a.width/2-s.width/2),y:Math.round(a.y),width:Math.ceil(s.width),height:Math.ceil(s.height)}},this.getTextAnnotationBounds=function(a,o){var s=r.getDimensions(o,{box:a,style:t,align:"left-top",padding:5});return{x:a.x,y:a.y,width:a.width,height:Math.max(nx,Math.round(s.height))}},this.createText=function(a,o){return r.createText(a,o||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}Kp.$inject=["config.textRenderer"];function ix(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(t){return this.pathMap[t].d},this.getScaledPath=function(t,n){var i=this.pathMap[t],r,a;n.abspos?(r=n.abspos.x,a=n.abspos.y):(r=n.containerWidth*n.position.mx,a=n.containerHeight*n.position.my);var o={};if(n.position){for(var s=n.containerHeight/i.height*n.yScaleFactor,c=n.containerWidth/i.width*n.xScaleFactor,u=0;u<i.heightElements.length;u++)o["y"+u]=i.heightElements[u]*s;for(var l=0;l<i.widthElements.length;l++)o["x"+l]=i.widthElements[l]*c}var p=sx(i.d,{mx:r,my:a,e:o});return p}}var rx=/\{([^{}]+)\}/g,ax=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;function ox(e,t,n){var i=n;return t.replace(ax,function(r,a,o,s,c){a=a||s,i&&(a in i&&(i=i[a]),typeof i=="function"&&c&&(i=i()))}),i=(i==null||i==n?e:i)+"",i}function sx(e,t){return String(e).replace(rx,function(n,i){return ox(n,i,t)})}var cx={__init__:["bpmnRenderer"],bpmnRenderer:["type",ri],textRenderer:["type",Kp],pathMap:["type",ix]};function ux(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})}var Ba={translate:["value",ux]},mr={width:90,height:20},Xp=15;function Ii(e){return m(e,"bpmn:Event")||m(e,"bpmn:Gateway")||m(e,"bpmn:DataStoreReference")||m(e,"bpmn:DataObjectReference")||m(e,"bpmn:DataInput")||m(e,"bpmn:DataOutput")||m(e,"bpmn:SequenceFlow")||m(e,"bpmn:MessageFlow")||m(e,"bpmn:Group")}function $a(e){return tt(e.label)}function lx(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)],r=px(e),a=Math.atan((i.y-n.y)/(i.x-n.x)),o=r.x,s=r.y;return Math.abs(a)<Math.PI/2?s-=Xp:o+=Xp,{x:o,y:s}}function px(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}function Fa(e){return e.waypoints?lx(e.waypoints):m(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+mr.height/2}:{x:e.x+e.width/2,y:e.y+e.height+mr.height/2}}function fx(e,t){var n,i,r,a=e.di,o=a.label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(mr.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=Fa(t),i=mr),I({x:n.x-i.width/2,y:n.y-i.height/2},i)}function tt(e){return e&&!!e.labelTarget}function ja(e,t){return I({id:e.id,type:e.$type,businessObject:e},t)}function hx(e,t,n){var i=e.di.waypoint;return!i||i.length<2?[ce(t),ce(n)]:i.map(function(r){return{x:r.x,y:r.y}})}function Zp(e,t,n,i){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:et(n),referenced:et(t),property:i}))}function yn(e,t,n,i,r,a){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._translate=r,this._textRenderer=a}yn.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"];yn.prototype.add=function(e,t){var n=e.di,i,r=this._translate,a,o;if(m(n,"bpmndi:BPMNPlane"))i=this._elementFactory.createRoot(ja(e)),this._canvas.setRootElement(i);else if(m(n,"bpmndi:BPMNShape")){var s=!Se(e),c=vx(e);a=t&&(t.hidden||t.collapsed);var u=e.di.bounds;i=this._elementFactory.createShape(ja(e,{collapsed:s,hidden:a,x:Math.round(u.x),y:Math.round(u.y),width:Math.round(u.width),height:Math.round(u.height),isFrame:c})),m(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),m(e,"bpmn:Lane")&&(o=0),m(e,"bpmn:DataStoreReference")&&(dx(t,ce(u))||(t=this._canvas.getRootElement())),this._canvas.addShape(i,t,o)}else if(m(n,"bpmndi:BPMNEdge")){var l=this._getSource(e),p=this._getTarget(e);a=t&&(t.hidden||t.collapsed),i=this._elementFactory.createConnection(ja(e,{hidden:a,source:l,target:p,waypoints:hx(e,l,p)})),m(e,"bpmn:DataAssociation")&&(t=null),m(e,"bpmn:SequenceFlow")&&(o=0),this._canvas.addConnection(i,t,o)}else throw new Error(r("unknown di {di} for element {semantic}",{di:et(n),semantic:et(e)}));return Ii(e)&&Gt(i)&&this.addLabel(e,i),this._eventBus.fire("bpmnElement.added",{element:i}),i};yn.prototype._attachBoundary=function(e,t){var n=this._translate,i=e.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:et(e)}));var r=this._elementRegistry.get(i.id),a=r&&r.attachers;if(!r)throw Zp(n,e,i,"attachedToRef");t.host=r,a||(r.attachers=a=[]),a.indexOf(t)===-1&&a.push(t)};yn.prototype.addLabel=function(e,t){var n,i,r;return n=fx(e,t),i=Gt(t),i&&(n=this._textRenderer.getExternalLabelBounds(n,i)),r=this._elementFactory.createLabel(ja(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden||!Gt(t),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(r,t.parent)};yn.prototype._getEnd=function(e,t){var n,i,r=e.$type,a=this._translate;if(i=e[t+"Ref"],t==="source"&&r==="bpmn:DataInputAssociation"&&(i=i&&i[0]),(t==="source"&&r==="bpmn:DataOutputAssociation"||t==="target"&&r==="bpmn:DataInputAssociation")&&(i=e.$parent),n=i&&this._getElement(i),n)return n;throw i?Zp(a,e,i,t+"Ref"):new Error(a("{semantic}#{side} Ref not specified",{semantic:et(e),side:t}))};yn.prototype._getSource=function(e){return this._getEnd(e,"source")};yn.prototype._getTarget=function(e){return this._getEnd(e,"target")};yn.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};function dx(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function vx(e){return m(e,"bpmn:Group")}var mx={__depends__:[Ba],bpmnImporter:["type",yn]},gx={__depends__:[cx,mx]};function Qp(e){!e||typeof e.stopPropagation!="function"||e.stopPropagation()}function ki(e){return e.originalEvent||e.srcEvent}function ec(e,t){Qp(e),Qp(ki(e))}function Fn(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function yx(){return/mac/i.test(navigator.platform)}function Jp(e,t){return(ki(e)||e).button===t}function jn(e){return Jp(e,0)}function Ex(e){return Jp(e,1)}function Li(e){var t=ki(e)||e;return jn(e)?yx()?t.metaKey:t.ctrlKey:!1}function ef(e){var t=ki(e)||e;return jn(e)&&t.shiftKey}function bx(e){return!0}function Ha(e){return jn(e)||Ex(e)}var tf=500;function nf(e,t,n){var i=this;function r(N,P,$){if(!s(N,P)){var z,Y,W;$?Y=t.getGraphics($):(z=P.delegateTarget||P.target,z&&(Y=z,$=t.get(Y))),!(!Y||!$)&&(W=e.fire(N,{element:$,gfx:Y,originalEvent:P}),W===!1&&(P.stopPropagation(),P.preventDefault()))}}var a={};function o(N){return a[N]}function s(N,P){var $=u[N]||jn;return!$(P)}var c={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},u={"element.contextmenu":bx,"element.mousedown":Ha,"element.mouseup":Ha,"element.click":Ha,"element.dblclick":Ha};function l(N,P,$){var z=c[N];if(!z)throw new Error("unmapped DOM event name <"+N+">");return r(z,P,$)}var p="svg, .djs-element";function h(N,P,$,z){var Y=a[$]=function(W){r($,W)};z&&(u[$]=z),Y.$delegate=_t.bind(N,p,P,Y)}function f(N,P,$){var z=o($);!z||_t.unbind(N,P,z.$delegate)}function d(N){C(c,function(P,$){h(N,$,P)})}function y(N){C(c,function(P,$){f(N,$,P)})}e.on("canvas.destroy",function(N){y(N.svg)}),e.on("canvas.init",function(N){d(N.svg)}),e.on(["shape.added","connection.added"],function(N){var P=N.element,$=N.gfx;e.fire("interactionEvents.createHit",{element:P,gfx:$})}),e.on(["shape.changed","connection.changed"],tf,function(N){var P=N.element,$=N.gfx;e.fire("interactionEvents.updateHit",{element:P,gfx:$})}),e.on("interactionEvents.createHit",tf,function(N){var P=N.element,$=N.gfx;i.createDefaultHit(P,$)}),e.on("interactionEvents.updateHit",function(N){var P=N.element,$=N.gfx;i.updateDefaultHit(P,$)});var x=b("djs-hit djs-hit-stroke"),D=b("djs-hit djs-hit-click-stroke"),A=b("djs-hit djs-hit-all"),w={all:A,"click-stroke":D,stroke:x};function b(N,P){return P=I({stroke:"white",strokeWidth:15},P||{}),n.cls(N,["no-fill","no-border"],P)}function _(N,P){var $=w[P];if(!$)throw new Error("invalid hit type <"+P+">");return H(N,$),N}function M(N,P){ne(N,P)}this.removeHits=function(N){var P=xs(".djs-hit",N);C(P,Be)},this.createDefaultHit=function(N,P){var $=N.waypoints,z=N.isFrame,Y;return $?this.createWaypointsHit(P,$):(Y=z?"stroke":"all",this.createBoxHit(P,Y,{width:N.width,height:N.height}))},this.createWaypointsHit=function(N,P){var $=Ns(P);return _($,"stroke"),M(N,$),$},this.createBoxHit=function(N,P,$){$=I({x:0,y:0},$);var z=Q("rect");return _(z,P),H(z,$),M(N,z),z},this.updateDefaultHit=function(N,P){var $=Oe(".djs-hit",P);if(!!$)return N.waypoints?ny($,N.waypoints):H($,{width:N.width,height:N.height}),$},this.fire=r,this.triggerMouseEvent=l,this.mouseHandler=o,this.registerEvent=h,this.unregisterEvent=f}nf.$inject=["eventBus","elementRegistry","styles"];var gr={__init__:["interactionEvents"],interactionEvents:["type",nf]},xx=500;function za(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function a(o,s){var c=Q("rect");return H(c,I({x:10,y:10,width:100,height:100},i)),ne(o,c),c}e.on(["shape.added","shape.changed"],xx,function(o){var s=o.element,c=o.gfx,u=Oe(".djs-outline",c);u||(u=a(c)),r.updateShapeOutline(u,s)}),e.on(["connection.added","connection.changed"],function(o){var s=o.element,c=o.gfx,u=Oe(".djs-outline",c);u||(u=a(c)),r.updateConnectionOutline(u,s)})}za.prototype.updateShapeOutline=function(e,t){H(e,{x:-this.offset,y:-this.offset,width:t.width+this.offset*2,height:t.height+this.offset*2})};za.prototype.updateConnectionOutline=function(e,t){var n=Qe(t);H(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+this.offset*2,height:n.height+this.offset*2})};za.$inject=["eventBus","styles","elementRegistry"];var rf={__init__:["outline"],outline:["type",za]};function Bi(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(i){var r=i.element;n.deselect(r)}),e.on(["diagram.clear","plane.set"],function(i){n.select(null)})}Bi.$inject=["eventBus","canvas"];Bi.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(n!==-1){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}};Bi.prototype.get=function(){return this._selectedElements};Bi.prototype.isSelected=function(e){return this._selectedElements.indexOf(e)!==-1};Bi.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();fe(e)||(e=e?[e]:[]);var r=this._canvas;e=e.filter(function(a){var o=r.findPlane(a);return o===r.getActivePlane()}),t?C(e,function(a){n.indexOf(a)===-1&&n.push(a)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var af="hover",of="selected";function sf(e,t,n,i){this._multiSelectionBox=null;function r(o,s){t.addMarker(o,s)}function a(o,s){t.removeMarker(o,s)}e.on("element.hover",function(o){r(o.element,af)}),e.on("element.out",function(o){a(o.element,af)}),e.on("selection.changed",function(o){function s(p){a(p,of)}function c(p){r(p,of)}var u=o.oldSelection,l=o.newSelection;C(u,function(p){l.indexOf(p)===-1&&s(p)}),C(l,function(p){u.indexOf(p)===-1&&c(p)})})}sf.$inject=["eventBus","canvas","selection","styles"];function cf(e,t,n,i){e.on("create.end",500,function(r){var a=r.context,o=a.canExecute,s=a.elements,c=a.hints||{},u=c.autoSelect;if(o){if(u===!1)return;fe(u)?t.select(u):t.select(s.filter(_x))}}),e.on("connect.end",500,function(r){var a=r.context,o=a.canExecute,s=a.hover;o&&s&&t.select(s)}),e.on("shape.move.end",500,function(r){var a=r.previousSelection||[],o=i.get(r.context.shape.id),s=_e(a,function(c){return o.id===c.id});s||t.select(o)}),e.on("element.click",function(r){if(!!jn(r)){var a=r.element;a===n.getRootElement()&&(a=null);var o=t.isSelected(a),s=t.get().length>1,c=Li(r)||ef(r);if(o&&s)return c?t.deselect(a):t.select(a);o?t.deselect(a):t.select(a,c)}})}cf.$inject=["eventBus","selection","canvas","elementRegistry"];function _x(e){return!e.hidden}var nn={__init__:["selectionVisuals","selectionBehavior"],__depends__:[gr,rf],selection:["type",Bi],selectionVisuals:["type",sf],selectionBehavior:["type",cf]};function tc(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(Math.random()*1e9)+"-"}tc.prototype.next=function(){return this._prefix+ ++this._counter};var wx=new tc("ov"),Sx=500;function qe(e,t,n,i){this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=wx,this._overlayDefaults=I({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=Tx(n.getContainer()),this._init()}qe.$inject=["config.overlays","eventBus","canvas","elementRegistry"];qe.prototype.get=function(e){if(Pt(e)&&(e={id:e}),Pt(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?se(t.overlays,Ht({type:e.type})):t.overlays.slice():[]}else return e.type?se(this._overlays,Ht({type:e.type})):e.id?this._overlays[e.id]:null};qe.prototype.add=function(e,t,n){if(Ze(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=I({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i};qe.prototype.remove=function(e){var t=this.get(e)||[];fe(t)||(t=[t]);var n=this;C(t,function(i){var r=n._getOverlayContainer(i.element,!0);if(i&&(Qt(i.html),Qt(i.htmlContainer),delete i.htmlContainer,delete i.element,delete n._overlays[i.id]),r){var a=r.overlays.indexOf(i);a!==-1&&r.overlays.splice(a,1)}})};qe.prototype.show=function(){yr(this._overlayRoot)};qe.prototype.hide=function(){yr(this._overlayRoot,!1)};qe.prototype.clear=function(){this._overlays={},this._overlayContainers=[],fa(this._overlayRoot)};qe.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,r=t.y;if(t.waypoints){var a=Qe(t);i=a.x,r=a.y}uf(n,i,r),xt(e.html,"data-container-id",t.id)};qe.prototype._updateOverlay=function(e){var t=e.position,n=e.htmlContainer,i=e.element,r=t.left,a=t.top;if(t.right!==void 0){var o;i.waypoints?o=Qe(i).width:o=i.width,r=t.right*-1+o}if(t.bottom!==void 0){var s;i.waypoints?s=Qe(i).height:s=i.height,a=t.bottom*-1+s}uf(n,r||0,a||0)};qe.prototype._createOverlayContainer=function(e){var t=Ce('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n};qe.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";lf(this._overlayRoot,n)};qe.prototype._getOverlayContainer=function(e,t){var n=_e(this._overlayContainers,function(i){return i.element===e});return!n&&!t?this._createOverlayContainer(e):n};qe.prototype._addOverlay=function(e){var t=e.id,n=e.element,i=e.html,r,a;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),Pt(i)&&(i=Ce(i)),a=this._getOverlayContainer(n),r=Ce('<div class="djs-overlay" data-overlay-id="'+t+'" style="position: absolute">'),r.appendChild(i),e.type&&je(r).add("djs-overlay-"+e.type);var o=this._canvas.findPlane(n),s=this._canvas.getActivePlane();e.plane=o,o!==s&&yr(r,!1),e.htmlContainer=r,a.overlays.push(e),a.html.appendChild(r),this._overlays[t]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())};qe.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=e.plane,r=n&&n.minZoom,a=n&&n.maxZoom,o=e.htmlContainer,s=this._canvas.getActivePlane(),c=!0;(i!==s||n&&(Zt(r)&&r>t.scale||Zt(a)&&a<t.scale))&&(c=!1),yr(o,c),this._updateOverlayScale(e,t)};qe.prototype._updateOverlayScale=function(e,t){var n=e.scale,i,r,a=e.htmlContainer,o,s="";n!==!0&&(n===!1?(i=1,r=1):(i=n.min,r=n.max),Zt(i)&&t.scale<i&&(o=(1/t.scale||1)*i),Zt(r)&&t.scale>r&&(o=(1/t.scale||1)*r)),Zt(o)&&(s="scale("+o+","+o+")"),lf(a,s)};qe.prototype._updateOverlaysVisibilty=function(e){var t=this;C(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})};qe.prototype._init=function(){var e=this._eventBus,t=this;function n(i){t._updateRoot(i),t._updateOverlaysVisibilty(i),t.show()}e.on("canvas.viewbox.changing",function(i){t.hide()}),e.on("canvas.viewbox.changed",function(i){n(i.viewbox)}),e.on(["shape.remove","connection.remove"],function(i){var r=i.element,a=t.get({element:r});C(a,function(c){t.remove(c.id)});var o=t._getOverlayContainer(r);if(o){Qt(o.html);var s=t._overlayContainers.indexOf(o);s!==-1&&t._overlayContainers.splice(s,1)}}),e.on("element.changed",Sx,function(i){var r=i.element,a=t._getOverlayContainer(r,!0);a&&(C(a.overlays,function(o){t._updateOverlay(o)}),t._updateOverlayContainer(a))}),e.on("element.marker.update",function(i){var r=t._getOverlayContainer(i.element,!0);r&&je(r.html)[i.add?"add":"remove"](i.marker)}),e.on("plane.set",function(i){C(t._overlays,function(r){yr(r.htmlContainer,r.plane===i.plane)})}),e.on("diagram.clear",this.clear,this)};function Tx(e){var t=Ce('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function uf(e,t,n){I(e.style,{left:t+"px",top:n+"px"})}function yr(e,t){e.style.display=t===!1?"none":""}function lf(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}var nc={__init__:["overlays"],overlays:["type",qe]};function Hn(e){Me.call(this,e)}Z(Hn,Me);Hn.prototype._modules=[gx,Ba,nn,nc];Hn.prototype._moddleExtensions={};function Rx(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function Rt(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function Vt(e,t){return e=fe(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.keyCode)!==-1}function ic(e){return e.shiftKey}var Ga="keyboard.keydown",Cx="keyboard.keyup",pf="input-handle-modified-keys",Px=1e3;function Ke(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}Ke.$inject=["config.keyboard","eventBus"];Ke.prototype._keydownHandler=function(e){this._keyHandler(e,Ga)};Ke.prototype._keyupHandler=function(e){this._keyHandler(e,Cx)};Ke.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||Ga,i),n&&e.preventDefault()}};Ke.prototype._isEventIgnored=function(e){return Ax(e.target)&&this._isModifiedKeyIgnored(e)};Ke.prototype._isModifiedKeyIgnored=function(e){if(!Rt(e))return!0;var t=this._getAllowedModifiers(e.target);return!t.includes(e.key)};Ke.prototype._getAllowedModifiers=function(e){var t=ei(e,"["+pf+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(pf).split(",")};Ke.prototype.bind=function(e){this.unbind(),this._node=e,te.bind(e,"keydown",this._keydownHandler,!0),te.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")};Ke.prototype.getBinding=function(){return this._node};Ke.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),te.unbind(e,"keydown",this._keydownHandler,!0),te.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null};Ke.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};Ke.prototype.addListener=function(e,t,n){at(e)&&(n=t,t=e,e=Px),this._eventBus.on(n||Ga,e,t)};Ke.prototype.removeListener=function(e,t){this._eventBus.off(t||Ga,e)};Ke.prototype.hasModifier=Rx;Ke.prototype.isCmd=Rt;Ke.prototype.isShift=ic;Ke.prototype.isKey=Vt;function Ax(e){return e&&(ha(e,"input, textarea")||e.contentEditable==="true")}var Mx=500,Dx=67,Nx=86,Ox=89,Ix=90,kx=["c","C",Dx],Lx=["v","V",Nx],Bx=["y","Y",Ox],ff=["z","Z",Ix];function $i(e,t){var n=this;e.on("editorActions.init",Mx,function(i){var r=i.editorActions;n.registerBindings(t,r)})}$i.$inject=["eventBus","keyboard"];$i.prototype.registerBindings=function(e,t){function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("undo",function(i){var r=i.keyEvent;if(Rt(r)&&!ic(r)&&Vt(ff,r))return t.trigger("undo"),!0}),n("redo",function(i){var r=i.keyEvent;if(Rt(r)&&(Vt(Bx,r)||Vt(ff,r)&&ic(r)))return t.trigger("redo"),!0}),n("copy",function(i){var r=i.keyEvent;if(Rt(r)&&Vt(kx,r))return t.trigger("copy"),!0}),n("paste",function(i){var r=i.keyEvent;if(Rt(r)&&Vt(Lx,r))return t.trigger("paste"),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(Vt(["+","Add","="],r)&&Rt(r))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(Vt(["-","Subtract"],r)&&Rt(r))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var r=i.keyEvent;if(Vt("0",r)&&Rt(r))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var r=i.keyEvent;if(Vt(["Backspace","Delete","Del"],r))return t.trigger("removeSelection"),!0})};var rc={__init__:["keyboard","keyboardBindings"],keyboard:["type",Ke],keyboardBindings:["type",$i]},$x={moveSpeed:50,moveSpeedAccelerated:200};function hf(e,t,n){var i=this;this._config=I({},$x,e||{}),t.addListener(r);function r(a){var o=a.keyEvent,s=i._config;if(!!t.isCmd(o)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],o)){var c=t.isShift(o)?s.moveSpeedAccelerated:s.moveSpeed,u;switch(o.key){case"ArrowLeft":case"Left":u="left";break;case"ArrowUp":case"Up":u="up";break;case"ArrowRight":case"Right":u="right";break;case"ArrowDown":case"Down":u="down";break}return i.moveCanvas({speed:c,direction:u}),!0}}this.moveCanvas=function(a){var o=0,s=0,c=a.speed,u=c/Math.min(Math.sqrt(n.viewbox().scale),1);switch(a.direction){case"left":o=u;break;case"up":s=u;break;case"right":o=-u;break;case"down":s=-u;break}n.scroll({dx:o,dy:s})}}hf.$inject=["config.keyboardMove","keyboard","canvas"];var df={__depends__:[rc],__init__:["keyboardMove"],keyboardMove:["type",hf]},Fx=/^djs-cursor-.*$/;function Va(e){var t=je(document.body);t.removeMatching(Fx),e&&t.add("djs-cursor-"+e)}function vf(){Va(null)}var jx=5e3;function mf(e,t){t=t||"element.click";function n(){return!1}return e.once(t,jx,n),function(){e.off(t,n)}}function Er(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function rn(e,t){return{x:e.x-t.x,y:e.y-t.y}}var Hx=15;function gf(e,t){var n;e.on("element.mousedown",500,function(o){return a(o.originalEvent)});function i(o){var s=n.start,c=n.button,u=Fn(o),l=rn(u,s);if(!n.dragging&&zx(l)>Hx&&(n.dragging=!0,c===0&&mf(e),Va("grab")),n.dragging){var p=n.last||n.start;l=rn(u,p),t.scroll({dx:l.x,dy:l.y}),n.last=u}o.preventDefault()}function r(o){te.unbind(document,"mousemove",i),te.unbind(document,"mouseup",r),n=null,vf()}function a(o){if(!ei(o.target,".djs-draggable")){var s=o.button;if(!(s>=2||o.ctrlKey||o.shiftKey||o.altKey))return n={button:s,start:Fn(o)},te.bind(document,"mousemove",i),te.bind(document,"mouseup",r),!0}}this.isActive=function(){return!!n}}gf.$inject=["eventBus","canvas"];function zx(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}var yf={__init__:["moveCanvas"],moveCanvas:["type",gf]};function ac(e){return Math.log(e)/Math.log(10)}function Ef(e,t){var n=ac(e.min),i=ac(e.max),r=Math.abs(n)+Math.abs(i);return r/t}function Gx(e,t){return Math.max(e.min,Math.min(e.max,t))}var Vx=Math.sign||function(e){return e>=0?1:-1},oc={min:.2,max:4},bf=10,Wx=.1,Ux=.75;function an(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=pt(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||Ux;var i=this;t.on("canvas.init",function(r){i._init(e.enabled!==!1)})}an.$inject=["config.zoomScroll","eventBus","canvas"];an.prototype.scroll=function(t){this._canvas.scroll(t)};an.prototype.reset=function(){this._canvas.zoom("fit-viewport")};an.prototype.zoom=function(t,n){var i=Ef(oc,bf*2);this._totalDelta+=t,Math.abs(this._totalDelta)>Wx&&(this._zoom(t,n,i),this._totalDelta=0)};an.prototype._handleWheel=function(t){if(!ei(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey,r=t.shiftKey,a=-1*this._scale,o;if(i?a*=t.deltaMode===0?.02:.32:a*=t.deltaMode===0?1:16,i){var s=n.getBoundingClientRect(),c={x:t.clientX-s.left,y:t.clientY-s.top};o=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*Vx(t.deltaY)*a,this.zoom(o,c)}else r?o={dx:a*t.deltaY,dy:0}:o={dx:a*t.deltaX,dy:a*t.deltaY},this.scroll(o)}};an.prototype.stepZoom=function(t,n){var i=Ef(oc,bf);this._zoom(t,n,i)};an.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,a=ac(i.zoom()),o=Math.round(a/n)*n;o+=n*r;var s=Math.pow(10,o);i.zoom(Gx(oc,s),t)};an.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,r=this._enabled;return typeof t=="undefined"&&(t=!r),r!==t&&te[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};an.prototype._init=function(e){this.toggle(e)};var xf={__init__:["zoomScroll"],zoomScroll:["type",an]};function br(e){Hn.call(this,e)}Z(br,Hn);br.prototype._navigationModules=[df,yf,xf];br.prototype._modules=[].concat(Hn.prototype._modules,br.prototype._navigationModules);var _f={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,n,i,r){var a=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),s="function",c=Math.round,u=Math.abs,l=Date.now;function p(g,E,T){return setTimeout(w(g,T),E)}function h(g,E,T){return Array.isArray(g)?(f(g,T[E],T),!0):!1}function f(g,E,T){var L;if(!!g)if(g.forEach)g.forEach(E,T);else if(g.length!==r)for(L=0;L<g.length;)E.call(T,g[L],L,g),L++;else for(L in g)g.hasOwnProperty(L)&&E.call(T,g[L],L,g)}function d(g,E,T){var L="DEPRECATED METHOD: "+E+`
`+T+` AT 
`;return function(){var j=new Error("get-stack-trace"),q=j&&j.stack?j.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",me=t.console&&(t.console.warn||t.console.log);return me&&me.call(t.console,L,q),g.apply(this,arguments)}}var y;typeof Object.assign!="function"?y=function(E){if(E===r||E===null)throw new TypeError("Cannot convert undefined or null to object");for(var T=Object(E),L=1;L<arguments.length;L++){var j=arguments[L];if(j!==r&&j!==null)for(var q in j)j.hasOwnProperty(q)&&(T[q]=j[q])}return T}:y=Object.assign;var x=d(function(E,T,L){for(var j=Object.keys(T),q=0;q<j.length;)(!L||L&&E[j[q]]===r)&&(E[j[q]]=T[j[q]]),q++;return E},"extend","Use `assign`."),D=d(function(E,T){return x(E,T,!0)},"merge","Use `assign`.");function A(g,E,T){var L=E.prototype,j;j=g.prototype=Object.create(L),j.constructor=g,j._super=L,T&&y(j,T)}function w(g,E){return function(){return g.apply(E,arguments)}}function b(g,E){return typeof g==s?g.apply(E&&E[0]||r,E):g}function _(g,E){return g===r?E:g}function M(g,E,T){f(z(E),function(L){g.addEventListener(L,T,!1)})}function N(g,E,T){f(z(E),function(L){g.removeEventListener(L,T,!1)})}function P(g,E){for(;g;){if(g==E)return!0;g=g.parentNode}return!1}function $(g,E){return g.indexOf(E)>-1}function z(g){return g.trim().split(/\s+/g)}function Y(g,E,T){if(g.indexOf&&!T)return g.indexOf(E);for(var L=0;L<g.length;){if(T&&g[L][T]==E||!T&&g[L]===E)return L;L++}return-1}function W(g){return Array.prototype.slice.call(g,0)}function X(g,E,T){for(var L=[],j=[],q=0;q<g.length;){var me=E?g[q][E]:g[q];Y(j,me)<0&&L.push(g[q]),j[q]=me,q++}return T&&(E?L=L.sort(function(Xe,lt){return Xe[E]>lt[E]}):L=L.sort()),L}function ge(g,E){for(var T,L,j=E[0].toUpperCase()+E.slice(1),q=0;q<a.length;){if(T=a[q],L=T?T+j:E,L in g)return L;q++}return r}var $t=1;function be(){return $t++}function le(g){var E=g.ownerDocument||g;return E.defaultView||E.parentWindow||t}var S=/mobile|tablet|ip(ad|hone|od)|android/i,v="ontouchstart"in t,R=ge(t,"PointerEvent")!==r,O=v&&S.test(navigator.userAgent),F="touch",k="pen",B="mouse",G="kinect",re=25,oe=1,Re=2,pe=4,de=8,Ve=1,We=2,we=4,Pe=8,ct=16,ut=We|we,rt=Pe|ct,Ne=ut|rt,yt=["x","y"],Ee=["clientX","clientY"];function Ge(g,E){var T=this;this.manager=g,this.callback=E,this.element=g.element,this.target=g.options.inputTarget,this.domHandler=function(L){b(g.options.enable,[g])&&T.handler(L)},this.init()}Ge.prototype={handler:function(){},init:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(le(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&N(this.element,this.evEl,this.domHandler),this.evTarget&&N(this.target,this.evTarget,this.domHandler),this.evWin&&N(le(this.element),this.evWin,this.domHandler)}};function ta(g){var E,T=g.options.inputClass;return T?E=T:R?E=as:O?E=ra:v?E=os:E=ia,new E(g,Et)}function Et(g,E,T){var L=T.pointers.length,j=T.changedPointers.length,q=E&oe&&L-j==0,me=E&(pe|de)&&L-j==0;T.isFirst=!!q,T.isFinal=!!me,q&&(g.session={}),T.eventType=E,J(g,T),g.emit("hammer.input",T),g.recognize(T),g.session.prevInput=T}function J(g,E){var T=g.session,L=E.pointers,j=L.length;T.firstInput||(T.firstInput=tl(E)),j>1&&!T.firstMultiple?T.firstMultiple=tl(E):j===1&&(T.firstMultiple=!1);var q=T.firstInput,me=T.firstMultiple,Ue=me?me.center:q.center,Xe=E.center=nl(L);E.timeStamp=l(),E.deltaTime=E.timeStamp-q.timeStamp,E.angle=rs(Ue,Xe),E.distance=na(Ue,Xe),xe(T,E),E.offsetDirection=rl(E.deltaX,E.deltaY);var lt=il(E.deltaTime,E.deltaX,E.deltaY);E.overallVelocityX=lt.x,E.overallVelocityY=lt.y,E.overallVelocity=u(lt.x)>u(lt.y)?lt.x:lt.y,E.scale=me?Im(me.pointers,L):1,E.rotation=me?Om(me.pointers,L):0,E.maxPointers=T.prevInput?E.pointers.length>T.prevInput.maxPointers?E.pointers.length:T.prevInput.maxPointers:E.pointers.length,Nm(T,E);var Xt=g.element;P(E.srcEvent.target,Xt)&&(Xt=E.srcEvent.target),E.target=Xt}function xe(g,E){var T=E.center,L=g.offsetDelta||{},j=g.prevDelta||{},q=g.prevInput||{};(E.eventType===oe||q.eventType===pe)&&(j=g.prevDelta={x:q.deltaX||0,y:q.deltaY||0},L=g.offsetDelta={x:T.x,y:T.y}),E.deltaX=j.x+(T.x-L.x),E.deltaY=j.y+(T.y-L.y)}function Nm(g,E){var T=g.lastInterval||E,L=E.timeStamp-T.timeStamp,j,q,me,Ue;if(E.eventType!=de&&(L>re||T.velocity===r)){var Xe=E.deltaX-T.deltaX,lt=E.deltaY-T.deltaY,Xt=il(L,Xe,lt);q=Xt.x,me=Xt.y,j=u(Xt.x)>u(Xt.y)?Xt.x:Xt.y,Ue=rl(Xe,lt),g.lastInterval=E}else j=T.velocity,q=T.velocityX,me=T.velocityY,Ue=T.direction;E.velocity=j,E.velocityX=q,E.velocityY=me,E.direction=Ue}function tl(g){for(var E=[],T=0;T<g.pointers.length;)E[T]={clientX:c(g.pointers[T].clientX),clientY:c(g.pointers[T].clientY)},T++;return{timeStamp:l(),pointers:E,center:nl(E),deltaX:g.deltaX,deltaY:g.deltaY}}function nl(g){var E=g.length;if(E===1)return{x:c(g[0].clientX),y:c(g[0].clientY)};for(var T=0,L=0,j=0;j<E;)T+=g[j].clientX,L+=g[j].clientY,j++;return{x:c(T/E),y:c(L/E)}}function il(g,E,T){return{x:E/g||0,y:T/g||0}}function rl(g,E){return g===E?Ve:u(g)>=u(E)?g<0?We:we:E<0?Pe:ct}function na(g,E,T){T||(T=yt);var L=E[T[0]]-g[T[0]],j=E[T[1]]-g[T[1]];return Math.sqrt(L*L+j*j)}function rs(g,E,T){T||(T=yt);var L=E[T[0]]-g[T[0]],j=E[T[1]]-g[T[1]];return Math.atan2(j,L)*180/Math.PI}function Om(g,E){return rs(E[1],E[0],Ee)+rs(g[1],g[0],Ee)}function Im(g,E){return na(E[0],E[1],Ee)/na(g[0],g[1],Ee)}var km={mousedown:oe,mousemove:Re,mouseup:pe},Lm="mousedown",Bm="mousemove mouseup";function ia(){this.evEl=Lm,this.evWin=Bm,this.pressed=!1,Ge.apply(this,arguments)}A(ia,Ge,{handler:function(E){var T=km[E.type];T&oe&&E.button===0&&(this.pressed=!0),T&Re&&E.which!==1&&(T=pe),!!this.pressed&&(T&pe&&(this.pressed=!1),this.callback(this.manager,T,{pointers:[E],changedPointers:[E],pointerType:B,srcEvent:E}))}});var $m={pointerdown:oe,pointermove:Re,pointerup:pe,pointercancel:de,pointerout:de},Fm={2:F,3:k,4:B,5:G},al="pointerdown",ol="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(al="MSPointerDown",ol="MSPointerMove MSPointerUp MSPointerCancel");function as(){this.evEl=al,this.evWin=ol,Ge.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}A(as,Ge,{handler:function(E){var T=this.store,L=!1,j=E.type.toLowerCase().replace("ms",""),q=$m[j],me=Fm[E.pointerType]||E.pointerType,Ue=me==F,Xe=Y(T,E.pointerId,"pointerId");q&oe&&(E.button===0||Ue)?Xe<0&&(T.push(E),Xe=T.length-1):q&(pe|de)&&(L=!0),!(Xe<0)&&(T[Xe]=E,this.callback(this.manager,q,{pointers:T,changedPointers:[E],pointerType:me,srcEvent:E}),L&&T.splice(Xe,1))}});var jm={touchstart:oe,touchmove:Re,touchend:pe,touchcancel:de},Hm="touchstart",zm="touchstart touchmove touchend touchcancel";function sl(){this.evTarget=Hm,this.evWin=zm,this.started=!1,Ge.apply(this,arguments)}A(sl,Ge,{handler:function(E){var T=jm[E.type];if(T===oe&&(this.started=!0),!!this.started){var L=Gm.call(this,E,T);T&(pe|de)&&L[0].length-L[1].length==0&&(this.started=!1),this.callback(this.manager,T,{pointers:L[0],changedPointers:L[1],pointerType:F,srcEvent:E})}}});function Gm(g,E){var T=W(g.touches),L=W(g.changedTouches);return E&(pe|de)&&(T=X(T.concat(L),"identifier",!0)),[T,L]}var Vm={touchstart:oe,touchmove:Re,touchend:pe,touchcancel:de},Wm="touchstart touchmove touchend touchcancel";function ra(){this.evTarget=Wm,this.targetIds={},Ge.apply(this,arguments)}A(ra,Ge,{handler:function(E){var T=Vm[E.type],L=Um.call(this,E,T);!L||this.callback(this.manager,T,{pointers:L[0],changedPointers:L[1],pointerType:F,srcEvent:E})}});function Um(g,E){var T=W(g.touches),L=this.targetIds;if(E&(oe|Re)&&T.length===1)return L[T[0].identifier]=!0,[T,T];var j,q,me=W(g.changedTouches),Ue=[],Xe=this.target;if(q=T.filter(function(lt){return P(lt.target,Xe)}),E===oe)for(j=0;j<q.length;)L[q[j].identifier]=!0,j++;for(j=0;j<me.length;)L[me[j].identifier]&&Ue.push(me[j]),E&(pe|de)&&delete L[me[j].identifier],j++;if(!!Ue.length)return[X(q.concat(Ue),"identifier",!0),Ue]}var Ym=2500,cl=25;function os(){Ge.apply(this,arguments);var g=w(this.handler,this);this.touch=new ra(this.manager,g),this.mouse=new ia(this.manager,g),this.primaryTouch=null,this.lastTouches=[]}A(os,Ge,{handler:function(E,T,L){var j=L.pointerType==F,q=L.pointerType==B;if(!(q&&L.sourceCapabilities&&L.sourceCapabilities.firesTouchEvents)){if(j)qm.call(this,T,L);else if(q&&Km.call(this,L))return;this.callback(E,T,L)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function qm(g,E){g&oe?(this.primaryTouch=E.changedPointers[0].identifier,ul.call(this,E)):g&(pe|de)&&ul.call(this,E)}function ul(g){var E=g.changedPointers[0];if(E.identifier===this.primaryTouch){var T={x:E.clientX,y:E.clientY};this.lastTouches.push(T);var L=this.lastTouches,j=function(){var q=L.indexOf(T);q>-1&&L.splice(q,1)};setTimeout(j,Ym)}}function Km(g){for(var E=g.srcEvent.clientX,T=g.srcEvent.clientY,L=0;L<this.lastTouches.length;L++){var j=this.lastTouches[L],q=Math.abs(E-j.x),me=Math.abs(T-j.y);if(q<=cl&&me<=cl)return!0}return!1}var ll=ge(o.style,"touchAction"),pl=ll!==r,fl="compute",hl="auto",ss="manipulation",Qn="none",Zi="pan-x",Qi="pan-y",aa=Zm();function cs(g,E){this.manager=g,this.set(E)}cs.prototype={set:function(g){g==fl&&(g=this.compute()),pl&&this.manager.element.style&&aa[g]&&(this.manager.element.style[ll]=g),this.actions=g.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var g=[];return f(this.manager.recognizers,function(E){b(E.options.enable,[E])&&(g=g.concat(E.getTouchAction()))}),Xm(g.join(" "))},preventDefaults:function(g){var E=g.srcEvent,T=g.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var L=this.actions,j=$(L,Qn)&&!aa[Qn],q=$(L,Qi)&&!aa[Qi],me=$(L,Zi)&&!aa[Zi];if(j){var Ue=g.pointers.length===1,Xe=g.distance<2,lt=g.deltaTime<250;if(Ue&&Xe&&lt)return}if(!(me&&q)&&(j||q&&T&ut||me&&T&rt))return this.preventSrc(E)},preventSrc:function(g){this.manager.session.prevented=!0,g.preventDefault()}};function Xm(g){if($(g,Qn))return Qn;var E=$(g,Zi),T=$(g,Qi);return E&&T?Qn:E||T?E?Zi:Qi:$(g,ss)?ss:hl}function Zm(){if(!pl)return!1;var g={},E=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(T){g[T]=E?t.CSS.supports("touch-action",T):!0}),g}var oa=1,Ct=2,gi=4,Cn=8,ln=Cn,Ji=16,Kt=32;function pn(g){this.options=y({},this.defaults,g||{}),this.id=be(),this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=oa,this.simultaneous={},this.requireFail=[]}pn.prototype={defaults:{},set:function(g){return y(this.options,g),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(g){if(h(g,"recognizeWith",this))return this;var E=this.simultaneous;return g=sa(g,this),E[g.id]||(E[g.id]=g,g.recognizeWith(this)),this},dropRecognizeWith:function(g){return h(g,"dropRecognizeWith",this)?this:(g=sa(g,this),delete this.simultaneous[g.id],this)},requireFailure:function(g){if(h(g,"requireFailure",this))return this;var E=this.requireFail;return g=sa(g,this),Y(E,g)===-1&&(E.push(g),g.requireFailure(this)),this},dropRequireFailure:function(g){if(h(g,"dropRequireFailure",this))return this;g=sa(g,this);var E=Y(this.requireFail,g);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(g){return!!this.simultaneous[g.id]},emit:function(g){var E=this,T=this.state;function L(j){E.manager.emit(j,g)}T<Cn&&L(E.options.event+dl(T)),L(E.options.event),g.additionalEvent&&L(g.additionalEvent),T>=Cn&&L(E.options.event+dl(T))},tryEmit:function(g){if(this.canEmit())return this.emit(g);this.state=Kt},canEmit:function(){for(var g=0;g<this.requireFail.length;){if(!(this.requireFail[g].state&(Kt|oa)))return!1;g++}return!0},recognize:function(g){var E=y({},g);if(!b(this.options.enable,[this,E])){this.reset(),this.state=Kt;return}this.state&(ln|Ji|Kt)&&(this.state=oa),this.state=this.process(E),this.state&(Ct|gi|Cn|Ji)&&this.tryEmit(E)},process:function(g){},getTouchAction:function(){},reset:function(){}};function dl(g){return g&Ji?"cancel":g&Cn?"end":g&gi?"move":g&Ct?"start":""}function vl(g){return g==ct?"down":g==Pe?"up":g==We?"left":g==we?"right":""}function sa(g,E){var T=E.manager;return T?T.get(g):g}function Ft(){pn.apply(this,arguments)}A(Ft,pn,{defaults:{pointers:1},attrTest:function(g){var E=this.options.pointers;return E===0||g.pointers.length===E},process:function(g){var E=this.state,T=g.eventType,L=E&(Ct|gi),j=this.attrTest(g);return L&&(T&de||!j)?E|Ji:L||j?T&pe?E|Cn:E&Ct?E|gi:Ct:Kt}});function ca(){Ft.apply(this,arguments),this.pX=null,this.pY=null}A(ca,Ft,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ne},getTouchAction:function(){var g=this.options.direction,E=[];return g&ut&&E.push(Qi),g&rt&&E.push(Zi),E},directionTest:function(g){var E=this.options,T=!0,L=g.distance,j=g.direction,q=g.deltaX,me=g.deltaY;return j&E.direction||(E.direction&ut?(j=q===0?Ve:q<0?We:we,T=q!=this.pX,L=Math.abs(g.deltaX)):(j=me===0?Ve:me<0?Pe:ct,T=me!=this.pY,L=Math.abs(g.deltaY))),g.direction=j,T&&L>E.threshold&&j&E.direction},attrTest:function(g){return Ft.prototype.attrTest.call(this,g)&&(this.state&Ct||!(this.state&Ct)&&this.directionTest(g))},emit:function(g){this.pX=g.deltaX,this.pY=g.deltaY;var E=vl(g.direction);E&&(g.additionalEvent=this.options.event+E),this._super.emit.call(this,g)}});function us(){Ft.apply(this,arguments)}A(us,Ft,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.scale-1)>this.options.threshold||this.state&Ct)},emit:function(g){if(g.scale!==1){var E=g.scale<1?"in":"out";g.additionalEvent=this.options.event+E}this._super.emit.call(this,g)}});function ls(){pn.apply(this,arguments),this._timer=null,this._input=null}A(ls,pn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hl]},process:function(g){var E=this.options,T=g.pointers.length===E.pointers,L=g.distance<E.threshold,j=g.deltaTime>E.time;if(this._input=g,!L||!T||g.eventType&(pe|de)&&!j)this.reset();else if(g.eventType&oe)this.reset(),this._timer=p(function(){this.state=ln,this.tryEmit()},E.time,this);else if(g.eventType&pe)return ln;return Kt},reset:function(){clearTimeout(this._timer)},emit:function(g){this.state===ln&&(g&&g.eventType&pe?this.manager.emit(this.options.event+"up",g):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}});function ps(){Ft.apply(this,arguments)}A(ps,Ft,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.rotation)>this.options.threshold||this.state&Ct)}});function fs(){Ft.apply(this,arguments)}A(fs,Ft,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ut|rt,pointers:1},getTouchAction:function(){return ca.prototype.getTouchAction.call(this)},attrTest:function(g){var E=this.options.direction,T;return E&(ut|rt)?T=g.overallVelocity:E&ut?T=g.overallVelocityX:E&rt&&(T=g.overallVelocityY),this._super.attrTest.call(this,g)&&E&g.offsetDirection&&g.distance>this.options.threshold&&g.maxPointers==this.options.pointers&&u(T)>this.options.velocity&&g.eventType&pe},emit:function(g){var E=vl(g.offsetDirection);E&&this.manager.emit(this.options.event+E,g),this.manager.emit(this.options.event,g)}});function ua(){pn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}A(ua,pn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ss]},process:function(g){var E=this.options,T=g.pointers.length===E.pointers,L=g.distance<E.threshold,j=g.deltaTime<E.time;if(this.reset(),g.eventType&oe&&this.count===0)return this.failTimeout();if(L&&j&&T){if(g.eventType!=pe)return this.failTimeout();var q=this.pTime?g.timeStamp-this.pTime<E.interval:!0,me=!this.pCenter||na(this.pCenter,g.center)<E.posThreshold;this.pTime=g.timeStamp,this.pCenter=g.center,!me||!q?this.count=1:this.count+=1,this._input=g;var Ue=this.count%E.taps;if(Ue===0)return this.hasRequireFailures()?(this._timer=p(function(){this.state=ln,this.tryEmit()},E.interval,this),Ct):ln}return Kt},failTimeout:function(){return this._timer=p(function(){this.state=Kt},this.options.interval,this),Kt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ln&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function fn(g,E){return E=E||{},E.recognizers=_(E.recognizers,fn.defaults.preset),new hs(g,E)}fn.VERSION="2.0.7",fn.defaults={domEvents:!1,touchAction:fl,enable:!0,inputTarget:null,inputClass:null,preset:[[ps,{enable:!1}],[us,{enable:!1},["rotate"]],[fs,{direction:ut}],[ca,{direction:ut},["swipe"]],[ua],[ua,{event:"doubletap",taps:2},["tap"]],[ls]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Qm=1,ml=2;function hs(g,E){this.options=y({},fn.defaults,E||{}),this.options.inputTarget=this.options.inputTarget||g,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=g,this.input=ta(this),this.touchAction=new cs(this,this.options.touchAction),gl(this,!0),f(this.options.recognizers,function(T){var L=this.add(new T[0](T[1]));T[2]&&L.recognizeWith(T[2]),T[3]&&L.requireFailure(T[3])},this)}hs.prototype={set:function(g){return y(this.options,g),g.touchAction&&this.touchAction.update(),g.inputTarget&&(this.input.destroy(),this.input.target=g.inputTarget,this.input.init()),this},stop:function(g){this.session.stopped=g?ml:Qm},recognize:function(g){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(g);var T,L=this.recognizers,j=E.curRecognizer;(!j||j&&j.state&ln)&&(j=E.curRecognizer=null);for(var q=0;q<L.length;)T=L[q],E.stopped!==ml&&(!j||T==j||T.canRecognizeWith(j))?T.recognize(g):T.reset(),!j&&T.state&(Ct|gi|Cn)&&(j=E.curRecognizer=T),q++}},get:function(g){if(g instanceof pn)return g;for(var E=this.recognizers,T=0;T<E.length;T++)if(E[T].options.event==g)return E[T];return null},add:function(g){if(h(g,"add",this))return this;var E=this.get(g.options.event);return E&&this.remove(E),this.recognizers.push(g),g.manager=this,this.touchAction.update(),g},remove:function(g){if(h(g,"remove",this))return this;if(g=this.get(g),g){var E=this.recognizers,T=Y(E,g);T!==-1&&(E.splice(T,1),this.touchAction.update())}return this},on:function(g,E){if(g!==r&&E!==r){var T=this.handlers;return f(z(g),function(L){T[L]=T[L]||[],T[L].push(E)}),this}},off:function(g,E){if(g!==r){var T=this.handlers;return f(z(g),function(L){E?T[L]&&T[L].splice(Y(T[L],E),1):delete T[L]}),this}},emit:function(g,E){this.options.domEvents&&Jm(g,E);var T=this.handlers[g]&&this.handlers[g].slice();if(!(!T||!T.length)){E.type=g,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var L=0;L<T.length;)T[L](E),L++}},destroy:function(){this.element&&gl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function gl(g,E){var T=g.element;if(!!T.style){var L;f(g.options.cssProps,function(j,q){L=ge(T.style,q),E?(g.oldCssProps[L]=T.style[L],T.style[L]=j):T.style[L]=g.oldCssProps[L]||""}),E||(g.oldCssProps={})}}function Jm(g,E){var T=n.createEvent("Event");T.initEvent(g,!0,!0),T.gesture=E,E.target.dispatchEvent(T)}y(fn,{INPUT_START:oe,INPUT_MOVE:Re,INPUT_END:pe,INPUT_CANCEL:de,STATE_POSSIBLE:oa,STATE_BEGAN:Ct,STATE_CHANGED:gi,STATE_ENDED:Cn,STATE_RECOGNIZED:ln,STATE_CANCELLED:Ji,STATE_FAILED:Kt,DIRECTION_NONE:Ve,DIRECTION_LEFT:We,DIRECTION_RIGHT:we,DIRECTION_UP:Pe,DIRECTION_DOWN:ct,DIRECTION_HORIZONTAL:ut,DIRECTION_VERTICAL:rt,DIRECTION_ALL:Ne,Manager:hs,Input:Ge,TouchAction:cs,TouchInput:ra,MouseInput:ia,PointerEventInput:as,TouchMouseInput:os,SingleTouchInput:sl,Recognizer:pn,AttrRecognizer:Ft,Tap:ua,Pan:ca,Swipe:fs,Pinch:us,Rotate:ps,Press:ls,on:M,off:N,each:f,merge:D,extend:x,assign:y,inherit:A,bindFn:w,prefixed:ge});var eg=typeof t!="undefined"?t:typeof self!="undefined"?self:{};eg.Hammer=fn,typeof r=="function"&&r.amd?r(function(){return fn}):e.exports?e.exports=fn:t[i]=fn})(window,document,"Hammer")})(_f);var ai=_f.exports,Yx=.2,qx=4,wf=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function Wa(e,t){return t.get(e,!1)}function sc(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function cc(e){function t(u){C(wf,function(l){te.bind(e,l,sc,!0)})}function n(u){setTimeout(function(){C(wf,function(l){te.unbind(e,l,sc,!0)})},500)}te.bind(e,"touchstart",t,!0),te.bind(e,"touchend",n,!0),te.bind(e,"touchcancel",n,!0);var i=new ai.Manager(e,{inputClass:ai.TouchInput,recognizers:[],domEvents:!0}),r=new ai.Tap,a=new ai.Pan({threshold:10}),o=new ai.Press,s=new ai.Pinch,c=new ai.Tap({event:"doubletap",taps:2});return s.requireFailure(a),s.requireFailure(o),i.add([a,o,s,c,r]),i.reset=function(u){var l=this.recognizers,p=this.session;p.stopped||(i.stop(u),setTimeout(function(){var h,f;for(h=0;f=l[h];h++)f.reset(),f.state=8;p.curRecognizer=null},0))},i.on("hammer.input",function(u){u.srcEvent.defaultPrevented&&i.reset(!0)}),i}function Sf(e,t,n,i,r){var a=Wa("dragging",e),o=Wa("move",e),s=Wa("contextPad",e),c=Wa("palette",e),u;function l(f){return function(d){r.fire(f,d)}}function p(f){var d=ei(f,"svg, .djs-element",!0);return d}function h(f){u=cc(f),u.on("doubletap",l("element.dblclick")),u.on("tap",l("element.click"));function d(D){var A=0,w=0;function b(M){var N=M.deltaX-A,P=M.deltaY-w;t.scroll({dx:N,dy:P}),A=M.deltaX,w=M.deltaY}function _(M){u.off("panmove",b),u.off("panend",_),u.off("pancancel",_)}u.on("panmove",b),u.on("panend",_),u.on("pancancel",_)}function y(D){var A=p(D.target),w=A&&i.get(A);if(o&&t.getRootElement()!==w)return o.start(D,w,!0);d()}function x(D){var A=t.zoom(),w=D.center;function b(M){var N=1-(1-M.scale)/1.5,P=Math.max(Yx,Math.min(qx,N*A));t.zoom(P,w),sc(M)}function _(M){u.off("pinchmove",b),u.off("pinchend",_),u.off("pinchcancel",_),u.reset(!0)}u.on("pinchmove",b),u.on("pinchend",_),u.on("pinchcancel",_)}u.on("panstart",y),u.on("press",y),u.on("pinchstart",x)}a&&n.on("drag.move",function(f){var d=f.originalEvent;if(!(!d||d instanceof MouseEvent)){var y=Fn(d),x=document.elementFromPoint(y.x,y.y),D=p(x),A=D&&i.get(D);A!==f.hover&&(f.hover&&a.out(f),A&&(a.hover({element:A,gfx:D}),f.hover=A,f.hoverGfx=D))}}),s&&n.on("contextPad.create",function(f){var d=f.pad.html,y=cc(d);y.on("panstart",function(x){s.trigger("dragstart",x,!0)}),y.on("press",function(x){s.trigger("dragstart",x,!0)}),y.on("tap",function(x){s.trigger("click",x)})}),c&&n.on("palette.create",function(f){var d=f.container,y=cc(d);y.on("panstart",function(x){c.trigger("dragstart",x,!0)}),y.on("press",function(x){c.trigger("dragstart",x,!0)}),y.on("tap",function(x){c.trigger("click",x)})}),n.on("canvas.init",function(f){h(f.svg)})}Sf.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function uc(e,t){var n=this;t.on("canvas.init",function(i){n.addBBoxMarker(i.svg)})}uc.$inject=["canvas","eventBus"];uc.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=Q("rect");H(n,{x:-1e4,y:1e4,width:10,height:10}),H(n,t),ne(e,n);var i=Q("rect");H(i,{x:1e4,y:1e4,width:10,height:10}),H(i,t),ne(e,i)};var Kx={__depends__:[gr],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",Sf],touchFix:["type",uc]},Xx={__depends__:[Kx]};function lc(e){return e&&e[e.length-1]}function Tf(e){return e.y}function Rf(e){return e.x}var Zx={left:Rf,center:Rf,right:function(e){return e.x+e.width},top:Tf,middle:Tf,bottom:function(e){return e.y+e.height}};function Fi(e){this._modeling=e}Fi.$inject=["modeling"];Fi.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};Fi.prototype._isType=function(e,t){return t.indexOf(e)!==-1};Fi.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,r=n.dimension,a={},o={},s=!1,c,u,l;function p(h,f){return Math.round((h[i]+f[i]+f[r])/2)}if(this._isType(e,["left","top"]))a[e]=t[0][i];else if(this._isType(e,["right","bottom"]))l=lc(t),a[e]=l[i]+l[r];else if(this._isType(e,["center","middle"])){if(C(t,function(h){var f=h[i]+Math.round(h[r]/2);o[f]?o[f].elements.push(h):o[f]={elements:[h],center:f}}),c=jt(o,function(h){return h.elements.length>1&&(s=!0),h.elements.length}),s)return a[e]=lc(c).center,a;u=t[0],t=jt(t,function(h){return h[i]+h[r]}),l=lc(t),a[e]=p(u,l)}return a};Fi.prototype.trigger=function(e,t){var n=this._modeling,i=se(e,function(s){return!(s.waypoints||s.host||s.labelTarget)});if(!(i.length<2)){var r=Zx[t],a=jt(i,r),o=this._alignmentPosition(t,a);n.alignElements(a,o)}};var Qx={__init__:["alignElements"],alignElements:["type",Fi]},Jx=10,Cf=50,e_=250;function pc(e,t,n,i){for(var r;r=t_(e,n,t);)n=i(t,n,r);return n}function fc(e){return function(t,n,i){var r={x:n.x,y:n.y};return["x","y"].forEach(function(a){var o=e[a];if(!!o){var s=a==="x"?"width":"height",c=o.margin,u=o.minDistance;c<0?r[a]=Math.min(i[a]+c-t[s]/2,n[a]-u+c):r[a]=Math.max(i[a]+i[s]+c+t[s]/2,n[a]+u+c)}}),r}}function t_(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},r=i_(e);return _e(r,function(a){if(a===n)return!1;var o=Je(a,i,Jx);return o==="intersect"})}function n_(e,t){t||(t={});function n(d){return d.source===e?1:-1}var i=t.defaultDistance||Cf,r=t.direction||"e",a=t.filter,o=t.getWeight||n,s=t.maxDistance||e_,c=t.reference||"start";a||(a=o_);function u(d,y){return r==="n"?c==="start"?ee(d).top-ee(y).bottom:c==="center"?ee(d).top-ce(y).y:ee(d).top-ee(y).top:r==="w"?c==="start"?ee(d).left-ee(y).right:c==="center"?ee(d).left-ce(y).x:ee(d).left-ee(y).left:r==="s"?c==="start"?ee(y).top-ee(d).bottom:c==="center"?ce(y).y-ee(d).bottom:ee(y).bottom-ee(d).bottom:c==="start"?ee(y).left-ee(d).right:c==="center"?ce(y).x-ee(d).right:ee(y).right-ee(d).right}var l=e.incoming.filter(a).map(function(d){var y=o(d),x=y<0?u(d.source,e):u(e,d.source);return{id:d.source.id,distance:x,weight:y}}),p=e.outgoing.filter(a).map(function(d){var y=o(d),x=y>0?u(e,d.target):u(d.target,e);return{id:d.target.id,distance:x,weight:y}}),h=l.concat(p).reduce(function(d,y){return d[y.id+"__weight_"+y.weight]=y,d},{}),f=bt(h,function(d,y){var x=y.distance,D=y.weight;return x<0||x>s||(d[String(x)]||(d[String(x)]=0),d[String(x)]+=1*D,(!d.distance||d[d.distance]<d[String(x)])&&(d.distance=x)),d},{});return f.distance||i}function i_(e){var t=hc(e);return e.host&&(t=t.concat(hc(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(hc(i))},[]))),t}function hc(e){return a_(e).concat(r_(e))}function r_(e){return e.incoming.map(function(t){return t.source})}function a_(e){return e.outgoing.map(function(t){return t.target})}function o_(){return!0}var s_=100;function Pf(e,t,n){e.on("autoPlace",s_,function(i){var r=i.shape,a=i.source;return c_(a,r)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,r,a){e.fire("autoPlace.start",{source:i,shape:r});var o=e.fire("autoPlace",{source:i,shape:r}),s=t.appendShape(i,r,o,i.parent,a);return e.fire("autoPlace.end",{source:i,shape:s}),s}}Pf.$inject=["eventBus","modeling","canvas"];function c_(e,t,n){n||(n={});var i=n.defaultDistance||Cf,r=ce(e),a=ee(e);return{x:a.right+i+t.width/2,y:r.y}}function Af(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}Af.$inject=["eventBus","selection"];var u_={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",Pf],autoPlaceSelectionBehavior:["type",Af]};function ye(e,t){return Jn(t,function(n){return m(e,n)})}function Ua(e,t){for(typeof t=="string"&&(t=[t]);e=e.parent;)if(ye(e,t))return e;return null}function Mf(e,t){if(m(t,"bpmn:TextAnnotation"))return f_(e,t);if(ye(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return h_(e,t);if(m(t,"bpmn:FlowNode"))return l_(e,t)}function l_(e,t){var n=ee(e),i=ce(e),r=n_(e,{filter:function(l){return m(l,"bpmn:SequenceFlow")}}),a=30,o=80,s="left";m(e,"bpmn:BoundaryEvent")&&(s=Je(e,e.host,-25),s.indexOf("top")!==-1&&(a*=-1));var c={x:n.right+r+t.width/2,y:i.y+p_(s,o)},u={y:{margin:a,minDistance:o}};return pc(e,t,c,fc(u))}function p_(e,t){return e.indexOf("top")!=-1?-1*t:e.indexOf("bottom")!=-1?t:0}function f_(e,t){var n=ee(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2},r={y:{margin:-30,minDistance:20}};return pc(e,t,i,fc(r))}function h_(e,t){var n=ee(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},r={x:{margin:30,minDistance:30}};return pc(e,t,i,fc(r))}function Df(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return Mf(i,n)})}Df.$inject=["eventBus"];var d_={__depends__:[u_],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",Df]},v_=1e3;function U(e){this._eventBus=e}U.$inject=["eventBus"];function m_(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}U.prototype.on=function(e,t,n,i,r,a){if((at(t)||ae(t))&&(a=r,r=i,i=n,n=t,t=null),at(n)&&(a=r,r=i,i=n,n=v_),Ze(r)&&(a=r,r=!1),!at(i))throw new Error("handlerFn must be a function");fe(e)||(e=[e]);var o=this._eventBus;C(e,function(s){var c=["commandStack",s,t].filter(function(u){return u}).join(".");o.on(c,n,r?m_(i,a):i,a)})};var g_=["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"];C(g_,function(e){U.prototype[e]=function(t,n,i,r,a){(at(t)||ae(t))&&(a=r,r=i,i=n,n=t,t=null),this.on(t,e,n,i,r,a)}});function En(e,t,n,i){U.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(a){var o=a.context,s=o.hints||{},c=o.shape,u=o.parent||o.newParent;s.autoResize!==!1&&r._expand([c],u)}),this.postExecuted(["elements.move"],function(a){var o=a.context,s=la(ms(o.closure.topLevel)),c=o.hints,u=c?c.autoResize:!0;if(u!==!1){var l=Ei(s,function(p){return p.parent.id});C(l,function(p,h){fe(u)&&(p=p.filter(function(f){return _e(u,Ht({id:f.id}))})),r._expand(p,h)})}}),this.postExecuted(["shape.toggleCollapse"],function(a){var o=a.context,s=o.hints,c=o.shape;s&&s.autoResize===!1||c.collapsed||r._expand(c.children||[],c)}),this.postExecuted(["shape.resize"],function(a){var o=a.context,s=o.hints,c=o.shape,u=c.parent;s&&s.autoResize===!1||u&&r._expand([c],u)})}En.$inject=["eventBus","elementRegistry","modeling","rules"];Z(En,U);En.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=ee(Qe(e)),a=ee(t),o={};return r.top-a.top<i.top&&(o.top=r.top-n.top),r.left-a.left<i.left&&(o.left=r.left-n.left),a.right-r.right<i.right&&(o.right=r.right+n.right),a.bottom-r.bottom<i.bottom&&(o.bottom=r.bottom+n.bottom),$s(I({},a,o))};En.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(!!n){var i=this._getOptimalBounds(e,t);if(!!y_(i,t)){var r=E_(zt(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:r});var a=t.parent;a&&this._expand([t],a)}}};En.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};En.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};En.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function y_(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function E_(e,t){var n="";return e=ee(e),t=ee(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function Ya(e){e.invoke(En,this)}Ya.$inject=["injector"];Z(Ya,En);Ya.prototype.resize=function(e,t,n){m(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function zn(e){U.call(this,e),this.init()}zn.$inject=["eventBus"];Z(zn,U);zn.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(r){i.canExecute(r,t,function(a,o,s){return n(a)},!0)})};zn.prototype.init=function(){};function xr(e){zn.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}xr.$inject=["eventBus"];Z(xr,zn);xr.prototype.canResize=function(e,t){return!1};function qa(e,t){xr.call(this,e),this._modeling=t}Z(qa,xr);qa.$inject=["eventBus","modeling"];qa.prototype.canResize=function(e,t){if(!m(t,"bpmn:Participant")&&!m(t,"bpmn:Lane")&&!m(t,"bpmn:SubProcess"))return!1;var n=!0;return C(e,function(i){if(m(i,"bpmn:Lane")||i.labelTarget){n=!1;return}}),n};var b_={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Ya],bpmnAutoResizeProvider:["type",qa]},Nf=1500;function Of(e,t,n){var i=this,r=n.get("dragging",!1);function a(o){if(!o.hover){var s=o.originalEvent,c=i._findTargetGfx(s),u=c&&e.get(c);c&&u&&(o.stopPropagation(),r.hover({element:u,gfx:c}),r.move(s))}}r&&t.on("drag.start",function(o){t.once("drag.move",Nf,function(s){a(s)})}),function(){var o,s;t.on("element.hover",function(c){o=c.gfx,s=c.element}),t.on("element.hover",Nf,function(c){s&&t.fire("element.out",{element:s,gfx:o})}),t.on("element.out",function(){o=null,s=null})}(),this._findTargetGfx=function(o){var s,c;if(o instanceof MouseEvent)return s=Fn(o),c=document.elementFromPoint(s.x,s.y),x_(c)}}Of.$inject=["elementRegistry","eventBus","injector"];function x_(e){return ei(e,"svg, .djs-element",!0)}var __={__init__:["hoverFix"],hoverFix:["type",Of]},ji=Math.round,If="djs-drag-active";function oi(e){e.preventDefault()}function w_(e){return typeof TouchEvent!="undefined"&&e instanceof TouchEvent}function S_(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function kf(e,t,n,i){var r={threshold:5,trapClick:!0},a;function o(w){var b=t.viewbox(),_=t._container.getBoundingClientRect();return{x:b.x+(w.x-_.left)/b.scale,y:b.y+(w.y-_.top)/b.scale}}function s(w,b){b=b||a;var _=e.createEvent(I({},b.payload,b.data,{isTouch:b.isTouch}));return e.fire("drag."+w,_)===!1?!1:e.fire(b.prefix+"."+w,_)}function c(w){var b=w.filter(function(_){return i.get(_.id)});b.length&&n.select(b)}function u(w,b){var _=a.payload,M=a.displacement,N=a.globalStart,P=Fn(w),$=rn(P,N),z=a.localStart,Y=o(P),W=rn(Y,z);if(!a.active&&(b||S_($)>a.threshold)){if(I(_,{x:ji(z.x+M.x),y:ji(z.y+M.y),dx:0,dy:0},{originalEvent:w}),s("start")===!1)return x();a.active=!0,a.keepSelection||(_.previousSelection=n.get(),n.select(null)),a.cursor&&Va(a.cursor),t.addMarker(t.getRootElement(),If)}ec(w),a.active&&(I(_,{x:ji(Y.x+M.x),y:ji(Y.y+M.y),dx:ji(W.x),dy:ji(W.y)},{originalEvent:w}),s("move"))}function l(w){var b,_=!0;a.active&&(w&&(a.payload.originalEvent=w,ec(w)),_=s("end")),_===!1&&s("rejected"),b=D(_!==!0),s("ended",b)}function p(w){w.which===27&&(oi(w),x())}function h(w){var b;a.active&&(b=mf(e),setTimeout(b,400),oi(w)),l(w)}function f(w){u(w)}function d(w){var b=a.payload;b.hoverGfx=w.gfx,b.hover=w.element,s("hover")}function y(w){s("out");var b=a.payload;b.hoverGfx=null,b.hover=null}function x(w){var b;if(!!a){var _=a.active;_&&s("cancel"),b=D(w),_&&s("canceled",b)}}function D(w){var b,_;s("cleanup"),vf(),a.trapClick?_=h:_=l,te.unbind(document,"mousemove",u),te.unbind(document,"dragstart",oi),te.unbind(document,"selectstart",oi),te.unbind(document,"mousedown",_,!0),te.unbind(document,"mouseup",_,!0),te.unbind(document,"keyup",p),te.unbind(document,"touchstart",f,!0),te.unbind(document,"touchcancel",x,!0),te.unbind(document,"touchmove",u,!0),te.unbind(document,"touchend",l,!0),e.off("element.hover",d),e.off("element.out",y),t.removeMarker(t.getRootElement(),If);var M=a.payload.previousSelection;return w!==!1&&M&&!n.get().length&&c(M),b=a,a=null,b}function A(w,b,_,M){a&&x(!1),typeof b=="string"&&(M=_,_=b,b=null),M=I({},r,M||{});var N=M.data||{},P,$,z,Y,W;M.trapClick?Y=h:Y=l,w?(P=ki(w)||w,$=Fn(w),ec(w),P.type==="dragstart"&&oi(P)):(P=null,$={x:0,y:0}),z=o($),b||(b=z),W=w_(P),a=I({prefix:_,data:N,payload:{},globalStart:$,displacement:rn(b,z),localStart:z,isTouch:W},M),M.manual||(W?(te.bind(document,"touchstart",f,!0),te.bind(document,"touchcancel",x,!0),te.bind(document,"touchmove",u,!0),te.bind(document,"touchend",l,!0)):(te.bind(document,"mousemove",u),te.bind(document,"dragstart",oi),te.bind(document,"selectstart",oi),te.bind(document,"mousedown",Y,!0),te.bind(document,"mouseup",Y,!0)),te.bind(document,"keyup",p),e.on("element.hover",d),e.on("element.out",y)),s("init"),M.autoActivate&&u(w,!0)}e.on("diagram.destroy",x),this.init=A,this.move=u,this.hover=d,this.out=y,this.end=l,this.cancel=x,this.context=function(){return a},this.setOptions=function(w){I(r,w)}}kf.$inject=["eventBus","canvas","selection","elementRegistry"];var bn={__depends__:[__,nn],dragging:["type",kf]};function Hi(e,t,n){this._canvas=n,this._opts=I({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(r){var a=i._toBorderPoint(r);i.startScroll(a)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Hi.$inject=["config.autoScroll","eventBus","canvas"];Hi.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),a=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var o=0,s=0,c=0;c<4;c++)T_(a[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(c===0?o=n.scrollStep:c==1?s=n.scrollStep:c==2?o=-n.scrollStep:c==3&&(s=-n.scrollStep));(o!==0||s!==0)&&(t.scroll({dx:o,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function T_(e,t,n){return t<e&&e<n}Hi.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Hi.prototype.setOptions=function(e){this._opts=I({},this._opts,e)};Hi.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=Fn(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};var R_={__depends__:[bn],__init__:["autoScroll"],autoScroll:["type",Hi]};function dc(e){this._commandStack=e.get("commandStack",!1)}dc.$inject=["injector"];dc.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};var on={__init__:["rules"],rules:["type",dc]},Ka=Math.round,C_=Math.max;function P_(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function A_(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var Lf=10;function M_(e,t){var n,i;for(n=0;i=e[n];n++)if(or(i,t)<=Lf)return{point:e[n],bendpoint:!0,index:n};return null}function D_(e,t){var n=sp(P_(t,Lf),A_(e)),i=n[0],r=n[n.length-1],a;return i?i!==r?i.segment2!==r.segment2?(a=C_(i.segment2,r.segment2)-1,{point:e[a],bendpoint:!0,index:a}):{point:{x:Ka(i.x+r.x)/2,y:Ka(i.y+r.y)/2},index:i.segment2}:{point:{x:Ka(i.x),y:Ka(i.y)},index:i.segment2}:null}function vc(e,t){return M_(e,t)||D_(e,t)}var Bf="djs-bendpoint",$f="djs-segment-dragger";function N_(e,t){var n=Fn(t),i=e._container.getBoundingClientRect(),r;r={x:i.left,y:i.top};var a=e.viewbox();return{x:a.x+(n.x-r.x)/a.scale,y:a.y+(n.y-r.y)/a.scale}}function mc(e,t,n){var i=N_(e,n),r=vc(t,i);return r}function gc(e,t){var n=Q("g");he(n).add(Bf),ne(e,n);var i=Q("circle");H(i,{cx:0,cy:0,r:4}),he(i).add("djs-visual"),ne(n,i);var r=Q("circle");return H(r,{cx:0,cy:0,r:10}),he(r).add("djs-hit"),ne(n,r),t&&he(n).add(t),n}function O_(e,t,n,i){var r=Q("g");ne(e,r);var a=14,o=3,s=11,c=I_(t,n,i),u=o+s,l=Q("rect");H(l,{x:-a/2,y:-o/2,width:a,height:o}),he(l).add("djs-visual"),ne(r,l);var p=Q("rect");return H(p,{x:-c/2,y:-u/2,width:c,height:u}),he(p).add("djs-hit"),ne(r,p),wp(r,i==="v"?90:0),r}function Ff(e,t,n){var i=Q("g"),r=ks(t,n),a=vn(t,n);return ne(e,i),O_(i,t,n,a),he(i).add($f),he(i).add(a==="h"?"horizontal":"vertical"),vt(i,r.x,r.y),i}function yc(e){return Math.abs(Math.round(e*2/3))}function I_(e,t,n){var i=t.x-e.x,r=t.y-e.y;return yc(n==="h"?i:r)}var jf={exports:{}};/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */(function(e,t){(function(n,i){e.exports=i(n)})(typeof ds!="undefined"?ds:ds,function(n){if(n.CSS&&n.CSS.escape)return n.CSS.escape;var i=function(r){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var a=String(r),o=a.length,s=-1,c,u="",l=a.charCodeAt(0);++s<o;){if(c=a.charCodeAt(s),c==0){u+="\uFFFD";continue}if(c>=1&&c<=31||c==127||s==0&&c>=48&&c<=57||s==1&&c>=48&&c<=57&&l==45){u+="\\"+c.toString(16)+" ";continue}if(s==0&&o==1&&c==45){u+="\\"+a.charAt(s);continue}if(c>=128||c==45||c==95||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){u+=a.charAt(s);continue}u+="\\"+a.charAt(s)}return u};return n.CSS||(n.CSS={}),n.CSS.escape=i,i})})(jf);var Ec=jf.exports,k_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Hf(e){return e=""+e,e&&e.replace(/[&<>"']/g,function(t){return k_[t]})}function zf(e,t,n,i,r){function a(w,b,_){var M=w.index,N=w.point,P,$,z,Y,W,X;return M<=0||w.bendpoint?!1:(P=b[M-1],$=b[M],z=ks(P,$),Y=vn(P,$),W=Math.abs(N.x-z.x),X=Math.abs(N.y-z.y),Y&&W<=_&&X<=_)}function o(w,b){var _=w.waypoints,M,N,P,$;return b.index<=0||b.bendpoint||(M={start:_[b.index-1],end:_[b.index]},N=vn(M.start,M.end),!N)?null:(N==="h"?P=M.end.x-M.start.x:P=M.end.y-M.start.y,$=yc(P)/2,$)}function s(w,b){var _=b.waypoints,M=mc(t,_,w),N;if(!!M)return N=o(b,M),a(M,_,N)?r.start(w,b,M.index):i.start(w,b,M.index,!M.bendpoint),!0}function c(w,b,_){te.bind(w,b,function(M){n.triggerMouseEvent(b,M,_),M.stopPropagation()})}function u(w,b){var _=t.getLayer("overlays"),M=Oe('.djs-bendpoints[data-element-id="'+Ec(w.id)+'"]',_);return!M&&b&&(M=Q("g"),H(M,{"data-element-id":w.id}),he(M).add("djs-bendpoints"),ne(_,M),c(M,"mousedown",w),c(M,"click",w),c(M,"dblclick",w)),M}function l(w,b){return Oe('.djs-segment-dragger[data-segment-idx="'+w+'"]',b)}function p(w,b){b.waypoints.forEach(function(_,M){var N=gc(w);ne(w,N),vt(N,_.x,_.y)}),gc(w,"floating")}function h(w,b){for(var _=b.waypoints,M,N,P,$=1;$<_.length;$++)M=_[$-1],N=_[$],vn(M,N)&&(P=Ff(w,M,N),H(P,{"data-segment-idx":$}),c(P,"mousemove",b))}function f(w){C(xs("."+Bf,w),function(b){Be(b)})}function d(w){C(xs("."+$f,w),function(b){Be(b)})}function y(w){var b=u(w);return b||(b=u(w,!0),p(b,w),h(b,w)),b}function x(w){var b=u(w);b&&(d(b),f(b),h(b,w),p(b,w))}function D(w,b){var _=Oe(".floating",w),M=b.point;!_||vt(_,M.x,M.y)}function A(w,b,_){var M=l(b.index,w),N=_[b.index-1],P=_[b.index],$=b.point,z=ks(N,P),Y=vn(N,P),W,X;!M||(W=L_(M),X={x:$.x-z.x,y:$.y-z.y},Y==="v"&&(X={x:X.y,y:X.x}),vt(W,X.x,X.y))}e.on("connection.changed",function(w){x(w.element)}),e.on("connection.remove",function(w){var b=u(w.element);b&&Be(b)}),e.on("element.marker.update",function(w){var b=w.element,_;!b.waypoints||(_=y(b),w.add?he(_).add(w.marker):he(_).remove(w.marker))}),e.on("element.mousemove",function(w){var b=w.element,_=b.waypoints,M,N;if(_){if(M=u(b,!0),N=mc(t,_,w.originalEvent),!N)return;D(M,N),N.bendpoint||A(M,N,_)}}),e.on("element.mousedown",function(w){if(!!jn(w)){var b=w.originalEvent,_=w.element;if(!!_.waypoints)return s(b,_)}}),e.on("selection.changed",function(w){var b=w.newSelection,_=b[0];_&&_.waypoints&&y(_)}),e.on("element.hover",function(w){var b=w.element;b.waypoints&&(y(b),n.registerEvent(w.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(w){n.unregisterEvent(w.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(w){var b=w.element,_=w.newId;if(b.waypoints){var M=u(b);M&&H(M,{"data-element-id":_})}}),this.addHandles=y,this.updateHandles=x,this.getBendpointsContainer=u,this.getSegmentDragger=l}zf.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function L_(e){return Oe(".djs-visual",e)}var Gf=Math.round,si="reconnectStart",ci="reconnectEnd",_r="updateWaypoints";function bc(e,t,n,i,r,a){this._injector=e,this.start=function(o,s,c,u){var l=n.getGraphics(s),p=s.source,h=s.target,f=s.waypoints,d;!u&&c===0?d=si:!u&&c===f.length-1?d=ci:d=_r;var y=d===_r?"connection.updateWaypoints":"connection.reconnect",x=r.allowed(y,{connection:s,source:p,target:h});x===!1&&(x=r.allowed(y,{connection:s,source:h,target:p})),x!==!1&&i.init(o,"bendpoint.move",{data:{connection:s,connectionGfx:l,context:{allowed:x,bendpointIndex:c,connection:s,source:p,target:h,insert:u,type:d}}})},t.on("bendpoint.move.hover",function(o){var s=o.context,c=s.connection,u=c.source,l=c.target,p=o.hover,h=s.type;s.hover=p;var f;if(!!p){var d=h===_r?"connection.updateWaypoints":"connection.reconnect";if(f=s.allowed=r.allowed(d,{connection:c,source:h===si?p:u,target:h===ci?p:l}),f){s.source=h===si?p:u,s.target=h===ci?p:l;return}f===!1&&(f=s.allowed=r.allowed(d,{connection:c,source:h===ci?p:l,target:h===si?p:u})),f&&(s.source=h===ci?p:l,s.target=h===si?p:u)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(o){var s=o.context,c=s.type;s.hover=null,s.source=null,s.target=null,c!==_r&&(s.allowed=!1)}),t.on("bendpoint.move.end",function(o){var s=o.context,c=s.allowed,u=s.bendpointIndex,l=s.connection,p=s.insert,h=l.waypoints.slice(),f=s.source,d=s.target,y=s.type,x=s.hints||{},D={x:Gf(o.x),y:Gf(o.y)};if(!c)return!1;y===_r?(p?h.splice(u,0,D):h[u]=D,x.bendpointMove={insert:p,bendpointIndex:u},h=this.cropWaypoints(l,h),a.updateWaypoints(l,Ty(h),x)):(y===si?(x.docking="source",Xa(s)&&(x.docking="target",x.newWaypoints=h.reverse())):y===ci&&(x.docking="target",Xa(s)&&(x.docking="source",x.newWaypoints=h.reverse())),a.reconnect(l,f,d,D,x))},this)}bc.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];bc.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function Xa(e){var t=e.hover,n=e.source,i=e.target,r=e.type;if(r===si)return t&&i&&t===i&&n!==i;if(r===ci)return t&&n&&t===n&&n!==i}var B_="reconnectStart",$_="reconnectEnd",Vf="updateWaypoints",wr="connect-ok",Za="connect-not-ok",Wf="connect-hover",Uf="djs-updating",Yf="djs-element-hidden",qf=1100;function Kf(e,t,n,i){this._injector=t;var r=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(a){var o=a.context,s=o.bendpointIndex,c=o.connection,u=o.insert,l=c.waypoints,p=l.slice();o.waypoints=l,u&&p.splice(s,0,{x:a.x,y:a.y}),c.waypoints=p;var h=o.draggerGfx=gc(i.getLayer("overlays"));he(h).add("djs-dragging"),i.addMarker(c,Yf),i.addMarker(c,Uf)}),n.on("bendpoint.move.hover",function(a){var o=a.context,s=o.allowed,c=o.hover,u=o.type;if(c){if(i.addMarker(c,Wf),u===Vf)return;s?(i.removeMarker(c,Za),i.addMarker(c,wr)):s===!1&&(i.removeMarker(c,wr),i.addMarker(c,Za))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],qf,function(a){var o=a.context,s=o.hover,c=o.target;s&&(i.removeMarker(s,Wf),i.removeMarker(s,c?wr:Za))}),n.on("bendpoint.move.move",function(a){var o=a.context,s=o.allowed,c=o.bendpointIndex,u=o.draggerGfx,l=o.hover,p=o.type,h=o.connection,f=h.source,d=h.target,y=h.waypoints.slice(),x={x:a.x,y:a.y},D=o.hints||{},A={};r&&(D.connectionStart&&(A.connectionStart=D.connectionStart),D.connectionEnd&&(A.connectionEnd=D.connectionEnd),p===B_?Xa(o)?(A.connectionEnd=A.connectionEnd||x,A.source=d,A.target=l||f,y=y.reverse()):(A.connectionStart=A.connectionStart||x,A.source=l||f,A.target=d):p===$_?Xa(o)?(A.connectionStart=A.connectionStart||x,A.source=l||d,A.target=f,y=y.reverse()):(A.connectionEnd=A.connectionEnd||x,A.source=f,A.target=l||d):(A.noCropping=!0,A.noLayout=!0,y[c]=x),p===Vf&&(y=e.cropWaypoints(h,y)),A.waypoints=y,r.drawPreview(o,s,A)),vt(u,a.x,a.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],qf,function(a){var o=a.context,s=o.connection,c=o.draggerGfx,u=o.hover,l=o.target,p=o.waypoints;s.waypoints=p,Be(c),i.removeMarker(s,Uf),i.removeMarker(s,Yf),u&&(i.removeMarker(u,wr),i.removeMarker(u,l?wr:Za)),r&&r.cleanUp(o)})}Kf.$inject=["bendpointMove","injector","eventBus","canvas"];var Xf="connect-hover",Zf="djs-updating";function Qf(e,t,n){return xc(e,t,e[t]+n)}function xc(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function F_(e,t,n,i){var r=Math.max(t[i],n[i]),a=Math.min(t[i],n[i]),o=20,s=Math.min(Math.max(a+o,e[i]),r-o);return xc(t,i,s)}function Jf(e){return e==="x"?"y":"x"}function eh(e,t,n){var i,r;return e.original?e.original:(i=ce(t),r=Jf(n),xc(e,r,i[r]))}function th(e,t,n,i,r,a){var o=e.get("connectionDocking",!1);this.start=function(p,h,f){var d,y=n.getGraphics(h),x=f-1,D=f,A=h.waypoints,w=A[x],b=A[D],_=mc(n,A,p),M,N,P;M=vn(w,b),!!M&&(N=M==="v"?"x":"y",x===0&&(w=eh(w,h.source,N)),D===A.length-1&&(b=eh(b,h.target,N)),_?P=_.point:P={x:(w.x+b.x)/2,y:(w.y+b.y)/2},d={connection:h,segmentStartIndex:x,segmentEndIndex:D,segmentStart:w,segmentEnd:b,axis:N,dragPosition:P},i.init(p,P,"connectionSegment.move",{cursor:N==="x"?"resize-ew":"resize-ns",data:{connection:h,connectionGfx:y,context:d}}))};function s(p,h){if(!o)return h;var f=p.waypoints,d;return p.waypoints=h,d=o.getCroppedWaypoints(p),p.waypoints=f,d}function c(p){r.update("connection",p.connection,p.connectionGfx)}function u(p,h,f){var d=p.newWaypoints,y=p.segmentStartIndex+h,x=d[y],D=p.segmentEndIndex+h,A=d[D],w=Jf(p.axis),b=F_(f,x,A,w);vt(p.draggerGfx,b.x,b.y)}function l(p,h){var f=0,d=p.filter(function(y,x){return Is(p[x-1],p[x+1],y)?(f=x<=h?f-1:f,!1):!0});return{waypoints:d,segmentOffset:f}}t.on("connectionSegment.move.start",function(p){var h=p.context,f=p.connection,d=n.getLayer("overlays");h.originalWaypoints=f.waypoints.slice(),h.draggerGfx=Ff(d,h.segmentStart,h.segmentEnd),he(h.draggerGfx).add("djs-dragging"),n.addMarker(f,Zf)}),t.on("connectionSegment.move.move",function(p){var h=p.context,f=h.connection,d=h.segmentStartIndex,y=h.segmentEndIndex,x=h.segmentStart,D=h.segmentEnd,A=h.axis,w=h.originalWaypoints.slice(),b=Qf(x,A,p["d"+A]),_=Qf(D,A,p["d"+A]),M=w.length,N=0;w[d]=b,w[y]=_;var P,$;d<2&&(P=Je(f.source,b),d===1?P==="intersect"&&(w.shift(),w[0]=b,N--):P!=="intersect"&&(w.unshift(x),N++)),y>M-3&&($=Je(f.target,_),y===M-2?$==="intersect"&&(w.pop(),w[w.length-1]=_):$!=="intersect"&&w.push(D)),h.newWaypoints=f.waypoints=s(f,w),u(h,N,p),h.newSegmentStartIndex=d+N,c(p)}),t.on("connectionSegment.move.hover",function(p){p.context.hover=p.hover,n.addMarker(p.hover,Xf)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(p){var h=p.context.hover;h&&n.removeMarker(h,Xf)}),t.on("connectionSegment.move.cleanup",function(p){var h=p.context,f=h.connection;h.draggerGfx&&Be(h.draggerGfx),n.removeMarker(f,Zf)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(p){var h=p.context,f=h.connection;f.waypoints=h.originalWaypoints,c(p)}),t.on("connectionSegment.move.end",function(p){var h=p.context,f=h.connection,d=h.newWaypoints,y=h.newSegmentStartIndex;d=d.map(function(_){return{original:_.original,x:Math.round(_.x),y:Math.round(_.y)}});var x=l(d,y),D=x.waypoints,A=s(f,D),w=x.segmentOffset,b={segmentMove:{segmentStartIndex:h.segmentStartIndex,newSegmentStartIndex:y+w}};a.updateWaypoints(f,A,b)})}th.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var j_=Math.abs,nh=Math.round;function H_(e,t,n){n=n===void 0?10:n;var i,r;for(i=0;i<t.length;i++)if(r=t[i],j_(r-e)<=n)return r}function ih(e){return{x:e.x,y:e.y}}function rh(e){return{x:e.x+e.width,y:e.y+e.height}}function Dt(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:nh(e.x+e.width/2),y:nh(e.y+e.height/2)}}function zi(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function ze(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,r=e[t],a=e.snapped=e.snapped||{};return n===!1?a[t]=!1:(a[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i),r}function ah(e){return e.children||[]}var z_=Math.abs,oh=Math.round,_c=10;function sh(e){function t(a,o){if(fe(a)){for(var s=a.length;s--;)if(z_(a[s]-o)<=_c)return a[s]}else{a=+a;var c=o%a;if(c<_c)return o-c;if(c>a-_c)return o-c+a}return o}function n(a){if(a.width)return{x:oh(a.width/2+a.x),y:oh(a.height/2+a.y)}}function i(a){var o=a.snapPoints,s=a.connection,c=s.waypoints,u=a.segmentStart,l=a.segmentStartIndex,p=a.segmentEnd,h=a.segmentEndIndex,f=a.axis;if(o)return o;var d=[c[l-1],u,p,c[h+1]];return l<2&&d.unshift(n(s.source)),h>c.length-3&&d.unshift(n(s.target)),a.snapPoints=o={horizontal:[],vertical:[]},C(d,function(y){y&&(y=y.original||y,f==="y"&&o.horizontal.push(y.y),f==="x"&&o.vertical.push(y.x))}),o}e.on("connectionSegment.move.move",1500,function(a){var o=a.context,s=i(o),c=a.x,u=a.y,l,p;if(!!s){l=t(s.vertical,c),p=t(s.horizontal,u);var h=c-l,f=u-p;I(a,{dx:a.dx-h,dy:a.dy-f,x:l,y:p}),(h||s.vertical.indexOf(c)!==-1)&&ze(a,"x",l),(f||s.horizontal.indexOf(u)!==-1)&&ze(a,"y",p)}});function r(a){var o=a.snapPoints,s=a.connection.waypoints,c=a.bendpointIndex;if(o)return o;var u=[s[c-1],s[c+1]];return a.snapPoints=o={horizontal:[],vertical:[]},C(u,function(l){l&&(l=l.original||l,o.horizontal.push(l.y),o.vertical.push(l.x))}),o}e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(a){var o=a.context,s=r(o),c=o.hover,u=c&&n(c),l=a.x,p=a.y,h,f;if(!!s){h=t(u?s.vertical.concat([u.x]):s.vertical,l),f=t(u?s.horizontal.concat([u.y]):s.horizontal,p);var d=l-h,y=p-f;I(a,{dx:a.dx-d,dy:a.dy-y,x:a.x-d,y:a.y-y}),(d||s.vertical.indexOf(l)!==-1)&&ze(a,"x",h),(y||s.horizontal.indexOf(p)!==-1)&&ze(a,"y",f)}})}sh.$inject=["eventBus"];var G_={__depends__:[bn,on],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",zf],bendpointMove:["type",bc],bendpointMovePreview:["type",Kf],connectionSegmentMove:["type",th],bendpointSnapping:["type",sh]};function ch(e,t,n,i){function r(o,s){return i.allowed("connection.create",{source:o,target:s})}function a(o,s){return r(s,o)}e.on("connect.hover",function(o){var s=o.context,c=s.start,u=o.hover,l;if(s.hover=u,l=s.canExecute=r(c,u),!Sl(l)){if(l!==!1){s.source=c,s.target=u;return}l=s.canExecute=a(c,u),!Sl(l)&&l!==!1&&(s.source=u,s.target=c)}}),e.on(["connect.out","connect.cleanup"],function(o){var s=o.context;s.hover=null,s.source=null,s.target=null,s.canExecute=!1}),e.on("connect.end",function(o){var s=o.context,c=s.canExecute,u=s.connectionStart,l={x:o.x,y:o.y},p=s.source,h=s.target;if(!c)return!1;var f=null,d={connectionStart:wc(s)?l:u,connectionEnd:wc(s)?u:l};Ze(c)&&(f=c),n.connect(p,h,f,d)}),this.start=function(o,s,c,u){Ze(c)||(u=c,c=ce(s)),t.init(o,"connect",{autoActivate:u,data:{shape:s,context:{start:s,connectionStart:c}}})}}ch.$inject=["eventBus","dragging","modeling","rules"];function wc(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var V_=1100,W_=900,uh="connect-ok",lh="connect-not-ok";function ph(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(r){var a=r.context,o=a.canExecute,s=a.hover,c=a.source,u=a.start,l=a.startPosition,p=a.target,h=a.connectionStart||l,f=a.connectionEnd||{x:r.x,y:r.y},d=h,y=f;wc(a)&&(d=f,y=h),i.drawPreview(a,o,{source:c||u,target:p||s,connectionStart:d,connectionEnd:y})}),t.on("connect.hover",W_,function(r){var a=r.context,o=r.hover,s=a.canExecute;s!==null&&n.addMarker(o,s?uh:lh)}),t.on(["connect.out","connect.cleanup"],V_,function(r){var a=r.hover;a&&(n.removeMarker(a,uh),n.removeMarker(a,lh))}),i&&t.on("connect.cleanup",function(r){i.cleanUp(r.context)})}ph.$inject=["injector","eventBus","canvas"];var Sc={__depends__:[nn,on,bn],__init__:["connectPreview"],connect:["type",ch],connectPreview:["type",ph]},U_="djs-connection-preview";function xn(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}xn.$inject=["injector","canvas","graphicsFactory","elementFactory"];xn.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,r=e.getConnection,a=n.source,o=n.target,s=n.waypoints,c=n.connectionStart,u=n.connectionEnd,l=n.noLayout,p=n.noCropping,h=n.noNoop,f,d=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),Ts(i),r||(r=e.getConnection=Y_(function(y,x,D){return d.getConnection(y,x,D)})),t&&(f=r(t,a,o)),!f){!h&&this.drawNoopPreview(i,n);return}f.waypoints=s||[],this._layouter&&!l&&(f.waypoints=this._layouter.layoutConnection(f,{source:a,target:o,connectionStart:c,connectionEnd:u,waypoints:n.waypoints||f.waypoints})),(!f.waypoints||!f.waypoints.length)&&(f.waypoints=[a?ce(a):c,o?ce(o):u]),this._connectionDocking&&(a||o)&&!p&&(f.waypoints=this._connectionDocking.getCroppedWaypoints(f,a,o)),this._graphicsFactory.drawConnection(i,f)};xn.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||ce(n),a=t.connectionEnd||ce(i),o=this.cropWaypoints(r,a,n,i),s=this.createNoopConnection(o[0],o[1]);ne(e,s)};xn.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,a=n&&r.getShapePath(n),o=i&&r.getShapePath(i),s=r.getConnectionPath({waypoints:[e,t]});return e=n&&Fs(a,s,!0)||e,t=i&&Fs(o,s,!1)||t,[e,t]};xn.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&Be(e.connectionPreviewGfx)};xn.prototype.getConnection=function(e){var t=q_(e);return this._elementFactory.createConnection(t)};xn.prototype.createConnectionPreviewGfx=function(){var e=Q("g");return H(e,{pointerEvents:"none"}),he(e).add(U_),ne(this._canvas.getActiveLayer(),e),e};xn.prototype.createNoopConnection=function(e,t){var n=Q("polyline");return H(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),H(n,{points:[e.x,e.y,t.x,t.y]}),n};function Y_(e){var t={};return function(n){var i=JSON.stringify(n),r=t[i];return r||(r=t[i]=e.apply(null,arguments)),r}}function q_(e){return Ze(e)?e:{}}var K_={__init__:["connectionPreview"],connectionPreview:["type",xn]},fh=Math.min,hh=Math.max;function Tc(e){e.preventDefault()}function Sr(e){e.stopPropagation()}function X_(e){return e.nodeType===Node.TEXT_NODE}function Z_(e){return[].slice.call(e)}function Wt(e){this.container=e.container,this.parent=Ce('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=Oe("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=pt(this.autoResize,this),this.handlePaste=pt(this.handlePaste,this)}Wt.prototype.create=function(e,t,n,i){var r=this,a=this.parent,o=this.content,s=this.container;i=this.options=i||{},t=this.style=t||{};var c=zt(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);I(a.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},c);var u=zt(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return I(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},u),i.centerVertically&&I(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},u),o.innerText=n,te.bind(o,"keydown",this.keyHandler),te.bind(o,"mousedown",Sr),te.bind(o,"paste",r.handlePaste),i.autoResize&&te.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),s.appendChild(a),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),a};Wt.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var r=this.autoResize(n);r&&this.resizeHandler(r)}};Wt.prototype.insertText=function(e){e=Q_(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};Wt.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,r=t.startOffset,a=t.endOffset,o=t.commonAncestorContainer,s=Z_(o.childNodes),c,u;if(X_(o)){var l=n.textContent;n.textContent=l.substring(0,r)+e+l.substring(a),c=n,u=r+e.length}else if(n===this.content&&i===this.content){var p=document.createTextNode(e);this.content.insertBefore(p,s[r]),c=p,u=p.textContent.length}else{var h=s.indexOf(n),f=s.indexOf(i);s.forEach(function(d,y){y===h?d.textContent=n.textContent.substring(0,r)+e+i.textContent.substring(a):y>h&&y<=f&&Qt(d)}),c=n,u=r+e.length}c&&u!==void 0&&setTimeout(function(){self.setSelection(c,u)})};Wt.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}};Wt.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,a=parseInt(this.style.maxWidth)||1/0,o=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=Ce('<div class="djs-direct-editing-resize-handle"></div>');var s,c,u,l,p=function(d){Tc(d),Sr(d),s=d.clientX,c=d.clientY;var y=t.getBoundingClientRect();u=y.width,l=y.height,te.bind(document,"mousemove",h),te.bind(document,"mouseup",f)},h=function(d){Tc(d),Sr(d);var y=fh(hh(u+d.clientX-s,i),a),x=fh(hh(l+d.clientY-c,r),o);t.style.width=y+"px",t.style.height=x+"px",e.resizeHandler({width:u,height:l,dx:d.clientX-s,dy:d.clientY-c})},f=function(d){Tc(d),Sr(d),te.unbind(document,"mousemove",h,!1),te.unbind(document,"mouseup",f,!1)};te.bind(n,"mousedown",p)}I(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};Wt.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),te.unbind(t,"keydown",this.keyHandler),te.unbind(t,"mousedown",Sr),te.unbind(t,"input",this.autoResize),te.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),Qt(n)),Qt(e)};Wt.prototype.getValue=function(){return this.content.innerText.trim()};Wt.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};Wt.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function Q_(e){return e.replace(/\r\n|\r|\n/g,`
`)}function Nt(e,t){this._eventBus=e,this._providers=[],this._textbox=new Wt({container:t.getContainer(),keyHandler:pt(this._handleKey,this),resizeHandler:pt(this._handleResize,this)})}Nt.$inject=["eventBus","canvas"];Nt.prototype.registerProvider=function(e){this._providers.push(e)};Nt.prototype.isActive=function(){return!!this._active};Nt.prototype.cancel=function(){!this._active||(this._fire("cancel"),this.close())};Nt.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};Nt.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};Nt.prototype.complete=function(){var e=this._active;if(!!e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue(),a=e.context.text;(r!==a||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};Nt.prototype.getValue=function(){return this._textbox.getValue()};Nt.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};Nt.prototype._handleResize=function(e){this._fire("resize",e)};Nt.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=_e(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var dh={__depends__:[gr],__init__:["directEditing"],directEditing:["type",Nt]},vh=".entry",J_=1e3;function Ot(e,t,n){this._eventBus=t,this._overlays=n;var i=Zt(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}Ot.$inject=["config.contextPad","eventBus","overlays"];Ot.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(n){var i=n.newSelection;i.length===1?t.open(i[0]):t.close()}),e.on("elements.delete",function(n){var i=n.elements;C(i,function(r){t.isOpen(r)&&t.close()})}),e.on("element.changed",function(n){var i=n.element,r=t._current;r&&r.element===i&&t.open(i,!0)})};Ot.prototype.registerProvider=function(e,t){t||(t=e,e=J_),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};Ot.prototype.getEntries=function(e){var t=this._getProviders(),n={};return C(t,function(i){var r=i.getContextPadEntries(e);at(r)?n=r(n):C(r,function(a,o){n[o]=a})}),n};Ot.prototype.trigger=function(e,t,n){var i=this._current.element,r=this._current.entries,a,o,s,c=t.delegateTarget||t.target;if(!c)return t.preventDefault();if(a=r[xt(c,"data-action")],o=a.action,s=t.originalEvent||t,at(o)){if(e==="click")return o(s,i,n)}else if(o[e])return o[e](s,i,n);t.preventDefault()};Ot.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};Ot.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};Ot.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;C(t,function(r,a){var o=r.group||"default",s=Ce(r.html||'<div class="entry" draggable="true"></div>'),c;xt(s,"data-action",a),c=Oe("[data-group="+o+"]",i),c||(c=Ce('<div class="group" data-group="'+o+'"></div>'),i.appendChild(c)),c.appendChild(s),r.className&&e0(s,r.className),r.title&&xt(s,"title",r.title),r.imageUrl&&s.appendChild(Ce('<img src="'+r.imageUrl+'">'))}),je(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})};Ot.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=Ce('<div class="djs-context-pad"></div>'),r=I({html:i},this._overlaysConfig);_t.bind(i,vh,"click",function(o){t.trigger("click",o)}),_t.bind(i,vh,"dragstart",function(o){t.trigger("dragstart",o)}),te.bind(i,"mousedown",function(o){o.stopPropagation()}),this._overlayId=n.add(e,"context-pad",r);var a=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:a}),a};Ot.prototype.close=function(){!this.isOpen()||(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};Ot.prototype.isOpen=function(e){return!!this._current&&(e?this._current.element===e:!0)};function e0(e,t){var n=je(e),i=fe(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}var t0={__depends__:[gr,nc],contextPad:["type",Ot]},n0=["marker-start","marker-mid","marker-end"],i0=["circle","ellipse","line","path","polygon","polyline","rect"];function ui(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){C(r._clonedMarkers,function(a){Be(a)}),r._clonedMarkers={}})}ui.$inject=["elementRegistry","eventBus","canvas","styles"];ui.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};ui.prototype.addDragger=function(e,t,n){n=n||this.getGfx(e);var i=kl(n),r=n.getBoundingClientRect();return this._cloneMarkers(Ra(i)),H(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),ne(t,i),i};ui.prototype.addFrame=function(e,t){var n=Q("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return ne(t,n),n};ui.prototype._cloneMarkers=function(e){var t=this;if(e.childNodes)for(var n=0;n<e.childNodes.length;n++)t._cloneMarkers(e.childNodes[n]);!s0(e)||n0.forEach(function(i){if(H(e,i)){var r=r0(e,i,t._canvas.getContainer());t._cloneMarker(e,r,i)}})};ui.prototype._cloneMarker=function(e,t,n){var i=t.id,r=this._clonedMarkers[i];if(!r){r=kl(t);var a=i+"-clone";r.id=a,he(r).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=r;var o=Oe("defs",this._canvas._svg);o||(o=Q("defs"),ne(this._canvas._svg,o)),ne(o,r)}var s=o0(this._clonedMarkers[i].id);H(e,n,s)};function r0(e,t,n){var i=a0(H(e,t));return Oe("marker#"+i,n||document)}function a0(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function o0(e){return"url(#"+e+")"}function s0(e){return i0.indexOf(e.nodeName)!==-1}var Tr={__init__:["previewSupport"],previewSupport:["type",ui]},c0="drop-ok",mh="drop-not-ok",gh="attach-ok",yh="new-parent",Eh="create",u0=2e3;function bh(e,t,n,i,r){function a(c,u,l,p,h){if(!u)return!1;c=se(c,function(A){var w=A.labelTarget;return!A.parent&&!(l0(A)&&c.indexOf(w)!==-1)});var f=_e(c,function(A){return!Rr(A)}),d=!1,y=!1,x=!1;_h(c)&&(d=r.allowed("shape.attach",{position:l,shape:f,target:u})),d||(_h(c)?x=r.allowed("shape.create",{position:l,shape:f,source:p,target:u}):x=r.allowed("elements.create",{elements:c,position:l,target:u}));var D=h.connectionTarget;return x||d?(f&&p&&(y=r.allowed("connection.create",{source:D===p?f:p,target:D===p?p:f,hints:{targetParent:u,targetAttach:d}})),{attach:d,connect:y}):x===null||d===null?null:!1}function o(c,u){[gh,c0,mh,yh].forEach(function(l){l===u?e.addMarker(c,l):e.removeMarker(c,l)})}n.on(["create.move","create.hover"],function(c){var u=c.context,l=u.elements,p=c.hover,h=u.source,f=u.hints||{};if(!p){u.canExecute=!1,u.target=null;return}xh(c);var d={x:c.x,y:c.y},y=u.canExecute=p&&a(l,p,d,h,f);p&&y!==null&&(u.target=p,y&&y.attach?o(p,gh):o(p,y?yh:mh))}),n.on(["create.end","create.out","create.cleanup"],function(c){var u=c.hover;u&&o(u,null)}),n.on("create.end",function(c){var u=c.context,l=u.source,p=u.shape,h=u.elements,f=u.target,d=u.canExecute,y=d&&d.attach,x=d&&d.connect,D=u.hints||{};if(d===!1||!f)return!1;xh(c);var A={x:c.x,y:c.y};x?p=i.appendShape(l,p,A,f,{attach:y,connection:x===!0?{}:x,connectionTarget:D.connectionTarget}):(h=i.createElements(h,A,f,I({},D,{attach:y})),p=_e(h,function(w){return!Rr(w)})),I(u,{elements:h,shape:p}),I(c,{elements:h,shape:p})});function s(){var c=t.context();c&&c.prefix===Eh&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],u0,function(){n.off("elements.changed",s)})}),this.start=function(c,u,l){fe(u)||(u=[u]);var p=_e(u,function(f){return!Rr(f)});if(!!p){l=I({elements:u,hints:{},shape:p},l||{}),C(u,function(f){ae(f.x)||(f.x=0),ae(f.y)||(f.y=0)});var h=Qe(u);C(u,function(f){Rr(f)&&(f.waypoints=Ye(f.waypoints,function(d){return{x:d.x-h.x-h.width/2,y:d.y-h.y-h.height/2}})),I(f,{x:f.x-h.x-h.width/2,y:f.y-h.y-h.height/2})}),t.init(c,Eh,{cursor:"grabbing",autoActivate:!0,data:{shape:p,elements:u,context:l}})}}}bh.$inject=["canvas","dragging","eventBus","modeling","rules"];function xh(e){var t=e.context,n=t.createConstraints;!n||(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function Rr(e){return!!e.waypoints}function _h(e){return e&&e.length===1&&!Rr(e[0])}function l0(e){return!!e.labelTarget}var p0=750;function wh(e,t,n,i,r){function a(o){var s=Q("g");H(s,r.cls("djs-drag-group",["no-events"]));var c=Q("g");return o.forEach(function(u){var l;u.hidden||(u.waypoints?(l=n._createContainer("connection",c),n.drawConnection(Ra(l),u)):(l=n._createContainer("shape",c),n.drawShape(Ra(l),u),vt(l,u.x,u.y)),i.addDragger(u,s,l))}),s}t.on("create.move",p0,function(o){var s=o.hover,c=o.context,u=c.elements,l=c.dragGroup;l||(l=c.dragGroup=a(u));var p;s?(l.parentNode||(p=e.getActiveLayer(),ne(p,l)),vt(l,o.x,o.y)):Be(l)}),t.on("create.cleanup",function(o){var s=o.context,c=s.dragGroup;c&&Be(c)})}wh.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var Qa={__depends__:[bn,Tr,on,nn],__init__:["create","createPreview"],create:["type",bh],createPreview:["type",wh]},Sh="data-id",Th=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],f0=1e3;function $e(e,t,n){var i=Zt(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}$e.$inject=["config.popupMenu","eventBus","canvas"];$e.prototype.registerProvider=function(e,t,n){n||(n=t,t=f0),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};$e.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._getProviders(t);if(!n)return!0;var i=this._getEntries(e,n),r=this._getHeaderEntries(e,n),a=nr(i)>0,o=r&&nr(r)>0;return!a&&!o};$e.prototype.open=function(e,t,n){var i=this._getProviders(t);if(!e)throw new Error("Element is missing");if(!i||!i.length)throw new Error("No registered providers for: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={className:t,element:e,position:n},a=this._getEntries(e,i),o=this._getHeaderEntries(e,i);r.entries=I({},a,o),r.container=this._createContainer(),nr(o)&&r.container.appendChild(this._createEntries(o,"djs-popup-header")),nr(a)&&r.container.appendChild(this._createEntries(a,"djs-popup-body"));var s=this._canvas,c=s.getContainer();this._attachContainer(r.container,c,n.cursor),this._bindAutoClose()};$e.prototype.close=function(){!this.isOpen()||(this._emit("close"),this._unbindAutoClose(),Qt(this._current.container),this._current.container=null)};$e.prototype.isOpen=function(){return!!this._current.container};$e.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=xt(t,Sh),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)};$e.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};$e.prototype._getEntries=function(e,t){var n={};return C(t,function(i){if(!i.getPopupMenuEntries){C(i.getEntries(e),function(a){var o=a.id;if(!o)throw new Error("every entry must have the id property set");n[o]=Pn(a,["id"])});return}var r=i.getPopupMenuEntries(e);at(r)?n=r(n):C(r,function(a,o){n[o]=a})}),n};$e.prototype._getHeaderEntries=function(e,t){var n={};return C(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;C(i.getHeaderEntries(e),function(a){var o=a.id;if(!o)throw new Error("every entry must have the id property set");n[o]=Pn(a,["id"])});return}var r=i.getPopupMenuHeaderEntries(e);at(r)?n=r(n):C(r,function(a,o){n[o]=a})}),n};$e.prototype._getEntry=function(e){var t=this._current.entries[e];if(!t)throw new Error("entry not found");return t};$e.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)};$e.prototype._createContainer=function(){var e=Ce('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return I(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),je(e).add(n),e};$e.prototype._attachContainer=function(e,t,n){var i=this;_t.bind(e,".entry","click",function(r){i.trigger(r)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n)};$e.prototype._updateScale=function(e){var t=this._canvas.zoom(),n=this._config.scale,i,r,a=t;n!==!0&&(n===!1?(i=1,r=1):(i=n.min,r=n.max),Zt(i)&&t<i&&(a=i),Zt(r)&&t>r&&(a=r)),h0(e,"scale("+a+")")};$e.prototype._assureIsInbounds=function(e,t){var n=this._canvas,i=n._container.getBoundingClientRect(),r=e.offsetLeft,a=e.offsetTop,o=e.scrollWidth,s=e.scrollHeight,c={},u,l,p={x:t.x-i.left,y:t.y-i.top};r+o>i.width&&(c.x=!0),a+s>i.height&&(c.y=!0),c.x&&c.y?(u=p.x-o+"px",l=p.y-s+"px"):c.x?(u=p.x-o+"px",l=p.y+"px"):c.y&&p.y<s?(u=p.x+"px",l=10+"px"):c.y&&(u=p.x+"px",l=p.y-s+"px"),I(e.style,{left:u,top:l},{visibility:"visible","z-index":1e3})};$e.prototype._createEntries=function(e,t){var n=Ce("<div>"),i=this;return je(n).add(t),C(e,function(r,a){var o=i._createEntry(r,a);n.appendChild(o)}),n};$e.prototype._createEntry=function(e,t){var n=Ce("<div>"),i=je(n);if(i.add("entry"),e.className&&e.className.split(" ").forEach(function(a){i.add(a)}),xt(n,Sh,t),e.label){var r=Ce("<span>");r.textContent=e.label,n.appendChild(r)}return e.imageUrl&&n.appendChild(Ce('<img src="'+e.imageUrl+'" />')),e.active===!0&&i.add("active"),e.disabled===!0&&i.add("disabled"),e.title&&(n.title=e.title),n};$e.prototype._bindAutoClose=function(){this._eventBus.once(Th,this.close,this)};$e.prototype._unbindAutoClose=function(){this._eventBus.off(Th,this.close,this)};function h0(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}var d0={__init__:["popupMenu"],popupMenu:["type",$e]};function Cr(){}Cr.prototype.get=function(){return this._data};Cr.prototype.set=function(e){this._data=e};Cr.prototype.clear=function(){var e=this._data;return delete this._data,e};Cr.prototype.isEmpty=function(){return!this._data};var v0={clipboard:["type",Cr]};function Rc(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var r=t._svg=i.svg;r.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}Rc.$inject=["eventBus"];Rc.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||m0(0,0)};function m0(e,t){var n=document.createEvent("MouseEvent"),i=e,r=t,a=e,o=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,a,o,!1,!1,!1,!1,0,null),n}var Pr={__init__:["mouse"],mouse:["type",Rc]};function Ut(e,t,n,i,r,a,o,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=r,this._modeling=a,this._mouse=o,this._rules=s,r.on("copyPaste.copyElement",function(c){var u=c.descriptor,l=c.element,p=c.elements;u.priority=1,u.id=l.id;var h=_e(p,function(f){return f===l.parent});h&&(u.parent=l.parent.id),g0(l)&&(u.priority=2,u.host=l.host.id),Ja(l)&&(u.priority=3,u.source=l.source.id,u.target=l.target.id,u.waypoints=y0(l)),eo(l)&&(u.priority=4,u.labelTarget=l.labelTarget.id),C(["x","y","width","height"],function(f){ae(l[f])&&(u[f]=l[f])}),u.hidden=l.hidden,u.collapsed=l.collapsed}),r.on("copyPaste.pasteElements",function(c){var u=c.hints;I(u,{createElementsBehavior:!1})})}Ut.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];Ut.prototype.copy=function(e){var t,n;return fe(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(fe(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};Ut.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};Ut.prototype._paste=function(e,t,n,i){C(e,function(a){ae(a.x)||(a.x=0),ae(a.y)||(a.y=0)});var r=Qe(e);return C(e,function(a){Ja(a)&&(a.waypoints=Ye(a.waypoints,function(o){return{x:o.x-r.x-r.width/2,y:o.y-r.y-r.height/2}})),I(a,{x:a.x-r.x-r.width/2,y:a.y-r.y-r.height/2})}),this._modeling.createElements(e,n,t,I({},i))};Ut.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},r=[];return C(e,function(a,o){a=jt(a,"priority"),C(a,function(s){var c=I({},Pn(s,["priority"]));i[s.parent]?c.parent=i[s.parent]:delete c.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:c});var u;if(Ja(c)){c.source=i[s.source],c.target=i[s.target],u=i[s.id]=t.createConnection(c),r.push(u);return}if(eo(c)){c.labelTarget=i[c.labelTarget],u=i[s.id]=t.createLabel(c),r.push(u);return}c.host&&(c.host=i[c.host]),u=i[s.id]=t.createShape(c),r.push(u)})}),r};Ut.prototype.createConnection=function(e){var t=this._elementFactory.createConnection(Pn(e,["id"]));return t};Ut.prototype.createLabel=function(e){var t=this._elementFactory.createLabel(Pn(e,["id"]));return t};Ut.prototype.createShape=function(e){var t=this._elementFactory.createShape(Pn(e,["id"]));return t};Ut.prototype.hasRelations=function(e,t){var n,i,r;return!(Ja(e)&&(i=_e(t,Ht({id:e.source.id})),r=_e(t,Ht({id:e.target.id})),!i||!r)||eo(e)&&(n=_e(t,Ht({id:e.labelTarget.id})),!n))};Ut.prototype.createTree=function(e){var t=this._rules,n=this,i={},r=[],a=Gl(e);function o(u,l){return t.allowed("element.copy",{element:u,elements:l})}function s(u,l){var p=_e(r,function(h){return u===h.element});if(!p){r.push({element:u,depth:l});return}p.depth<l&&(r=c(p,r),r.push({element:p.element,depth:l}))}function c(u,l){var p=l.indexOf(u);return p!==-1&&l.splice(p,1),l}return ti(a,function(u,l,p){if(eo(u))return;C(u.labels,function(f){s(f,p)});function h(f){f&&f.length&&C(f,function(d){C(d.labels,function(y){s(y,p)}),s(d,p)})}return C([u.attachers,u.incoming,u.outgoing],h),s(u,p),u.children}),e=Ye(r,function(u){return u.element}),r=Ye(r,function(u){return u.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:u.descriptor,element:u.element,elements:e}),u}),r=jt(r,function(u){return u.descriptor.priority}),e=Ye(r,function(u){return u.element}),C(r,function(u){var l=u.depth;if(!n.hasRelations(u.element,e)){Ch(u.element,e);return}if(!o(u.element,e)){Ch(u.element,e);return}i[l]||(i[l]=[]),i[l].push(u.descriptor)}),i};function g0(e){return!!e.host}function Ja(e){return!!e.waypoints}function eo(e){return!!e.labelTarget}function y0(e){return Ye(e.waypoints,function(t){return t=Rh(t),t.original&&(t.original=Rh(t.original)),t})}function Rh(e){return I({},e)}function Ch(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}var E0={__depends__:[v0,Qa,Pr,on],__init__:["copyPaste"],copyPaste:["type",Ut]};function to(e,t,n){fe(n)||(n=[n]),C(n,function(i){tr(e[i])||(t[i]=e[i])})}function b0(e,t){fe(t)||(t=[t]),C(t,function(n){e[n]&&delete e[n]})}var x0=750;function Ph(e,t,n){t.on("copyPaste.copyElement",x0,function(a){var o=a.descriptor,s=a.element,c=o.oldBusinessObject=K(s);if(o.type=s.type,to(c,o,"name"),o.di={},to(c.di,o.di,["fill","stroke","background-color","border-color","color"]),to(c.di,o,"isExpanded"),Ah(o))return o;c.default&&(o.default=c.default.id)}),t.on("moddleCopy.canCopyProperty",function(a){var o=a.parent,s=a.property,c=a.propertyName,u;if(c==="processRef"&&m(o,"bpmn:Participant")&&m(s,"bpmn:Process"))return u=e.create("bpmn:Process"),n.copyElement(s,u)});var i;function r(a,o){var s=K(a);a.default&&(i[a.default]={element:s,property:"default"}),a.host&&(K(a).attachedToRef=K(o[a.host])),i=Pn(i,bt(i,function(c,u,l){var p=u.element,h=u.property;return l===a.id&&(p[h]=s,c.push(a.id)),c},[]))}t.on("copyPaste.pasteElements",function(){i={}}),t.on("copyPaste.pasteElement",function(a){var o=a.cache,s=a.descriptor,c=s.oldBusinessObject,u;if(Ah(s)){s.businessObject=K(o[s.labelTarget]);return}u=e.create(c.$type),s.businessObject=n.copyElement(c,u),r(s,o),to(s,u,["isExpanded","name"]),b0(s,"oldBusinessObject")})}Ph.$inject=["bpmnFactory","eventBus","moddleCopy"];function Ah(e){return!!e.labelTarget}var _0=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function Ar(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var r=i.propertyNames;if(!(!r||!r.length))return jt(r,function(a){return a==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var r=i.parent,a=Ze(r)&&r.$descriptor,o=i.propertyName;if(o&&_0.indexOf(o)!==-1||o&&a&&!_e(a.properties,Ht({name:o})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var r=i.property;if(w0(r,"bpmn:ExtensionElements")&&(!r.values||!r.values.length))return!1})}Ar.$inject=["eventBus","bpmnFactory","moddle"];Ar.prototype.copyElement=function(e,t,n){var i=this;n&&!fe(n)&&(n=[n]),n=n||Cc(e.$descriptor);var r=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t});return r===!1||(fe(r)&&(n=r),C(n,function(a){var o;hn(e,a)&&(o=e.get(a));var s=i.copyProperty(o,t,a),c=i._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:s,propertyName:a});c!==!1&&Zt(s)&&t.set(a,s)})),t};Ar.prototype.copyProperty=function(e,t,n){var i=this,r=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n});if(r!==!1){if(r)return Ze(r)&&r.$type&&!r.$parent&&(r.$parent=t),r;var a=this._moddle.getPropertyDescriptor(t,n);if(!a.isReference)return a.isId?this._copyId(e,t):fe(e)?bt(e,function(o,s){return r=i.copyProperty(s,t,n),r?(r.$parent=t,o.concat(r)):o},[]):Ze(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(r=i._bpmnFactory.create(e.$type),r.$parent=t,r=i.copyElement(e,r),r):e}};Ar.prototype._copyId=function(e,t){if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function Cc(e,t){return bt(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function w0(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}var Mh={__depends__:[E0],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",Ph],moddleCopy:["type",Ar]},Dh=Math.round;function Pc(e){this._modeling=e}Pc.$inject=["modeling"];Pc.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,r=t.width||e.width,a=t.height||e.height,o=t.x||e.x,s=t.y||e.y,c=Dh(o+r/2),u=Dh(s+a/2);return i.replaceShape(e,I({},t,{x:c,y:u,width:r,height:a}),n)};var S0={__init__:["replace"],replace:["type",Pc]};function T0(e,t,n){fe(n)||(n=[n]),C(n,function(i){tr(e[i])||(t[i]=e[i])})}var R0=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function C0(e,t){var n=e&&hn(e,"collapsed")?e.collapsed:!Se(e),i;return t&&(hn(t,"collapsed")||hn(t,"isExpanded"))?i=hn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i?(e.collapsed=n,!0):!1}function Nh(e,t,n,i,r,a,o){function s(c,u,l){l=l||{};var p=u.type,h=c.businessObject;if(no(h)&&p==="bpmn:SubProcess"&&C0(c,u))return i.toggleCollapse(c),c;var f=e.create(p),d={type:p,businessObject:f},y=Cc(h.$descriptor),x=Cc(f.$descriptor,!0),D=P0(y,x);I(f,zt(u,R0));var A=se(D,function(w){return w==="eventDefinitions"?Oh(c,u.eventDefinitionType):w==="loopCharacteristics"?!Tt(f):!(hn(f,w)||w==="processRef"&&u.isExpanded===!1||w==="triggeredByEvent")});return f=n.copyElement(h,f,A),u.eventDefinitionType&&(Oh(f,u.eventDefinitionType)||(d.eventDefinitionType=u.eventDefinitionType,d.eventDefinitionAttrs=u.eventDefinitionAttrs)),m(h,"bpmn:Activity")&&(no(h)?d.isExpanded=Se(h):u&&hn(u,"isExpanded")&&(d.isExpanded=u.isExpanded),Se(h)&&!m(h,"bpmn:Task")&&d.isExpanded&&(d.width=c.width,d.height=c.height)),no(h)&&!no(f)&&(l.moveChildren=!1),m(h,"bpmn:Participant")&&(u.isExpanded===!0?f.processRef=e.create("bpmn:Process"):l.moveChildren=!1,d.width=c.width,d.height=t._getDefaultSize(f).height),a.allowed("shape.resize",{shape:f})||(d.height=t._getDefaultSize(f).height,d.width=t._getDefaultSize(f).width),f.name=h.name,ye(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&ye(f,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(f.default=h.default),u.host&&!m(h,"bpmn:BoundaryEvent")&&m(f,"bpmn:BoundaryEvent")&&(d.host=u.host),(d.type==="bpmn:DataStoreReference"||d.type==="bpmn:DataObjectReference")&&(d.x=c.x+(c.width-d.width)/2),d.di={},T0(h.di,d.di,["fill","stroke","background-color","border-color","color"]),d=r.replaceElement(c,d,l),l.select!==!1&&o.select(d),d}this.replaceElement=s}Nh.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];function no(e){return m(e,"bpmn:SubProcess")}function Oh(e,t){var n=K(e);return t&&n.get("eventDefinitions").some(function(i){return m(i,t)})}function P0(e,t){return e.filter(function(n){return t.indexOf(n)!==-1})}var Ih={__depends__:[Mh,S0,nn],bpmnReplace:["type",Nh]};function kh(e){return function(t){var n=t.target,i=K(e),r=i.eventDefinitions&&i.eventDefinitions[0],a=i.$type===n.type,o=(r&&r.$type)===n.eventDefinitionType,s=i.triggeredByEvent===n.triggeredByEvent,c=n.isExpanded===void 0||n.isExpanded===Se(i);return!a||!o||!s||!c}}var A0=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],M0=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],D0=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],N0=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],O0=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],I0=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],k0=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],L0=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],Lh=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],B0=[{label:"Data Store Reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],$0=[{label:"Data Object Reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],F0=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],j0=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],H0=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],z0=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty Pool";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function It(e,t,n,i,r,a,o){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=r,this._rules=a,this._translate=o,this.register()}It.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate"];It.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};It.prototype.getEntries=function(e){var t=e.businessObject,n=this._rules,i;if(!n.allowed("shape.replace",{element:e}))return[];var r=kh(e);return m(t,"bpmn:DataObjectReference")?this._createEntries(e,B0):m(t,"bpmn:DataStoreReference")?this._createEntries(e,$0):m(t,"bpmn:StartEvent")&&!m(t.$parent,"bpmn:SubProcess")?(i=se(A0,r),this._createEntries(e,i)):m(t,"bpmn:Participant")?(i=se(z0,function(a){return Se(t)!==a.target.isExpanded}),this._createEntries(e,i)):m(t,"bpmn:StartEvent")&&Tt(t.$parent)?(i=se(j0,function(a){var o=a.target,s=o.isInterrupting!==!1,c=K(e).isInterrupting===s;return r(a)||!r(a)&&!c}),this._createEntries(e,i)):m(t,"bpmn:StartEvent")&&!Tt(t.$parent)&&m(t.$parent,"bpmn:SubProcess")?(i=se(M0,r),this._createEntries(e,i)):m(t,"bpmn:EndEvent")?(i=se(N0,function(a){var o=a.target;return o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!m(t.$parent,"bpmn:Transaction")?!1:r(a)}),this._createEntries(e,i)):m(t,"bpmn:BoundaryEvent")?(i=se(F0,function(a){var o=a.target;if(o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!m(t.attachedToRef,"bpmn:Transaction"))return!1;var s=o.cancelActivity!==!1,c=t.cancelActivity==s;return r(a)||!r(a)&&!c}),this._createEntries(e,i)):m(t,"bpmn:IntermediateCatchEvent")||m(t,"bpmn:IntermediateThrowEvent")?(i=se(D0,r),this._createEntries(e,i)):m(t,"bpmn:Gateway")?(i=se(O0,r),this._createEntries(e,i)):m(t,"bpmn:Transaction")?(i=se(k0,r),this._createEntries(e,i)):Tt(t)&&Se(t)?(i=se(L0,r),this._createEntries(e,i)):m(t,"bpmn:SubProcess")&&Se(t)?(i=se(I0,r),this._createEntries(e,i)):m(t,"bpmn:AdHocSubProcess")&&!Se(t)?(i=se(Lh,function(a){var o=a.target,s=o.type==="bpmn:SubProcess",c=o.isExpanded===!0;return kh(e)&&(!s||c)}),this._createEntries(e,i)):m(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,H0):m(t,"bpmn:FlowNode")?(i=se(Lh,r),m(t,"bpmn:SubProcess")&&!Se(t)&&(i=se(i,function(a){return a.label!=="Sub Process (collapsed)"})),this._createEntries(e,i)):[]};It.prototype.getHeaderEntries=function(e){var t=[];return m(e,"bpmn:Activity")&&!Tt(e)&&(t=t.concat(this._getLoopEntries(e))),m(e,"bpmn:DataObjectReference")&&(t=t.concat(this._getDataObjectIsCollection(e))),m(e,"bpmn:Participant")&&(t=t.concat(this._getParticipantMultiplicity(e))),m(e,"bpmn:SubProcess")&&!m(e,"bpmn:Transaction")&&!Tt(e)&&t.push(this._getAdHocEntry(e)),t};It.prototype._createEntries=function(e,t){var n=[],i=this;return C(t,function(r){var a=i._createMenuEntry(r,e);n.push(a)}),n};It.prototype._createSequenceFlowEntries=function(e,t){var n=K(e),i=[],r=this._modeling,a=this._moddle,o=this;return C(t,function(s){switch(s.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(m(n.sourceRef,"bpmn:ExclusiveGateway")||m(n.sourceRef,"bpmn:InclusiveGateway")||m(n.sourceRef,"bpmn:ComplexGateway")||m(n.sourceRef,"bpmn:Activity"))&&i.push(o._createMenuEntry(s,e,function(){r.updateProperties(e.source,{default:n})}));break;case"replace-with-conditional-flow":!n.conditionExpression&&m(n.sourceRef,"bpmn:Activity")&&i.push(o._createMenuEntry(s,e,function(){var c=a.create("bpmn:FormalExpression",{body:""});r.updateProperties(e,{conditionExpression:c})}));break;default:if(m(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return i.push(o._createMenuEntry(s,e,function(){r.updateProperties(e,{conditionExpression:void 0})}));if((m(n.sourceRef,"bpmn:ExclusiveGateway")||m(n.sourceRef,"bpmn:InclusiveGateway")||m(n.sourceRef,"bpmn:ComplexGateway")||m(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return i.push(o._createMenuEntry(s,e,function(){r.updateProperties(e.source,{default:void 0})}))}}),i};It.prototype._createMenuEntry=function(e,t,n){var i=this._translate,r=this._bpmnReplace.replaceElement,a=function(){return r(t,e.target)},o=e.label;o&&typeof o=="function"&&(o=o(t)),n=n||a;var s={label:i(o),className:e.className,id:e.actionName,action:n};return s};It.prototype._getLoopEntries=function(e){var t=this,n=this._translate;function i(l,p){var h;p.active?h=void 0:(h=t._moddle.create(p.options.loopCharacteristics),p.options.isSequential&&(h.isSequential=p.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:h})}var r=K(e),a=r.loopCharacteristics,o,s,c;a&&(o=a.isSequential,s=a.isSequential===void 0,c=a.isSequential!==void 0&&!a.isSequential);var u=[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:c,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:o,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:s,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}];return u};It.prototype._getDataObjectIsCollection=function(e){var t=this,n=this._translate;function i(s,c){t._modeling.updateModdleProperties(e,r,{isCollection:!c.active})}var r=e.businessObject.dataObjectRef,a=r.isCollection,o=[{id:"toggle-is-collection",className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:a,action:i}];return o};It.prototype._getParticipantMultiplicity=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function r(s,c){var u=c.active,l;u||(l=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:l})}var a=e.businessObject.participantMultiplicity,o=[{id:"toggle-participant-multiplicity",className:"bpmn-icon-parallel-mi-marker",title:i("Participant Multiplicity"),active:!!a,action:r}];return o};It.prototype._getAdHocEntry=function(e){var t=this._translate,n=K(e),i=m(n,"bpmn:AdHocSubProcess"),r=this._bpmnReplace.replaceElement,a={id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(o,s){return i?r(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):r(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}};return a};var G0={__depends__:[d0,Ih],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",It]},io=Math.max,ro=Math.min,V0=20;function Bh(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function W0(e,t,n){var i=n.x,r=n.y,a={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(a.y=e.y+r,a.height=e.height-r):t.indexOf("s")!==-1&&(a.height=e.height+r),t.indexOf("e")!==-1?a.width=e.width+i:t.indexOf("w")!==-1&&(a.x=e.x+i,a.width=e.width-i),a}function U0(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function ao(e,t,n){var i=t[e],r=n.min&&n.min[e],a=n.max&&n.max[e];return ae(r)&&(i=(/top|left/.test(e)?ro:io)(i,r)),ae(a)&&(i=(/top|left/.test(e)?io:ro)(i,a)),i}function Y0(e,t){if(!t)return e;var n=ee(e);return $s({top:ao("top",n,t),right:ao("right",n,t),bottom:ao("bottom",n,t),left:ao("left",n,t)})}function q0(e,t,n,i){var r=ee(t),a={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},o=i?ee(i):a,s={top:ro(a.top,o.top),left:ro(a.left,o.left),bottom:io(a.bottom,o.bottom),right:io(a.right,o.right)};return $s(s)}function Mr(e,t){return typeof e!="undefined"?e:V0}function K0(e,t){var n,i,r,a;return typeof t=="object"?(n=Mr(t.left),i=Mr(t.right),r=Mr(t.top),a=Mr(t.bottom)):n=i=r=a=Mr(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+a}}function X0(e){return!(e.waypoints||e.type==="label")}function $h(e,t){var n;if(e.length===void 0?n=se(e.children,X0):n=e,n.length)return K0(Qe(n),t)}var oo=Math.abs;function Z0(e,t){return Bh(ee(t),ee(e))}var Q0=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],Gi=30;function so(e,t){return t=t||[],e.children.filter(function(n){m(n,"bpmn:Lane")&&(so(n,t),t.push(n))}),t}function li(e){return e.children.filter(function(t){return m(t,"bpmn:Lane")})}function Yt(e){return Ua(e,Q0)||e}function J0(e,t){var n=Yt(e),i=m(n,"bpmn:Process")?[]:[n],r=so(n,i),a=ee(e),o=ee(t),s=Z0(e,t),c=[];return r.forEach(function(u){if(u!==e){var l=0,p=s.right,h=0,f=s.left,d=ee(u);s.top&&(oo(d.bottom-a.top)<10&&(h=o.top-d.bottom),oo(d.top-a.top)<5&&(l=o.top-d.top)),s.bottom&&(oo(d.top-a.bottom)<10&&(l=o.bottom-d.top),oo(d.bottom-a.bottom)<5&&(h=o.bottom-d.bottom)),(l||p||h||f)&&c.push({shape:u,newBounds:U0(u,{top:l,right:p,bottom:h,left:f})})}}),c}function Ac(e,t,n,i,r,a,o,s,c,u,l,p){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=r,this._elementFactory=a,this._connect=o,this._create=s,this._popupMenu=c,this._canvas=u,this._rules=l,this._translate=p,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(h){var f=h.context,d=f.shape;if(!(!Li(h)||!i.isOpen(d))){var y=i.getEntries(d);y.replace&&y.replace.action.click(h,d)}})}Ac.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"];Ac.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,r=this._connect,a=this._create,o=this._popupMenu,s=this._canvas,c=this._rules,u=this._autoPlace,l=this._translate,p={};if(e.type==="label")return p;var h=e.businessObject;function f(b,_){r.start(b,_)}function d(b){n.removeElements([e])}function y(b){var _=5,M=s.getContainer(),N=t.getPad(b).html,P=M.getBoundingClientRect(),$=N.getBoundingClientRect(),z=$.top-P.top,Y=$.left-P.left,W={x:Y,y:z+$.height+_};return W}function x(b,_,M,N){typeof M!="string"&&(N=M,M=l("Append {type}",{type:b.replace(/^bpmn:/,"")}));function P(z,Y){var W=i.createShape(I({type:b},N));a.start(z,W,{source:Y})}var $=u?function(z,Y){var W=i.createShape(I({type:b},N));u.append(Y,W)}:P;return{group:"model",className:_,title:M,action:{dragstart:P,click:$}}}function D(b){return function(_,M){n.splitLane(M,b),t.open(M,!0)}}if(ye(h,["bpmn:Lane","bpmn:Participant"])&&Se(h)){var A=li(e);I(p,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:l("Add Lane above"),action:{click:function(b,_){n.addLane(_,"top")}}}}),A.length<2&&(e.height>=120&&I(p,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:l("Divide into two Lanes"),action:{click:D(2)}}}),e.height>=180&&I(p,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:l("Divide into three Lanes"),action:{click:D(3)}}})),I(p,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:l("Add Lane below"),action:{click:function(b,_){n.addLane(_,"bottom")}}}})}m(h,"bpmn:FlowNode")&&(m(h,"bpmn:EventBasedGateway")?I(p,{"append.receive-task":x("bpmn:ReceiveTask","bpmn-icon-receive-task",l("Append ReceiveTask")),"append.message-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",l("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",l("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",l("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":x("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",l("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Fh(h,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?I(p,{"append.compensation-activity":x("bpmn:Task","bpmn-icon-task",l("Append compensation activity"),{isForCompensation:!0})}):!m(h,"bpmn:EndEvent")&&!h.isForCompensation&&!Fh(h,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!Tt(h)&&I(p,{"append.end-event":x("bpmn:EndEvent","bpmn-icon-end-event-none",l("Append EndEvent")),"append.gateway":x("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",l("Append Gateway")),"append.append-task":x("bpmn:Task","bpmn-icon-task",l("Append Task")),"append.intermediate-event":x("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",l("Append Intermediate/Boundary Event"))})),o.isEmpty(e,"bpmn-replace")||I(p,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:l("Change type"),action:{click:function(b,_){var M=I(y(_),{cursor:{x:b.x,y:b.y}});o.open(_,"bpmn-replace",M)}}}}),ye(h,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&I(p,{"append.text-annotation":x("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using "+(h.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:f,dragstart:f}}}),m(h,"bpmn:TextAnnotation")&&I(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using Association"),action:{click:f,dragstart:f}}}),ye(h,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&I(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using DataInputAssociation"),action:{click:f,dragstart:f}}}),m(h,"bpmn:Group")&&I(p,{"append.text-annotation":x("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var w=c.allowed("elements.delete",{elements:[e]});return fe(w)&&(w=w[0]===e),w&&I(p,{delete:{group:"edit",className:"bpmn-icon-trash",title:l("Remove"),action:{click:d}}}),p};function Fh(e,t,n){var i=e.$instanceOf(t),r=!1,a=e.eventDefinitions||[];return C(a,function(o){o.$type===n&&(r=!0)}),i&&r}var ew={__depends__:[dh,t0,nn,Sc,Qa,G0],__init__:["contextPadProvider"],contextPadProvider:["type",Ac]},tw={horizontal:["x","width"],vertical:["y","height"]},jh=5;function _n(e){this._modeling=e,this._filters=[],this.registerFilter(function(t,n,i){var r=0,a=0,o;return C(t,function(s){s.waypoints||s.labelTarget||(r+=s[i],a+=1)}),o=Math.round(r/a),se(t,function(s){return s[i]<o+50})})}_n.$inject=["modeling"];_n.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};_n.prototype.trigger=function(e,t){var n=this._modeling,i,r;if(!(e.length<3)&&(this._setOrientation(t),r=this._filterElements(e),i=this._createGroups(r),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};_n.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,r=[].concat(e);return t.length?(C(t,function(a){r=a(r,n,i)}),r):e};_n.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,r=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var a=jt(e,i);return C(a,function(o,s){var c=n._findRange(o,i,r),u,l=t[t.length-1];l&&n._hasIntersection(l.range,c)?t[t.length-1].elements.push(o):(u={range:c,elements:[o]},t.push(u))}),t};_n.prototype._setOrientation=function(e){var t=tw[e];this._axis=t[0],this._dimension=t[1]};_n.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};_n.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+jh,max:t+n-jh}};var nw={__init__:["distributeElements"],distributeElements:["type",_n]};function Hh(e){e.registerFilter(function(t){return se(t,function(n){var i=ye(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)})})}Hh.$inject=["distributeElements"];var iw={__depends__:[nw],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",Hh]},zh="is not a registered action",rw="is already registered";function kt(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}kt.$inject=["eventBus","injector"];kt.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),a=e.get("copyPaste",!1),o=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("keyboardMove",!1),u=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),a&&i&&this.register("copy",function(){var l=i.get();a.copy(l)}),a&&this.register("paste",function(){a.paste()}),r&&this.register("stepZoom",function(l){r.stepZoom(l.value)}),o&&this.register("zoom",function(l){o.zoom(l.value)}),n&&i&&s&&this.register("removeSelection",function(){var l=i.get();if(!!l.length){var p=s.allowed("elements.delete",{elements:l}),h;p!==!1&&(fe(p)?h=p:h=l,h.length&&n.removeElements(h.slice()))}}),c&&this.register("moveCanvas",function(l){c.moveCanvas(l)}),u&&this.register("moveSelection",function(l){u.moveSelection(l.direction,l.accelerated)})};kt.prototype.trigger=function(e,t){if(!this._actions[e])throw Mc(e,zh);return this._actions[e](t)};kt.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);C(e,function(i,r){n._registerAction(r,i)})};kt.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw Mc(e,rw);this._actions[e]=t};kt.prototype.unregister=function(e){if(!this.isRegistered(e))throw Mc(e,zh);this._actions[e]=void 0};kt.prototype.getActions=function(){return Object.keys(this._actions)};kt.prototype.isRegistered=function(e){return!!this._actions[e]};function Mc(e,t){return new Error(e+" "+t)}var aw={__init__:["editorActions"],editorActions:["type",kt]};function co(e){e.invoke(kt,this)}Z(co,kt);co.$inject=["injector"];co.prototype._registerDefaultActions=function(e){kt.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),a=e.get("lassoTool",!1),o=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("distributeElements",!1),u=e.get("alignElements",!1),l=e.get("directEditing",!1),p=e.get("searchPad",!1),h=e.get("modeling",!1);t&&n&&i&&this._registerAction("selectElements",function(){var f=t.getRootElement(),d=n.filter(function(y){return y!==f});return i.select(d),d}),r&&this._registerAction("spaceTool",function(){r.toggle()}),a&&this._registerAction("lassoTool",function(){a.toggle()}),o&&this._registerAction("handTool",function(){o.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("distributeElements",function(f){var d=i.get(),y=f.type;d.length&&c.trigger(d,y)}),i&&u&&this._registerAction("alignElements",function(f){var d=i.get(),y=[],x=f.type;d.length&&(y=se(d,function(D){return!m(D,"bpmn:Lane")}),u.trigger(y,x))}),i&&h&&this._registerAction("setColor",function(f){var d=i.get();d.length&&h.setColor(d,f)}),i&&l&&this._registerAction("directEditing",function(){var f=i.get();f.length&&l.activate(f[0])}),p&&this._registerAction("find",function(){p.toggle()}),t&&h&&this._registerAction("moveToOrigin",function(){var f=t.getRootElement(),d,y;m(f,"bpmn:Collaboration")?y=n.filter(function(x){return m(x.parent,"bpmn:Collaboration")}):y=n.filter(function(x){return x!==f&&!m(x.parent,"bpmn:SubProcess")}),d=Qe(y),h.moveElements(y,{x:-d.x,y:-d.y},f)})};var ow={__depends__:[aw],editorActions:["type",co]};function Gh(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;ye(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}Gh.$inject=["eventBus"];var uo=10;function Dc(e,t,n){return n||(n="round"),Math[n](e/t)*t}var sw=1200,cw=800;function Gn(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var r=this;t.on("diagram.init",cw,function(){r.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],sw,function(a){var o=a.originalEvent;if(!(!r.active||o&&Rt(o))){var s=a.context,c=s.gridSnappingContext;c||(c=s.gridSnappingContext={}),["x","y"].forEach(function(u){var l={},p=lw(a,u,e);p&&(l.offset=p);var h=uw(a,u);h&&I(l,h),zi(a,u)||r.snapEvent(a,u,l)})}})}Gn.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);ze(e,t,i)};Gn.prototype.getGridSpacing=function(){return uo};Gn.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=Dc(e,uo);var i,r;return t&&t.min&&(i=t.min,ae(i)&&(i=Dc(i+n,uo,"ceil"),e=Math.max(e,i))),t&&t.max&&(r=t.max,ae(r)&&(r=Dc(r+n,uo,"floor"),e=Math.min(e,r))),e-=n,e};Gn.prototype.isActive=function(){return this.active};Gn.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};Gn.prototype.toggleActive=function(){this.setActive(!this.active)};Gn.$inject=["elementRegistry","eventBus","config.gridSnapping"];function uw(e,t){var n=e.context,i=n.createConstraints,r=n.resizeConstraints||{},a=n.gridSnappingContext,o=a.snapConstraints;if(o&&o[t])return o[t];o||(o=a.snapConstraints={}),o[t]||(o[t]={});var s=n.direction;i&&(lo(t)?(o.x.min=i.left,o.x.max=i.right):(o.y.min=i.top,o.y.max=i.bottom));var c=r.min,u=r.max;return c&&(lo(t)?Wh(s)?o.x.max=c.left:o.x.min=c.right:Vh(s)?o.y.max=c.top:o.y.min=c.bottom),u&&(lo(t)?Wh(s)?o.x.min=u.left:o.x.max=u.right:Vh(s)?o.y.min=u.top:o.y.max=u.bottom),o[t]}function lw(e,t,n){var i=e.context,r=e.shape,a=i.gridSnappingContext,o=a.snapLocation,s=a.snapOffset;return s&&ae(s[t])||(s||(s=a.snapOffset={}),ae(s[t])||(s[t]=0),!r)||(n.get(r.id)||(lo(t)?s[t]+=r[t]+r.width/2:s[t]+=r[t]+r.height/2),!o)||(t==="x"?/left/.test(o)?s[t]-=r.width/2:/right/.test(o)&&(s[t]+=r.width/2):/top/.test(o)?s[t]-=r.height/2:/bottom/.test(o)&&(s[t]+=r.height/2)),s[t]}function lo(e){return e==="x"}function Vh(e){return e.indexOf("n")!==-1}function Wh(e){return e.indexOf("w")!==-1}function pi(e,t){U.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var r=i.context,a=r.hints||{},o=a.autoResize;if(!!o){var s=r.shape,c=r.newBounds;Pt(o)?r.newBounds=n.snapComplex(c,o):r.newBounds=n.snapSimple(s,c)}})}pi.$inject=["eventBus","gridSnapping","modeling"];Z(pi,U);pi.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};pi.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};pi.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),r=/e/.test(t),a={};return a.width=n.snapValue(e.width,{min:e.width}),r&&(i?(a.x=n.snapValue(e.x,{max:e.x}),a.width+=n.snapValue(e.x-a.x,{min:e.x-a.x})):e.x=e.x+e.width-a.width),I(e,a),e};pi.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),r=/s/.test(t),a={};return a.height=n.snapValue(e.height,{min:e.height}),i&&(r?(a.y=n.snapValue(e.y,{max:e.y}),a.height+=n.snapValue(e.y-a.y,{min:e.y-a.y})):e.y=e.y+e.height-a.height),I(e,a),e};var pw=2e3;function Uh(e,t){e.on(["spaceTool.move","spaceTool.end"],pw,function(n){var i=n.context;if(!!i.initialized){var r=i.axis,a;r==="x"?(a=t.snapValue(n.dx),n.x=n.x+a-n.dx,n.dx=a):(a=t.snapValue(n.dy),n.y=n.y+a-n.dy,n.dy=a)}})}Uh.$inject=["eventBus","gridSnapping"];var fw={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",pi],gridSnappingSpaceToolBehavior:["type",Uh]},hw={__depends__:[fw],__init__:["gridSnapping"],gridSnapping:["type",Gn]},dw=2e3;function Yh(e,t){e.on("autoPlace",dw,function(n){var i=n.source,r=ce(i),a=n.shape,o=Mf(i,a);return["x","y"].forEach(function(s){var c={};o[s]!==r[s]&&(o[s]>r[s]?c.min=o[s]:c.max=o[s],m(a,"bpmn:TextAnnotation")&&(vw(s)?c.offset=-a.width/2:c.offset=-a.height/2),o[s]=t.snapValue(o[s],c))}),o})}Yh.$inject=["eventBus","gridSnapping"];function vw(e){return e==="x"}var mw=1750;function qh(e,t,n){t.on(["create.start","shape.move.start"],mw,function(i){var r=i.context,a=r.shape,o=e.getRootElement();if(!(!m(a,"bpmn:Participant")||!m(o,"bpmn:Process")||!o.children.length)){var s=r.createConstraints;!s||(a.width=n.snapValue(a.width,{min:a.width}),a.height=n.snapValue(a.height,{min:a.height}))}})}qh.$inject=["canvas","eventBus","gridSnapping"];var gw=3e3;function po(e,t,n){U.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],gw,function(r){var a=r.context,o=a.connection,s=a.hints||{},c=o.waypoints;s.connectionStart||s.connectionEnd||s.createElementsBehavior===!1||!yw(c)||n.updateWaypoints(o,i.snapMiddleSegments(c))})}po.$inject=["eventBus","gridSnapping","modeling"];Z(po,U);po.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=xw(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function yw(e){return e.length>3}function Ew(e){return e==="h"}function bw(e){return e==="v"}function xw(e,t,n){var i=vn(t,n),r={};return Ew(i)&&(r.y=e.snapValue(t.y)),bw(i)&&(r.x=e.snapValue(t.x)),("x"in r||"y"in r)&&(t=I({},t,r),n=I({},n,r)),[t,n]}var _w={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",Yh],gridSnappingCreateParticipantBehavior:["type",qh],gridSnappingLayoutConnectionBehavior:["type",po]},ww={__depends__:[hw,_w],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Gh]},Sw=30,Tw=30;function Dr(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var r=i.element,a=i.gfx;if(m(r,"bpmn:Lane"))return n.createParticipantHit(r,a);if(m(r,"bpmn:Participant"))return Se(r)?n.createParticipantHit(r,a):n.createDefaultHit(r,a);if(m(r,"bpmn:SubProcess"))return Se(r)?n.createSubProcessHit(r,a):n.createDefaultHit(r,a)})}Dr.$inject=["eventBus","interactionEvents"];Dr.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};Dr.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:Sw,height:e.height}),!0};Dr.prototype.createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:Tw}),!0};var Rw={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Dr]};function fo(e){e.invoke($i,this)}Z(fo,$i);fo.$inject=["injector"];fo.prototype.registerBindings=function(e,t){$i.prototype.registerBindings.call(this,e,t);function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("selectElements",function(i){var r=i.keyEvent;if(e.isKey(["a","A"],r)&&e.isCmd(r))return t.trigger("selectElements"),!0}),n("find",function(i){var r=i.keyEvent;if(e.isKey(["f","F"],r)&&e.isCmd(r))return t.trigger("find"),!0}),n("spaceTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["s","S"],r))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["l","L"],r))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["h","H"],r))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["c","C"],r))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["e","E"],r))return t.trigger("directEditing"),!0})};var Cw={__depends__:[rc],__init__:["keyboardBindings"],keyboardBindings:["type",fo]},Pw={moveSpeed:1,moveSpeedAccelerated:10},Aw=1500,Kh="left",Xh="up",Zh="right",Qh="down",Mw={ArrowLeft:Kh,Left:Kh,ArrowUp:Xh,Up:Xh,ArrowRight:Zh,Right:Zh,ArrowDown:Qh,Down:Qh},Dw={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function Jh(e,t,n,i,r){var a=this;this._config=I({},Pw,e||{}),t.addListener(Aw,function(o){var s=o.keyEvent,c=Mw[s.key];if(!!c&&!t.isCmd(s)){var u=t.isShift(s);return a.moveSelection(c,u),!0}}),this.moveSelection=function(o,s){var c=r.get();if(!!c.length){var u=this._config[s?"moveSpeedAccelerated":"moveSpeed"],l=Dw[o](u),p=i.allowed("elements.move",{shapes:c});p&&n.moveElements(c,l)}}}Jh.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];var Nw={__depends__:[rc,nn],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Jh]};function ed(e,t,n,i){e.on("element.changed",function(r){var a=r.element;(a.parent||a===t.getRootElement())&&(r.gfx=n.getGraphics(a)),!!r.gfx&&e.fire(Ul(a)+".changed",r)}),e.on("elements.changed",function(r){var a=r.elements;a.forEach(function(o){e.fire("element.changed",{element:o})}),i.updateContainments(a)}),e.on("shape.changed",function(r){i.update("shape",r.element,r.gfx)}),e.on("connection.changed",function(r){i.update("connection",r.element,r.gfx)})}ed.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var td={__init__:["changeSupport"],changeSupport:["type",ed]},nd=10;function Nr(e,t,n,i){this._dragging=i,this._rules=t;var r=this;function a(c,u){var l=c.shape,p=c.direction,h=c.resizeConstraints,f;c.delta=u,f=W0(l,p,u),c.newBounds=Y0(f,h),c.canExecute=r.canResize(c)}function o(c){var u=c.resizeConstraints,l=c.minBounds;u===void 0&&(l===void 0&&(l=r.computeMinResizeBox(c)),c.resizeConstraints={min:ee(l)})}function s(c){var u=c.shape,l=c.canExecute,p=c.newBounds;if(l){if(p=cp(p),!Ow(u,p))return;n.resizeShape(u,p)}}e.on("resize.start",function(c){o(c.context)}),e.on("resize.move",function(c){var u={x:c.dx,y:c.dy};a(c.context,u)}),e.on("resize.end",function(c){s(c.context)})}Nr.prototype.canResize=function(e){var t=this._rules,n=zt(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};Nr.prototype.activate=function(e,t,n){var i=this._dragging,r,a;if(typeof n=="string"&&(n={direction:n}),r=I({shape:t},n),a=r.direction,!a)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,id(t,a),"resize",{autoActivate:!0,cursor:Iw(a),data:{shape:t,context:r}})};Nr.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,r;return i=e.minDimensions||{width:nd,height:nd},r=$h(t,e.childrenBoxPadding),q0(n,t,i,r)};Nr.$inject=["eventBus","rules","modeling","dragging"];function Ow(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function id(e,t){var n=ce(e),i=ee(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function Iw(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var rd="djs-resizing",ad="resize-not-ok",kw=500;function od(e,t,n){function i(a){var o=a.shape,s=a.newBounds,c=a.frame;c||(c=a.frame=n.addFrame(o,t.getActiveLayer()),t.addMarker(o,rd)),s.width>5&&H(c,{x:s.x,width:s.width}),s.height>5&&H(c,{y:s.y,height:s.height}),a.canExecute?he(c).remove(ad):he(c).add(ad)}function r(a){var o=a.shape,s=a.frame;s&&Be(a.frame),t.removeMarker(o,rd)}e.on("resize.move",kw,function(a){i(a.context)}),e.on("resize.cleanup",function(a){r(a.context)})}od.$inject=["eventBus","canvas","previewSupport"];var ho=-6,vo=4,mo=20,Or="djs-resizer",Lw=["n","w","s","e","nw","ne","se","sw"];function Vn(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(a){var o=a.newSelection;r.removeResizers(),o.length===1&&C(o,pt(r.addResizer,r))}),e.on("shape.changed",function(a){var o=a.element;n.isSelected(o)&&(r.removeResizers(),r.addResizer(o))})}Vn.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(a){jn(a)&&i.activate(a,e,n)}te.bind(t,"mousedown",r),te.bind(t,"touchstart",r)};Vn.prototype._createResizer=function(e,t,n,i){var r=this._getResizersParent(),a=Bw(i),o=Q("g");he(o).add(Or),he(o).add(Or+"-"+e.id),he(o).add(Or+"-"+i),ne(r,o);var s=Q("rect");H(s,{x:-vo/2+a.x,y:-vo/2+a.y,width:vo,height:vo}),he(s).add(Or+"-visual"),ne(o,s);var c=Q("rect");return H(c,{x:-mo/2+a.x,y:-mo/2+a.y,width:mo,height:mo}),he(c).add(Or+"-hit"),ne(o,c),zs(o,t,n),o};Vn.prototype.createResizer=function(e,t){var n=id(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};Vn.prototype.addResizer=function(e){var t=this,n=this._resize;!n.canResize({shape:e})||C(Lw,function(i){t.createResizer(e,i)})};Vn.prototype.removeResizers=function(){var e=this._getResizersParent();Ts(e)};Vn.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};Vn.$inject=["eventBus","canvas","selection","resize"];function Bw(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=-ho:e.indexOf("w")!==-1&&(t.x=ho),e.indexOf("s")!==-1?t.y=-ho:e.indexOf("n")!==-1&&(t.y=ho),t}var sd={__depends__:[on,bn,Tr],__init__:["resize","resizePreview","resizeHandles"],resize:["type",Nr],resizePreview:["type",od],resizeHandles:["type",Vn]};function Nc(e,t){var n=t.create("bpmn:CategoryValue"),i=t.create("bpmn:Category",{categoryValue:[n]});return ke(e.get("rootElements"),i),K(i).$parent=e,K(n).$parent=i,n}function Ir(e,t,n,i,r,a,o){this._bpmnFactory=t,this._canvas=n,this._modeling=r,this._textRenderer=o,i.registerProvider(this),e.on("element.dblclick",function(c){s(c.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],function(c){i.isActive()&&i.complete()}),e.on(["commandStack.changed"],function(c){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(c){a.removeResizers()}),e.on("create.end",500,function(c){var u=c.context,l=u.shape,p=c.context.canExecute,h=c.isTouch;h||!p||u.hints&&u.hints.createElementsBehavior===!1||s(l)}),e.on("autoPlace.end",500,function(c){s(c.shape)});function s(c,u){(u||ye(c,["bpmn:Task","bpmn:TextAnnotation","bpmn:Group"])||Oc(c))&&i.activate(c)}}Ir.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];Ir.prototype.activate=function(e){var t=Gt(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);I(n,i);var r={};return(ye(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Oc(e))&&I(r,{centerVertically:!0}),Ii(e)&&I(r,{autoResize:!0}),m(e,"bpmn:TextAnnotation")&&I(r,{resizable:!0,autoResize:!0}),I(n,{options:r}),n}};Ir.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),r={x:i.x+i.width/2,y:i.y+i.height/2},a={x:i.x,y:i.y},o=t.zoom(),s=this._textRenderer.getDefaultStyle(),c=this._textRenderer.getExternalStyle(),u=c.fontSize*o,l=c.lineHeight,p=s.fontSize*o,h=s.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(m(e,"bpmn:Lane")||jw(e))&&(I(a,{width:i.height,height:30*o,x:i.x-i.height/2+15*o,y:r.y-30*o/2}),I(f,{fontSize:p+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px",transform:"rotate(-90deg)"})),(ye(e,["bpmn:Task","bpmn:CallActivity"])||Fw(e)||Oc(e))&&(I(a,{width:i.width,height:i.height}),I(f,{fontSize:p+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"})),$w(e)&&(I(a,{width:i.width,x:i.x}),I(f,{fontSize:p+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"}));var d=90*o,y=7*o,x=4*o;if(n.labelTarget&&(I(a,{width:d,height:i.height+y+x,x:r.x-d/2,y:i.y-y}),I(f,{fontSize:u+"px",lineHeight:l,paddingTop:y+"px",paddingBottom:x+"px"})),Ii(n)&&!$a(n)&&!tt(n)){var D=Fa(e),A=t.getAbsoluteBBox({x:D.x,y:D.y,width:0,height:0}),w=u+y+x;I(a,{width:d,height:w,x:A.x-d/2,y:A.y-w/2}),I(f,{fontSize:u+"px",lineHeight:l,paddingTop:y+"px",paddingBottom:x+"px"})}return m(e,"bpmn:TextAnnotation")&&(I(a,{width:i.width,height:i.height,minWidth:30*o,minHeight:10*o}),I(f,{textAlign:"left",paddingTop:5*o+"px",paddingBottom:7*o+"px",paddingLeft:7*o+"px",paddingRight:5*o+"px",fontSize:p+"px",lineHeight:h})),{bounds:a,style:f}};Ir.prototype.update=function(e,t,n,i){var r,a;if(m(e,"bpmn:TextAnnotation")&&(a=this._canvas.getAbsoluteBBox(e),r={x:e.x,y:e.y,width:e.width/a.width*i.width,height:e.height/a.height*i.height}),m(e,"bpmn:Group")){var o=K(e);if(!o.categoryValueRef){var s=this._canvas.getRootElement(),c=K(s).$parent,u=Nc(c,this._bpmnFactory);K(e).categoryValueRef=u}}Hw(t)&&(t=null),this._modeling.updateLabel(e,t,r)};function Oc(e){return m(e,"bpmn:SubProcess")&&!Se(e)}function $w(e){return m(e,"bpmn:SubProcess")&&Se(e)}function Fw(e){return m(e,"bpmn:Participant")&&!Se(e)}function jw(e){return m(e,"bpmn:Participant")&&Se(e)}function Hw(e){return!e||!e.trim()}var cd="djs-element-hidden",ud="djs-label-hidden";function ld(e,t,n,i){var r=this,a=t.getDefaultLayer(),o,s,c;e.on("directEditing.activate",function(u){var l=u.active;if(o=l.element.label||l.element,m(o,"bpmn:TextAnnotation")){s=t.getAbsoluteBBox(o),c=Q("g");var p=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),h=r.path=Q("path");H(h,{d:p,strokeWidth:2,stroke:zw(o)}),ne(c,h),ne(a,c),vt(c,o.x,o.y)}m(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,cd):(m(o,"bpmn:Task")||m(o,"bpmn:CallActivity")||m(o,"bpmn:SubProcess")||m(o,"bpmn:Participant"))&&t.addMarker(o,ud)}),e.on("directEditing.resize",function(u){if(m(o,"bpmn:TextAnnotation")){var l=u.height,p=u.dy,h=Math.max(o.height/s.height*(l+p),0),f=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:h,position:{mx:0,my:0}});H(r.path,{d:f})}}),e.on(["directEditing.complete","directEditing.cancel"],function(u){var l=u.active;l&&(t.removeMarker(l.element.label||l.element,cd),t.removeMarker(o,ud)),o=void 0,s=void 0,c&&(Be(c),c=void 0)})}ld.$inject=["eventBus","canvas","elementRegistry","pathMap"];function zw(e,t){var n=K(e);return n.di.get("stroke")||t||"black"}var Gw={__depends__:[td,sd,dh],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",Ir],labelEditingPreview:["type",ld]},Ic=["top","bottom","left","right"],go=10;function kc(e,t){U.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(r){var a=r.context,o=a.connection,s=o.source,c=o.target,u=a.hints||{};u.createElementsBehavior!==!1&&(n(s),n(c))}),this.postExecuted(["label.create"],function(r){var a=r.context,o=a.shape,s=a.hints||{};s.createElementsBehavior!==!1&&n(o.labelTarget)}),this.postExecuted(["elements.create"],function(r){var a=r.context,o=a.elements,s=a.hints||{};s.createElementsBehavior!==!1&&o.forEach(function(c){n(c)})});function n(r){if(!!$a(r)){var a=Uw(r);!a||i(r,a)}}function i(r,a){var o=ce(r),s=r.label,c=ce(s);if(!!s.parent){var u=ee(r),l;switch(a){case"top":l={x:o.x,y:u.top-go-s.height/2};break;case"left":l={x:u.left-go-s.width/2,y:o.y};break;case"bottom":l={x:o.x,y:u.bottom+go+s.height/2};break;case"right":l={x:u.right+go+s.width/2,y:o.y};break}var p=rn(l,c);t.moveShape(s,p)}}}Z(kc,U);kc.$inject=["eventBus","modeling"];function Vw(e){var t=e.host,n=ce(e),i=Je(n,t),r;i.indexOf("-")>=0?r=i.split("-"):r=[i];var a=Ic.filter(function(o){return r.indexOf(o)===-1});return a}function Ww(e){var t=ce(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return pd(t,i)});return n}function Uw(e){var t=ce(e.label),n=ce(e),i=pd(n,t);if(!!Yw(i)){var r=Ww(e);if(e.host){var a=Vw(e);r=r.concat(a)}var o=Ic.filter(function(s){return r.indexOf(s)===-1});if(o.indexOf(i)===-1)return o[0]}}function pd(e,t){return Je(t,e,5)}function Yw(e){return Ic.indexOf(e)!==-1}function Lc(e,t,n){U.call(this,e),this.preExecute("shape.append",function(i){var r=i.source,a=i.shape;i.position||(m(a,"bpmn:TextAnnotation")?i.position={x:r.x+r.width/2+75,y:r.y-50-a.height/2}:i.position={x:r.x+r.width+80+a.width/2,y:r.y+r.height/2})},!0)}Z(Lc,U);Lc.$inject=["eventBus","elementFactory","bpmnRules"];function Bc(e,t){e.invoke(U,this),this.postExecute("shape.move",function(n){var i=n.newParent,r=n.shape,a=se(r.incoming.concat(r.outgoing),function(o){return m(o,"bpmn:Association")});C(a,function(o){t.moveConnection(o,{x:0,y:0},i)})},!0)}Z(Bc,U);Bc.$inject=["injector","modeling"];var fd=500;function yo(e,t){t.invoke(U,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",fd,function(i){var r=i.elements;r=r.filter(function(a){var o=a.host;return hd(a,o)}),r.length===1&&r.map(function(a){return r.indexOf(a)}).forEach(function(a){var o=r[a];i.elements[a]=n.replaceShape(r[a],o)})},!0),this.preExecute("elements.move",fd,function(i){var r=i.shapes,a=i.newHost;if(r.length===1){var o=r[0];hd(o,a)&&(i.shapes=[n.replaceShape(o,a)])}},!0)}yo.$inject=["bpmnReplace","injector"];Z(yo,U);yo.prototype.replaceShape=function(e,t){var n=qw(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function qw(e){var t=K(e),n=t.eventDefinitions;return n&&n[0]}function hd(e,t){return!tt(e)&&ye(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}var Kw=2e3;function $c(e,t,n){U.call(this,e);function i(r){return se(r.attachers,function(a){return m(a,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(r){var a=r.context.source,o=r.context.target,s=i(o);m(a,"bpmn:EventBasedGateway")&&m(o,"bpmn:ReceiveTask")&&s.length>0&&n.removeElements(s)}),this.postExecute("connection.reconnect",function(r){var a=r.context.oldSource,o=r.context.newSource;m(a,"bpmn:Gateway")&&m(o,"bpmn:EventBasedGateway")&&C(o.outgoing,function(s){var c=s.target,u=i(c);m(c,"bpmn:ReceiveTask")&&u.length>0&&n.removeElements(u)})}),e.on("moddleCopy.canCopyProperty",Kw,function(r){var a=r.parent,o=r.property,s=r.propertyName,c=t.getPropertyDescriptor(a,s);c&&c.isReference&&m(o,"bpmn:RootElement")&&a.set(s,o)})}$c.$inject=["eventBus","moddle","modeling"];Z($c,U);var Xw=500;function Fc(e,t,n,i,r){n.invoke(U,this);function a(l){return ye(l,["bpmn:ReceiveTask","bpmn:SendTask"])||Zw(l,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function o(l){var p=e.getDefinitions(),h=p.get("rootElements");return!!_e(h,Ht({id:l.id}))}function s(l){if(m(l,"bpmn:ErrorEventDefinition"))return"errorRef";if(m(l,"bpmn:EscalationEventDefinition"))return"escalationRef";if(m(l,"bpmn:MessageEventDefinition"))return"messageRef";if(m(l,"bpmn:SignalEventDefinition"))return"signalRef"}function c(l){if(ye(l,["bpmn:ReceiveTask","bpmn:SendTask"]))return l.get("messageRef");var p=l.get("eventDefinitions"),h=p[0];return h.get(s(h))}function u(l,p){if(ye(l,["bpmn:ReceiveTask","bpmn:SendTask"]))return l.set("messageRef",p);var h=l.get("eventDefinitions"),f=h[0];return f.set(s(f),p)}this.executed("shape.create",function(l){var p=l.shape;if(!!a(p)){var h=K(p),f=c(h),d;f&&!o(f)&&(d=e.getDefinitions().get("rootElements"),ke(d,f),l.addedRootElement=f)}},!0),this.reverted("shape.create",function(l){var p=l.addedRootElement;if(!!p){var h=e.getDefinitions().get("rootElements");Ie(h,p)}},!0),t.on("copyPaste.copyElement",function(l){var p=l.descriptor,h=l.element;if(!!a(h)){var f=K(h),d=c(f);d&&(p.referencedRootElement=d)}}),t.on("copyPaste.pasteElement",Xw,function(l){var p=l.descriptor,h=p.businessObject;if(!!a(h)){var f=p.referencedRootElement;!f||(o(f)||(f=i.copyElement(f,r.create(f.$type))),u(h,f))}})}Fc.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];Z(Fc,U);function Zw(e,t){return fe(t)||(t=[t]),Jn(t,function(n){return Ia(e,n)})}function jc(e){e.invoke(U,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,r=n.shape;m(i,"bpmn:Lane")&&!m(r,"bpmn:Lane")&&(n.parent=Ua(i,"bpmn:Participant"))})}jc.$inject=["injector"];Z(jc,U);var Eo=1500,Qw=2e3;function dd(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Eo,function(i){var r=i.context,a=r.shape||i.shape,o=i.hover;m(o,"bpmn:Lane")&&!ye(a,["bpmn:Lane","bpmn:Participant"])&&(i.hover=Yt(o),i.hoverGfx=e.getGraphics(i.hover));var s=n.getRootElement();o!==s&&(a.labelTarget||m(a,"bpmn:Group"))&&(i.hover=s,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Eo,function(i){var r=i.hover;m(r,"bpmn:Lane")&&(i.hover=Yt(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],Eo,function(i){var r=i.context,a=i.hover,o=r.type;m(a,"bpmn:Lane")&&/reconnect/.test(o)&&(i.hover=Yt(a)||a,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],Eo,function(i){var r=i.context,a=r.start;m(a,"bpmn:Lane")&&(r.start=Yt(a)||a)}),t.on("shape.move.start",Qw,function(i){var r=i.shape;m(r,"bpmn:Lane")&&(i.shape=Yt(r)||r)})}dd.$inject=["elementRegistry","eventBus","canvas"];function Hc(e,t,n){U.call(this,e),this.preExecute("shape.create",function(i){var r=i.context,a=r.shape;if(m(a,"bpmn:DataObjectReference")&&a.type!=="label"){var o=t.create("bpmn:DataObject");a.businessObject.dataObjectRef=o}})}Hc.$inject=["eventBus","bpmnFactory","moddle"];Z(Hc,U);var zc=20,Gc=20,vd=30,bo=2e3;function Vc(e,t,n){U.call(this,t),t.on(["create.start","shape.move.start"],bo,function(r){var a=r.context,o=a.shape,s=e.getRootElement();if(!(!m(o,"bpmn:Participant")||!m(s,"bpmn:Process")||!s.children.length)){var c=s.children.filter(function(p){return!m(p,"bpmn:Group")&&!tt(p)&&!tS(p)});if(!!c.length){var u=Qe(c),l=Jw(o,u);I(o,l),a.createConstraints=eS(o,u)}}}),t.on("create.start",bo,function(r){var a=r.context,o=a.shape,s=e.getRootElement(),c=e.getGraphics(s);function u(l){l.element=s,l.gfx=c}m(o,"bpmn:Participant")&&m(s,"bpmn:Process")&&(t.on("element.hover",bo,u),t.once("create.cleanup",function(){t.off("element.hover",u)}))});function i(r){var a=r.parent,o,s=e.getRootElement();m(s,"bpmn:Collaboration")?o=s:(o=n.makeCollaboration(),r.process=a),r.parent=o}this.preExecute("shape.create",function(r){var a=r.parent,o=r.shape;m(o,"bpmn:Participant")&&m(a,"bpmn:Process")&&i(r)},!0),this.execute("shape.create",function(r){var a=r.process,o=r.shape;a&&(r.oldProcessRef=o.businessObject.processRef,o.businessObject.processRef=a.businessObject)},!0),this.revert("shape.create",function(r){var a=r.process,o=r.shape;a&&(o.businessObject.processRef=r.oldProcessRef)},!0),this.postExecute("shape.create",function(r){var a=r.process,o=r.shape;if(a){var s=a.children.slice();n.moveElements(s,{x:0,y:0},o)}},!0),this.preExecute("elements.create",bo,function(r){var a=r.elements,o=r.parent,s,c=xo(a);c&&m(o,"bpmn:Process")&&(i(r),s=xo(a),r.oldProcessRef=s.businessObject.processRef,s.businessObject.processRef=o.businessObject)},!0),this.revert("elements.create",function(r){var a=r.elements,o=r.process,s;o&&(s=xo(a),s.businessObject.processRef=r.oldProcessRef)},!0),this.postExecute("elements.create",function(r){var a=r.elements,o=r.process,s;if(o){s=xo(a);var c=o.children.slice();n.moveElements(c,{x:0,y:0},s)}},!0)}Vc.$inject=["canvas","eventBus","modeling"];Z(Vc,U);function Jw(e,t){t={width:t.width+zc*2+vd,height:t.height+Gc*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function eS(e,t){return t=ee(t),{bottom:t.top+e.height/2-Gc,left:t.right-e.width/2+zc,top:t.bottom-e.height/2+Gc,right:t.left+e.width/2-zc-vd}}function tS(e){return!!e.waypoints}function xo(e){return _e(e,function(t){return m(t,"bpmn:Participant")})}var md="__targetRef_placeholder";function Wc(e,t){U.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],gd(a)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],gd(a));function n(o,s,c){var u=o.get("dataInputAssociations");return _e(u,function(l){return l!==c&&l.targetRef===s})}function i(o,s){var c=o.get("properties"),u=_e(c,function(l){return l.name===md});return!u&&s&&(u=t.create("bpmn:Property",{name:md}),ke(c,u)),u}function r(o,s){var c=i(o);!c||n(o,c,s)||Ie(o.get("properties"),c)}function a(o){var s=o.context,c=s.connection,u=c.businessObject,l=c.target,p=l&&l.businessObject,h=s.newTarget,f=h&&h.businessObject,d=s.oldTarget||s.target,y=d&&d.businessObject,x=c.businessObject,D;y&&y!==p&&r(y,u),f&&f!==p&&r(f,u),p?(D=i(p,!0),x.targetRef=D):x.targetRef=null}}Wc.$inject=["eventBus","bpmnFactory"];Z(Wc,U);function gd(e){return function(t){var n=t.context,i=n.connection;if(m(i,"bpmn:DataInputAssociation"))return e(t)}}function _o(e){this._bpmnUpdater=e}_o.$inject=["bpmnUpdater"];_o.prototype.execute=function(e){var t=e.dataStoreBo,n=e.newSemanticParent,i=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=t.di.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};_o.prototype.revert=function(e){var t=e.dataStoreBo,n=e.oldSemanticParent,i=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};function Uc(e,t,n,i){U.call(this,i),t.registerHandler("dataStore.updateContainment",_o);function r(){return n.filter(function(s){return m(s,"bpmn:Participant")&&K(s).processRef})[0]}function a(s){return s.children.filter(function(c){return m(c,"bpmn:DataStoreReference")&&!c.labelTarget})}function o(s,c){var u=s.businessObject||s;if(c=c||r(),c){var l=c.businessObject||c;t.execute("dataStore.updateContainment",{dataStoreBo:u,newSemanticParent:l.processRef||l,newDiParent:l.di})}}this.preExecute("shape.create",function(s){var c=s.context,u=c.shape;m(u,"bpmn:DataStoreReference")&&u.type!=="label"&&(c.hints||(c.hints={}),c.hints.autoResize=!1)}),this.preExecute("elements.move",function(s){var c=s.context,u=c.shapes,l=u.filter(function(p){return m(p,"bpmn:DataStoreReference")});l.length&&(c.hints||(c.hints={}),c.hints.autoResize=u.filter(function(p){return!m(p,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(s){var c=s.context,u=c.shape,l=u.parent;m(u,"bpmn:DataStoreReference")&&u.type!=="label"&&m(l,"bpmn:Collaboration")&&o(u)}),this.postExecute("shape.move",function(s){var c=s.context,u=c.shape,l=c.oldParent,p=u.parent;if(!m(l,"bpmn:Collaboration")&&m(u,"bpmn:DataStoreReference")&&u.type!=="label"&&m(p,"bpmn:Collaboration")){var h=m(l,"bpmn:Participant")?l:iS(l,"bpmn:Participant");o(u,h)}}),this.postExecute("shape.delete",function(s){var c=s.context,u=c.shape,l=e.getRootElement();ye(u,["bpmn:Participant","bpmn:SubProcess"])&&m(l,"bpmn:Collaboration")&&a(l).filter(function(p){return nS(p,u)}).forEach(function(p){o(p)})}),this.postExecute("canvas.updateRoot",function(s){var c=s.context,u=c.oldRoot,l=c.newRoot,p=a(u);p.forEach(function(h){m(l,"bpmn:Process")&&o(h,l)})})}Uc.$inject=["canvas","commandStack","elementRegistry","eventBus"];Z(Uc,U);function nS(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function iS(e,t){for(;e.parent;){if(m(e.parent,t))return e.parent;e=e.parent}}var rS=500;function Yc(e,t,n){U.call(this,e);function i(r,a){var o=li(a),s=[],c=[];if(ti(o,function(h){return h.y>r.y?c.push(h):s.push(h),h.children}),!!o.length){var u;c.length&&s.length?u=r.height/2:u=r.height;var l,p;s.length&&(l=n.calculateAdjustments(s,"y",u,r.y-10),n.makeSpace(l.movingShapes,l.resizingShapes,{x:0,y:u},"s")),c.length&&(p=n.calculateAdjustments(c,"y",-u,r.y+r.height+10),n.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:-u},"n"))}}this.postExecuted("shape.delete",rS,function(r){var a=r.context,o=a.hints,s=a.shape,c=a.oldParent;!m(s,"bpmn:Lane")||o&&o.nested||i(s,c)})}Yc.$inject=["eventBus","modeling","spaceTool"];Z(Yc,U);var yd=500;function wo(e,t){t.invoke(U,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",yd,function(i){var r=i.elements;r.filter(function(a){var o=a.host;return Ed(a,o)}).map(function(a){return r.indexOf(a)}).forEach(function(a){i.elements[a]=n.replaceShape(r[a])})},!0),this.preExecute("elements.move",yd,function(i){var r=i.shapes,a=i.newHost;r.forEach(function(o,s){var c=o.host;Ed(o,oS(r,c)?c:a)&&(r[s]=n.replaceShape(o))})},!0)}wo.$inject=["bpmnReplace","injector"];Z(wo,U);wo.prototype.replaceShape=function(e){var t=aS(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function aS(e){var t=K(e),n=t.eventDefinitions;return n&&n[0]}function Ed(e,t){return!tt(e)&&m(e,"bpmn:BoundaryEvent")&&!t}function oS(e,t){return e.indexOf(t)!==-1}function qc(e,t,n){U.call(this,e);function i(r,a,o){var s=a.waypoints,c,u,l,p,h,f,d,y=r.outgoing.slice(),x=r.incoming.slice(),D;ae(o.width)?D=ce(o):D=o;var A=vc(s,D);if(A){if(c=s.slice(0,A.index),u=s.slice(A.index+(A.bendpoint?1:0)),!c.length||!u.length)return;l=A.bendpoint?s[A.index]:D,(c.length===1||!bd(r,c[c.length-1]))&&c.push(xd(l)),(u.length===1||!bd(r,u[0]))&&u.unshift(xd(l))}p=a.source,h=a.target,t.canConnect(p,r,a)&&(n.reconnectEnd(a,r,c||D),f=a),t.canConnect(r,h,a)&&(f?d=n.connect(r,h,{type:a.type,waypoints:u}):(n.reconnectStart(a,r,u||D),d=a));var w=[].concat(f&&se(x,function(b){return b.source===f.source})||[],d&&se(y,function(b){return b.target===d.target})||[]);w.length&&n.removeElements(w)}this.preExecute("elements.move",function(r){var a=r.newParent,o=r.shapes,s=r.delta,c=o[0];if(!(!c||!a)){a&&a.waypoints&&(r.newParent=a=a.parent);var u=ce(c),l={x:u.x+s.x,y:u.y+s.y},p=_e(a.children,function(h){var f=t.canInsert(o,h);return f&&vc(h.waypoints,l)});p&&(r.targetFlow=p,r.position=l)}},!0),this.postExecuted("elements.move",function(r){var a=r.shapes,o=r.targetFlow,s=r.position;o&&i(a[0],o,s)},!0),this.preExecute("shape.create",function(r){var a=r.parent,o=r.shape;t.canInsert(o,a)&&(r.targetFlow=a,r.parent=a.parent)},!0),this.postExecuted("shape.create",function(r){var a=r.shape,o=r.targetFlow,s=r.position;o&&i(a,o,s)},!0)}Z(qc,U);qc.$inject=["eventBus","bpmnRules","modeling"];function bd(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function xd(e){return I({},e)}function Kc(e,t){U.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,r=i.source,a=i.target,o=a.incoming.slice();i.hints&&i.hints.createElementsBehavior===!1||m(r,"bpmn:EventBasedGateway")&&a.incoming.length&&o.filter(Xc).forEach(function(s){t.removeConnection(s)})}),this.preExecuted("shape.replace",function(n){var i=n.context.newShape,r,a;!m(i,"bpmn:EventBasedGateway")||(r=i.outgoing.filter(Xc).map(function(o){return o.target}),a=r.reduce(function(o,s){var c=s.incoming.filter(Xc);return o.concat(c)},[]),a.forEach(function(o){o.source!==i&&t.removeConnection(o)}))})}Kc.$inject=["eventBus","modeling"];Z(Kc,U);function Xc(e){return m(e,"bpmn:SequenceFlow")}var sS=2e3;function Zc(e,t,n,i,r,a){r.invoke(U,this);function o(){var p=t.getRootElement(),h=K(p);return h.$parent}function s(p){var h=K(p),f=h.categoryValueRef;if(!!f){var d=f.$parent;!f||(Ie(d.categoryValue,f),d&&!d.categoryValue.length&&c(d))}}function c(p){var h=o();Ie(h.get("rootElements"),p)}function u(){return n.filter(function(p){return m(p,"bpmn:Group")})}function l(p,h){return p.some(function(f){var d=K(f);return d.categoryValueRef&&d.categoryValueRef===h})}this.executed("shape.delete",function(p){var h=p.context,f=h.shape;if(m(f,"bpmn:Group")){var d=K(f),y=d.categoryValueRef,x=u();l(x,y)||s(f)}}),this.reverted("shape.delete",function(p){var h=p.context,f=h.shape;if(m(f,"bpmn:Group")){var d=K(f),y=d.categoryValueRef,x=o(),D=y?y.$parent:null;ke(D.get("categoryValue"),y),ke(x.get("rootElements"),D)}}),this.execute("shape.create",function(p){var h=p.context,f=h.shape,d=K(f);if(m(d,"bpmn:Group")&&!d.categoryValueRef){var y=o(),x=Nc(y,e);d.categoryValueRef=x}}),this.revert("shape.create",function(p){var h=p.context,f=h.shape;m(f,"bpmn:Group")&&(s(f),delete K(f).categoryValueRef)}),i.on("moddleCopy.canCopyProperty",sS,function(p){var h=p.property,f;if(m(h,"bpmn:CategoryValue"))return f=Nc(o(),e),a.copyElement(h,f)})}Zc.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"];Z(Zc,U);function Qc(e,t,n,i){var r,a,o,s,c;return r=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),r==0?null:(a=e.y-n.y,o=e.x-n.x,c=(i.x-n.x)*a-(i.y-n.y)*o,s=c/r,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function _d(e){function t(i,r,a){var o={x:a.x,y:a.y-50},s={x:a.x-50,y:a.y},c=Qc(i,r,a,o),u=Qc(i,r,a,s),l;c&&u?wd(c,a)>wd(u,a)?l=u:l=c:l=c||u,i.original=l}function n(i){var r=i.waypoints;t(r[0],r[1],ce(i.source)),t(r[r.length-1],r[r.length-2],ce(i.target))}e.on("bpmnElement.added",function(i){var r=i.element;r.waypoints&&n(r)})}_d.$inject=["eventBus"];function wd(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Jc(e){U.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=K(n.context.shape);ye(i,t)&&!i.di.get("isHorizontal")&&i.di.set("isHorizontal",!0)})}Jc.$inject=["eventBus"];Z(Jc,U);function Sd(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function Td(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function cS(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function uS(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],r=i[0].n*t[0]+i[1].n*t[1],a=i[0].lambda*t[0]+i[1].lambda*t[1];return-r/a}function Rd(e,t){var n=t[0],i=t[1],r={x:i.x-n.x,y:i.y-n.y},a=uS([n.x,n.y],[r.x,r.y],[e.x,e.y]);return{x:n.x+a*r.x,y:n.y+a*r.y}}function lS(e,t){var n=Rd(e,t),i={x:n.x-e.x,y:n.y-e.y};return Sd(i)}function So(e,t){return Sd({x:e.x-t.x,y:e.y-t.y})}var Cd=Math.sqrt,Pd=Math.min,pS=Math.max,Ad=Math.abs;function Md(e){return Math.pow(e,2)}function kr(e,t){return Cd(Md(e.x-t.x)+Md(e.y-t.y))}function fS(e,t){var n=0,i,r,a,o,s,c,u,l,p,h,f;for(n=0;n<t.length-1;n++){if(i=t[n],r=t[n+1],Nd(i,r)?u=[i]:(a=kr(e,i),o=kr(e,r),c=Pd(a,o),u=hS(i,r,e,c)),u.length<1)throw new Error("expected between [1, 2] circle -> line intersections");u.length===1&&(l={type:"bendpoint",position:u[0],segmentIndex:n,bendpointIndex:Nd(i,u[0])?n:n+1}),u.length===2&&(s=vS(u[0],u[1]),l={type:"segment",position:s,segmentIndex:n,relativeLocation:kr(i,s)/kr(i,r)}),p=kr(l.position,e),(!f||h>p)&&(f=l,h=p)}return f}function hS(e,t,n,i){var r=t.x-e.x,a=t.y-e.y,o=n.x-e.x,s=n.y-e.y,c=r*r+a*a,u=r*o+a*s,l=o*o+s*s-i*i,p=u/c,h=l/c,f=p*p-h;if(f<0&&f>-1e-6&&(f=0),f<0)return[];var d=Cd(f),y=-p+d,x=-p-d,D={x:e.x-r*y,y:e.y-a*y};if(f===0)return[D];var A={x:e.x-r*x,y:e.y-a*x};return[D,A].filter(function(w){return dS(w,e,t)})}function dS(e,t,n){return Dd(e.x,t.x,n.x)&&Dd(e.y,t.y,n.y)}function Dd(e,t,n){return e>=Pd(t,n)-To&&e<=pS(t,n)+To}function vS(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var To=.1;function Nd(e,t){return Ad(e.x-t.x)<=To&&Ad(e.y-t.y)<=To}function mS(e,t,n,i){var r=n.segmentIndex,a=t.length-e.length;if(i.segmentMove){var o=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return r===o?s:r>=s?r+a<s?s:r+a:r}if(i.bendpointMove){var c=i.bendpointMove.insert,u=i.bendpointMove.bendpointIndex,l;if(a===0)return r;if(r>=u&&(l=c?r+1:r-1),r<u&&(l=r,c&&n.type!=="bendpoint"&&u-1===r)){var p=Od(t,u);p<n.relativeLocation&&l++}return l}return a===0?r:i.connectionStart?r===0?0:null:i.connectionEnd&&r===e.length-2?t.length-2:null}function gS(e,t,n,i){var r=0,a=0,o=yS(e),s=fS(o,n),c=s.segmentIndex,u=mS(n,t,s,i);if(u===null)return{x:r,y:a};if(u<0||u>t.length-2)return{x:r,y:a};var l=Id(n,c),p=Id(t,u),h=s.position,f=bS(l,h),d=ES(l,p);if(s.type==="bendpoint"){var y=t.length-n.length,x=s.bendpointIndex,D=n[x];if(t.indexOf(D)!==-1)return{x:r,y:a};if(y===0){var A=t[x];return{x:A.x-s.position.x,y:A.y-s.position.y}}y<0&&x!==0&&x<n.length-1&&(f=Od(n,x))}var w={x:(p[1].x-p[0].x)*f+p[0].x,y:(p[1].y-p[0].y)*f+p[0].y},b=cS({x:o.x-h.x,y:o.y-h.y},d);return r=w.x+b.x-o.x,a=w.y+b.y-o.y,kn({x:r,y:a})}function Od(e,t){var n=So(e[t-1],e[t]),i=So(e[t],e[t+1]),r=n/(n+i);return r}function yS(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function ES(e,t){var n=Td(e),i=Td(t);return i-n}function Id(e,t){return[e[t],e[t+1]]}function bS(e,t){var n=So(e[0],e[1]),i=So(e[0],t);return n===0?0:i/n}function Lr(e,t,n){var i=Er(t),r=Er(n),a=rn(e,i),o={x:a.x*(n.width/t.width),y:a.y*(n.height/t.height)};return kn({x:r.x+o.x,y:r.y+o.y})}function kd(e,t,n){var i=Er(e),r=Er(t),a=Er(n),o=rn(e,i),s=rn(i,r),c=xS(i,t,n);if(c)return c;var u={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},l={x:a.x+u.x,y:a.y+u.y};return kn({x:l.x+o.x-e.x,y:l.y+o.y-e.y})}function xS(e,t,n){var i=ee(t),r=ee(n);if(_S(i,r))return null;var a=Je(t,e),o,s,c;if(a==="top")o={x:0,y:r.bottom-i.bottom};else if(a==="bottom")o={x:0,y:r.top-i.top};else if(a==="right")o={x:r.left-i.left,y:0};else if(a==="left")o={x:r.right-i.right,y:0};else return null;return s={x:e.x+o.x,y:e.y+o.y},c=Je(n,s),c!==a?null:o}function _S(e,t){return wS(e,t)||SS(e,t)}function wS(e,t){return e.right!==t.right&&e.left!==t.left}function SS(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var TS={width:90,height:20},Ld="name",Bd="text";function eu(e,t,n,i){U.call(this,e),this.postExecute("element.updateProperties",function(a){var o=a.context,s=o.element,c=o.properties;if(Ld in c&&t.updateLabel(s,c[Ld]),Bd in c&&m(s,"bpmn:TextAnnotation")){var u=i.getTextAnnotationBounds({x:s.x,y:s.y,width:s.width,height:s.height},c[Bd]||"");t.updateLabel(s,c.text,u)}}),this.postExecute(["shape.create","connection.create"],function(a){var o=a.context,s=o.hints||{};if(s.createElementsBehavior!==!1){var c=o.shape||o.connection,u=c.businessObject;if(!(tt(c)||!Ii(c))&&!!Gt(c)){var l=Fa(c),p=i.getExternalLabelBounds(TS,Gt(c));t.createLabel(c,l,{id:u.id+"_label",businessObject:u,width:p.width,height:p.height})}}}),this.postExecute("shape.delete",function(a){var o=a.context,s=o.labelTarget,c=o.hints||{};s&&c.unsetLabel!==!1&&t.updateLabel(s,null,null,{removeShape:!1})}),this.postExecute(["label.create"],function(a){var o=a.context,s=o.shape,c,u;!s.labelTarget||!m(s.labelTarget||s,"bpmn:BaseElement")||(c=s.businessObject,u=c.di,u.label||(u.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),I(u.label.bounds,{x:s.x,y:s.y,width:s.width,height:s.height}))});function r(a){var o=a.context,s=o.connection,c=s.label,u=I({},o.hints),l=o.newWaypoints||s.waypoints,p=o.oldWaypoints;return typeof u.startChanged=="undefined"&&(u.startChanged=!!u.connectionStart),typeof u.endChanged=="undefined"&&(u.endChanged=!!u.connectionEnd),gS(c,l,p,u)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(a){var o=a.context,s=o.hints||{};if(s.labelBehavior!==!1){var c=o.connection,u=c.label,l;!u||!u.parent||(l=r(a),t.moveShape(u,l))}}),this.postExecute(["shape.replace"],function(a){var o=a.context,s=o.newShape,c=o.oldShape,u=K(s);u&&Ii(u)&&c.label&&s.label&&(s.label.x=c.label.x,s.label.y=c.label.y)}),this.postExecute("shape.resize",function(a){var o=a.context,s=o.shape,c=o.newBounds,u=o.oldBounds;if($a(s)){var l=s.label,p=ce(l),h=PS(u),f=CS(p,h),d=RS(f,u,c);t.moveShape(l,d)}})}Z(eu,U);eu.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function RS(e,t,n){var i=Lr(e,t,n);return kn(rn(i,e))}function CS(e,t){if(!!t.length){var n=AS(e,t);return Rd(e,n)}}function PS(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function AS(e,t){var n=t.map(function(r){return{line:r,distance:lS(e,r)}}),i=jt(n,"distance");return i[0].line}function Ro(e,t,n){var i=Po(e),r=Fd(i,t),a=i[0];return r.length?r[r.length-1]:Lr(a.original||a,n,t)}function Co(e,t,n){var i=Po(e),r=Fd(i,t),a=i[i.length-1];return r.length?r[0]:Lr(a.original||a,n,t)}function tu(e,t,n){var i=Po(e),r=$d(t,n),a=i[0];return Lr(a.original||a,r,t)}function nu(e,t,n){var i=Po(e),r=$d(t,n),a=i[i.length-1];return Lr(a.original||a,r,t)}function $d(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Po(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Fd(e,t){var n=Ye(e,DS);return se(n,function(i){return MS(i,t)})}function MS(e,t){return Je(t,e,1)==="intersect"}function DS(e){return e.original||e}function iu(e,t){U.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,r=n.newShape;if(!!NS(i,r)){var a=OS(i);a.incoming.forEach(function(o){var s=Co(o,r,i);t.reconnectEnd(o,r,s)}),a.outgoing.forEach(function(o){var s=Ro(o,r,i);t.reconnectStart(o,r,s)})}},!0)}iu.$inject=["eventBus","modeling"];Z(iu,U);function NS(e,t){return m(e,"bpmn:Participant")&&Se(e)&&m(t,"bpmn:Participant")&&!Se(t)}function OS(e){var t=ma([e],!1),n=[],i=[];return t.forEach(function(r){r!==e&&(r.incoming.forEach(function(a){m(a,"bpmn:MessageFlow")&&n.push(a)}),r.outgoing.forEach(function(a){m(a,"bpmn:MessageFlow")&&i.push(a)}))},[]),{incoming:n,outgoing:i}}var IS="flow elements must be children of pools/participants";function jd(e,t,n){function i(r,a,o){t.add({position:{x:r.x+5,y:r.y+5},type:"error",timeout:o||2e3,html:"<div>"+a+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(r){var a=r.context,o=a.shape,s=a.target;m(s,"bpmn:Collaboration")&&m(o,"bpmn:FlowNode")&&i(r,n(IS))})}jd.$inject=["eventBus","tooltips","translate"];function ru(e,t,n,i){U.call(this,e);var r=i.get("dragging",!1);function a(c){var u=c.source,l=c.target,p=c.parent;if(!!p){var h,f;m(c,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(u,l)||(f=!0),n.canConnectMessageFlow(u,l)&&(h="bpmn:MessageFlow")),m(c,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(u,l)||(f=!0),n.canConnectSequenceFlow(u,l)&&(h="bpmn:SequenceFlow")),m(c,"bpmn:Association")&&!n.canConnectAssociation(u,l)&&(f=!0),f&&t.removeConnection(c),h&&t.connect(u,l,{type:h,waypoints:c.waypoints.slice()})}}function o(c){var u=c.context,l=u.connection,p=u.newSource||l.source,h=u.newTarget||l.target,f,d;f=n.canConnect(p,h),!(!f||f.type===l.type)&&(d=t.connect(p,h,{type:f.type,waypoints:l.waypoints.slice()}),t.removeConnection(l),u.connection=d,r&&s(l,d))}function s(c,u){var l=r.context(),p=l&&l.payload.previousSelection,h;!p||!p.length||(h=p.indexOf(c),h!==-1&&p.splice(h,1,u))}this.postExecuted("elements.move",function(c){var u=c.closure,l=u.allConnections;C(l,a)},!0),this.preExecute("connection.reconnect",o),this.postExecuted("element.updateProperties",function(c){var u=c.context,l=u.properties,p=u.element,h=p.businessObject,f;l.default&&(f=_e(p.outgoing,Ht({id:p.businessObject.default.id})),f&&t.updateProperties(f,{conditionExpression:void 0})),l.conditionExpression&&h.sourceRef.default===h&&t.updateProperties(p.source,{default:void 0})})}Z(ru,U);ru.$inject=["eventBus","modeling","bpmnRules","injector"];function au(e,t){U.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,r=i.parent;m(i,"bpmn:Participant")&&(n.collaborationRoot=r)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}au.$inject=["eventBus","modeling"];Z(au,U);function Ao(e,t,n,i,r,a){i.invoke(U,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=a,this.postExecuted(["elements.create"],500,function(o){var s=o.context,c=s.parent,u=s.elements,l=t.canReplace(u,c);l&&this.replaceElements(u,l.replacements)},this),this.postExecuted(["elements.move"],500,function(o){var s=o.context,c=s.newParent,u=s.newHost,l=[];C(s.closure.topLevel,function(h){Tt(h)?l=l.concat(h.children):l=l.concat(h)}),l.length===1&&u&&(c=u);var p=t.canReplace(l,c);p&&this.replaceElements(l,p.replacements,u)},this),this.postExecute(["shape.replace"],1500,function(o){var s=o.context,c=s.oldShape,u=s.newShape,l=c.attachers,p;l&&l.length&&(p=t.canReplace(l,u),this.replaceElements(l,p.replacements))},this),this.postExecuted(["shape.replace"],1500,function(o){var s=o.context,c=s.oldShape,u=s.newShape;r.unclaimId(c.businessObject.id,c.businessObject),r.updateProperties(u,{id:c.id})})}Z(Ao,U);Ao.prototype.replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,r=this._selection;C(t,function(a){var o={type:a.newElementType},s=n.get(a.oldElementId),c=e.indexOf(s);e[c]=i.replaceElement(s,o,{select:!1})}),t&&r.select(e)};Ao.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var kS=1500,fi={width:300,height:60},Br={width:300,height:150},Hd={width:140,height:120},zd={width:50,height:30};function Gd(e){e.on("resize.start",kS,function(t){var n=t.context,i=n.shape,r=n.direction,a=n.balanced;(m(i,"bpmn:Lane")||m(i,"bpmn:Participant"))&&(n.resizeConstraints=zS(i,r,a)),m(i,"bpmn:Participant")&&(n.minDimensions=Br),m(i,"bpmn:SubProcess")&&Se(i)&&(n.minDimensions=Hd),m(i,"bpmn:TextAnnotation")&&(n.minDimensions=zd)})}Gd.$inject=["eventBus"];var Mo=Math.abs,LS=Math.min,BS=Math.max;function Vd(e,t,n,i){var r=e[t];e[t]=r===void 0?n:i(n,r)}function Do(e,t,n){return Vd(e,t,n,LS)}function No(e,t,n){return Vd(e,t,n,BS)}var $S=20,FS=50,jS=20,HS=20;function zS(e,t,n){var i=Yt(e),r=!0,a=!0,o=so(i,[i]),s=ee(e),c={},u={};/e/.test(t)?u.right=s.left+fi.width:/w/.test(t)&&(u.left=s.right-fi.width),o.forEach(function(p){var h=ee(p);/n/.test(t)&&(h.top<s.top-10&&(r=!1),n&&Mo(s.top-h.bottom)<10&&No(c,"top",h.top+fi.height),Mo(s.top-h.top)<5&&Do(u,"top",h.bottom-fi.height)),/s/.test(t)&&(h.bottom>s.bottom+10&&(a=!1),n&&Mo(s.bottom-h.top)<10&&Do(c,"bottom",h.bottom-fi.height),Mo(s.bottom-h.bottom)<5&&No(u,"bottom",h.top+fi.height))});var l=i.children.filter(function(p){return!p.hidden&&!p.waypoints&&(m(p,"bpmn:FlowElement")||m(p,"bpmn:Artifact"))});return l.forEach(function(p){var h=ee(p);r&&/n/.test(t)&&Do(u,"top",h.top-jS),/e/.test(t)&&No(u,"right",h.right+$S),a&&/s/.test(t)&&No(u,"bottom",h.bottom+HS),/w/.test(t)&&Do(u,"left",h.left-FS)}),{min:u,max:c}}var Wd=1001;function Ud(e,t){e.on("resize.start",Wd+500,function(n){var i=n.context,r=i.shape;(m(r,"bpmn:Lane")||m(r,"bpmn:Participant"))&&(i.balanced=!Li(n))}),e.on("resize.end",Wd,function(n){var i=n.context,r=i.shape,a=i.canExecute,o=i.newBounds;if(m(r,"bpmn:Lane")||m(r,"bpmn:Participant"))return a&&(o=cp(o),t.resizeLane(r,o,i.balanced)),!1})}Ud.$inject=["eventBus","modeling"];function ou(e,t,n){U.call(this,e),this.preExecute("shape.delete",function(i){var r=i.context.shape;if(!(r.incoming.length!==1||r.outgoing.length!==1)){var a=r.incoming[0],o=r.outgoing[0];if(!(!m(a,"bpmn:SequenceFlow")||!m(o,"bpmn:SequenceFlow"))&&t.canConnect(a.source,o.target,a)){var s=GS(a.waypoints,o.waypoints);n.reconnectEnd(a,o.target,s)}}})}Z(ou,U);ou.$inject=["eventBus","bpmnRules","modeling"];function Vi(e){return e.original||e}function GS(e,t){var n=Qc(Vi(e[e.length-2]),Vi(e[e.length-1]),Vi(t[1]),Vi(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[Vi(e[0]),Vi(t[t.length-1])]}var VS=Math.max;function Yd(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,r=t.start,a={};return C(n,function(o){var s=o.id;m(o,"bpmn:Participant")&&(WS(i)?a[s]=Br:a[s]={width:Br.width,height:US(o,r)}),m(o,"bpmn:SubProcess")&&Se(o)&&(a[s]=Hd),m(o,"bpmn:TextAnnotation")&&(a[s]=zd)}),a})}Yd.$inject=["eventBus"];function WS(e){return e==="x"}function US(e,t){var n;return YS(e)?(n=qS(e,t),VS(Br.height,n)):Br.height}function YS(e){return!!li(e).length}function qS(e,t){var n=li(e),i;return i=qd(n,t),e.height-i.height+fi.height}function qd(e,t){var n,i,r;for(n=0;n<e.length;n++)if(i=e[n],t>=i.y&&t<=i.y+i.height)return r=li(i),r.length?qd(r,t):i}function su(e,t){e.invoke(U,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,r=n.context.newShape;if(!(!m(r,"bpmn:SubProcess")||!m(i,"bpmn:Task")||!Se(r))){var a=KS(r);t.createShape({type:"bpmn:StartEvent"},a,r)}})}su.$inject=["injector","modeling"];Z(su,U);function KS(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}var cu=500;function uu(e,t,n,i){U.call(this,e);function r(s){s.length&&s.forEach(function(c){c.type==="label"&&!c.businessObject.name&&(c.hidden=!0)})}function a(s,c){var u=s.children,l=c,p,h;return p=XS(u).concat([s]),h=$h(p),h?(l.width=Math.max(h.width,l.width),l.height=Math.max(h.height,l.height),l.x=h.x+(h.width-l.width)/2,l.y=h.y+(h.height-l.height)/2):(l.x=s.x+(s.width-l.width)/2,l.y=s.y+(s.height-l.height)/2),l}function o(s,c){return{x:s.x+(s.width-c.width)/2,y:s.y+(s.height-c.height)/2,width:c.width,height:c.height}}this.executed(["shape.toggleCollapse"],cu,function(s){var c=s.context,u=c.shape;!m(u,"bpmn:SubProcess")||(u.collapsed?K(u).di.isExpanded=!1:(r(u.children),K(u).di.isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],cu,function(s){var c=s.context,u=c.shape;u.collapsed?K(u).di.isExpanded=!1:K(u).di.isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],cu,function(s){var c=s.context.shape,u=t._getDefaultSize(c),l;c.collapsed?l=o(c,u):l=a(c,u),n.resizeShape(c,l,null,{autoResize:c.collapsed?!1:"nwse"})})}Z(uu,U);uu.$inject=["eventBus","elementFactory","modeling"];function XS(e){return e.filter(function(t){return!t.hidden})}function lu(e,t,n,i){t.invoke(U,this),this.preExecute("shape.delete",function(r){var a=r.context,o=a.shape,s=o.businessObject;tt(o)||(m(o,"bpmn:Participant")&&Se(o)&&n.ids.unclaim(s.processRef.id),i.unclaimId(s.id,s))}),this.preExecute("connection.delete",function(r){var a=r.context,o=a.connection,s=o.businessObject;i.unclaimId(s.id,s)}),this.preExecute("canvas.updateRoot",function(){var r=e.getRootElement(),a=r.businessObject;n.ids.unclaim(a.id)})}Z(lu,U);lu.$inject=["canvas","injector","moddle","modeling"];var ZS=500,QS=5e3;function pu(e,t,n){U.call(this,e);var i;function r(){return i=i||new JS,i.enter(),i}function a(){if(!i)throw new Error(n("out of bounds release"));return i}function o(){if(!i)throw new Error(n("out of bounds release"));var c=i.leave();return c&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),c}var s=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(s,QS,function(c){r()}),this.postExecuted(s,ZS,function(c){o()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(c){var u=c.context,l=u.shape,p=a();l.labelTarget||(m(l,"bpmn:Lane")&&p.addLane(l),m(l,"bpmn:FlowNode")&&p.addFlowNode(l))})}pu.$inject=["eventBus","modeling","translate"];Z(pu,U);function JS(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function fu(e,t){U.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,r=i.connection,a=r.source;e1(r,a)&&t.updateProperties(a,{default:null})})}Z(fu,U);fu.$inject=["eventBus","modeling"];function e1(e,t){if(!m(e,"bpmn:SequenceFlow"))return!1;var n=K(t),i=K(e);return n.get("default")===i}var t1={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",kc],appendBehavior:["type",Lc],associationBehavior:["type",Bc],attachEventBehavior:["type",yo],boundaryEventBehavior:["type",$c],rootElementReferenceBehavior:["type",Fc],createBehavior:["type",jc],fixHoverBehavior:["type",dd],createDataObjectBehavior:["type",Hc],createParticipantBehavior:["type",Vc],dataInputAssociationBehavior:["type",Wc],dataStoreBehavior:["type",Uc],deleteLaneBehavior:["type",Yc],detachEventBehavior:["type",wo],dropOnFlowBehavior:["type",qc],eventBasedGatewayBehavior:["type",Kc],groupBehavior:["type",Zc],importDockingFix:["type",_d],isHorizontalFix:["type",Jc],labelBehavior:["type",eu],messageFlowBehavior:["type",iu],modelingFeedback:["type",jd],replaceConnectionBehavior:["type",ru],removeParticipantBehavior:["type",au],replaceElementBehaviour:["type",Ao],resizeBehavior:["type",Gd],resizeLaneBehavior:["type",Ud],removeElementBehavior:["type",ou],toggleElementCollapseBehaviour:["type",uu],spaceToolBehavior:["type",Yd],subProcessStartEventBehavior:["type",su],unclaimIdBehavior:["type",lu],updateFlowNodeRefsBehavior:["type",pu],unsetDefaultFlowBehavior:["type",fu]};function Kd(e,t){var n=Je(e,t,-15);return n!=="intersect"?n:null}function nt(e){zn.call(this,e)}Z(nt,zn);nt.$inject=["eventBus"];nt.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return n1(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},r=i.targetParent,a=i.targetAttach;if(a)return!1;r&&(n.parent=r);try{return Io(t,n)}finally{r&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return Io(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return av(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return Oo(i)&&!ko(t,i)?!1:yi(t,function(r){return Oo(r)?Io(r.source,r.target,r):r.host?$r(r,r.host,null,n):yu(r,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return $r(n,t,null,i)||iv(n,t,i)||rv(n,t)||ko(n,t)}),this.addRule("shape.create",function(e){return yu(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return $r(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return uv(n,t)})};nt.prototype.canConnectMessageFlow=sv;nt.prototype.canConnectSequenceFlow=cv;nt.prototype.canConnectDataAssociation=Eu;nt.prototype.canConnectAssociation=ov;nt.prototype.canMove=rv;nt.prototype.canAttach=$r;nt.prototype.canReplace=iv;nt.prototype.canDrop=Ui;nt.prototype.canInsert=ko;nt.prototype.canCreate=yu;nt.prototype.canConnect=Io;nt.prototype.canResize=av;nt.prototype.canCopy=uv;function n1(e){return hu(e)?null:ye(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function hu(e){return!e||tt(e)}function i1(e,t){return e===t}function Xd(e){do{if(m(e,"bpmn:Process"))return K(e);if(m(e,"bpmn:Participant"))return K(e).processRef||K(e)}while(e=e.parent)}function du(e){return m(e,"bpmn:TextAnnotation")}function vu(e){return m(e,"bpmn:Group")&&!e.labelTarget}function mu(e){return m(e,"bpmn:BoundaryEvent")&&sn(e,"bpmn:CompensateEventDefinition")}function Wi(e){return K(e).isForCompensation}function r1(e,t){var n=Xd(e),i=Xd(t);return n===i}function a1(e){return m(e,"bpmn:InteractionNode")&&!m(e,"bpmn:BoundaryEvent")&&(!m(e,"bpmn:Event")||m(e,"bpmn:ThrowEvent")&&Qd(e,"bpmn:MessageEventDefinition"))}function o1(e){return m(e,"bpmn:InteractionNode")&&!Wi(e)&&(!m(e,"bpmn:Event")||m(e,"bpmn:CatchEvent")&&Qd(e,"bpmn:MessageEventDefinition"))&&!(m(e,"bpmn:BoundaryEvent")&&!sn(e,"bpmn:MessageEventDefinition"))}function Zd(e){for(var t=e;t=t.parent;){if(m(t,"bpmn:FlowElementsContainer"))return K(t);if(m(t,"bpmn:Participant"))return K(t).processRef}return null}function s1(e,t){var n=Zd(e),i=Zd(t);return n===i}function sn(e,t){var n=K(e);return!!_e(n.eventDefinitions||[],function(i){return m(i,t)})}function Qd(e,t){var n=K(e);return(n.eventDefinitions||[]).every(function(i){return m(i,t)})}function c1(e){return m(e,"bpmn:FlowNode")&&!m(e,"bpmn:EndEvent")&&!Tt(e)&&!(m(e,"bpmn:IntermediateThrowEvent")&&sn(e,"bpmn:LinkEventDefinition"))&&!mu(e)&&!Wi(e)}function u1(e){return m(e,"bpmn:FlowNode")&&!m(e,"bpmn:StartEvent")&&!m(e,"bpmn:BoundaryEvent")&&!Tt(e)&&!(m(e,"bpmn:IntermediateCatchEvent")&&sn(e,"bpmn:LinkEventDefinition"))&&!Wi(e)}function Jd(e){return m(e,"bpmn:ReceiveTask")||m(e,"bpmn:IntermediateCatchEvent")&&(sn(e,"bpmn:MessageEventDefinition")||sn(e,"bpmn:TimerEventDefinition")||sn(e,"bpmn:ConditionalEventDefinition")||sn(e,"bpmn:SignalEventDefinition"))}function Oo(e){return e.waypoints}function l1(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function gu(e,t){var n=l1(t);return n.indexOf(e)!==-1}function Io(e,t,n){if(hu(e)||hu(t))return null;if(!m(n,"bpmn:DataAssociation")){if(sv(e,t))return{type:"bpmn:MessageFlow"};if(cv(e,t))return{type:"bpmn:SequenceFlow"}}var i=Eu(e,t);return i||(mu(e)&&Wi(t)?{type:"bpmn:Association",associationDirection:"One"}:ov(e,t)?{type:"bpmn:Association"}:!1)}function Ui(e,t,n){return tt(e)||vu(e)?!0:m(t,"bpmn:Participant")&&!Se(t)?!1:m(e,"bpmn:Participant")?m(t,"bpmn:Process")||m(t,"bpmn:Collaboration"):ye(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:m(e,"bpmn:Lane")?m(t,"bpmn:Participant")||m(t,"bpmn:Lane"):m(e,"bpmn:BoundaryEvent")&&!p1(e)?!1:m(e,"bpmn:FlowElement")&&!m(e,"bpmn:DataStoreReference")?m(t,"bpmn:FlowElementsContainer")?Se(t):ye(t,["bpmn:Participant","bpmn:Lane"]):m(e,"bpmn:DataStoreReference")&&m(t,"bpmn:Collaboration")?Jn(K(t).get("participants"),function(i){return!!i.get("processRef")}):ye(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?ye(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):m(e,"bpmn:MessageFlow")?m(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function p1(e){return K(e).cancelActivity&&(ev(e)||tv(e))}function f1(e){return!tt(e)&&m(e,"bpmn:BoundaryEvent")}function h1(e){return m(e,"bpmn:Lane")}function d1(e){return f1(e)||m(e,"bpmn:IntermediateThrowEvent")&&ev(e)?!0:m(e,"bpmn:IntermediateCatchEvent")&&tv(e)}function ev(e){var t=K(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function tv(e){return nv(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function nv(e,t){return t.some(function(n){return sn(e,n)})}function v1(e){return m(e,"bpmn:ReceiveTask")&&_e(e.incoming,function(t){return m(t.source,"bpmn:EventBasedGateway")})}function $r(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var r=e[0];return tt(r)||!d1(r)||Tt(t)||!m(t,"bpmn:Activity")||Wi(t)||i&&!Kd(i,t)||v1(t)?!1:"attach"}function iv(e,t,n){if(!t)return!1;var i={replacements:[]};return C(e,function(r){Tt(t)||m(r,"bpmn:StartEvent")&&r.type!=="label"&&Ui(r,t)&&(Pb(r)||i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),(Ab(r)||Mb(r)||Db(r))&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),nv(r,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&m(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"})),m(t,"bpmn:Transaction")||sn(r,"bpmn:CancelEventDefinition")&&r.type!=="label"&&(m(r,"bpmn:EndEvent")&&Ui(r,t)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:EndEvent"}),m(r,"bpmn:BoundaryEvent")&&$r(r,t,null,n)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function rv(e,t){return Jn(e,h1)?!1:t?e.every(function(n){return Ui(n,t)}):!0}function yu(e,t,n,i){return t?tt(e)||vu(e)?!0:i1(n,t)||n&&gu(n,t)?!1:Ui(e,t)||ko(e,t):!1}function av(e,t){return m(e,"bpmn:SubProcess")?Se(e)&&(!t||t.width>=100&&t.height>=80):m(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:m(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!(du(e)||vu(e))}function m1(e,t){var n=du(e),i=du(t);return(n||i)&&n!==i}function ov(e,t){return Oo(e)||Oo(t)?!1:mu(e)&&Wi(t)?!0:gu(t,e)||gu(e,t)?!1:m1(e,t)?!0:!!Eu(e,t)}function sv(e,t){return lv(e)&&!lv(t)?!1:a1(e)&&o1(t)&&!r1(e,t)}function cv(e,t){return Jd(t)&&t.incoming.length>0&&E1(t.incoming)&&!m(e,"bpmn:EventBasedGateway")?!1:c1(e)&&u1(t)&&s1(e,t)&&!(m(e,"bpmn:EventBasedGateway")&&!Jd(t))}function Eu(e,t){return ye(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ye(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:ye(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ye(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function ko(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:ye(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!tt(t)&&m(e,"bpmn:FlowNode")&&!m(e,"bpmn:BoundaryEvent")&&Ui(e,t.parent)}function g1(e,t){return e&&t&&e.indexOf(t)!==-1}function uv(e,t){return tt(t)?!0:!(m(t,"bpmn:Lane")&&!g1(e,t.parent))}function y1(e){if(e&&e.source)return m(e.source,"bpmn:EventBasedGateway")}function E1(e){return e=e||[],e.some(y1)}function lv(e){return Ua(e,"bpmn:Process")||Ua(e,"bpmn:Collaboration")}var b1={__depends__:[on],__init__:["bpmnRules"],bpmnRules:["type",nt]},x1=2e3;function pv(e,t){e.on("saveXML.start",x1,n);function n(){var i=t.getRootElement(),r=K(i).di,a,o;a=ma([i],!1),a=se(a,function(s){return s!==i&&!s.labelTarget}),o=Ye(a,Ni),r.set("planeElement",o)}}pv.$inject=["eventBus","canvas"];var _1={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",pv]};function Lo(e){U.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,r=i.shape||i.connection,a=i.parent,o=t.getOrdering(r,a);o&&(o.parent!==void 0&&(i.parent=o.parent),i.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,r=i.shape||i.connection,a=i.newParent||r.parent,o=t.getOrdering(r,a);o&&(o.parent!==void 0&&(i.newParent=o.parent),i.newParentIndex=o.index)})}Lo.prototype.getOrdering=function(e,t){return null};Z(Lo,U);function bu(e,t,n){Lo.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(s){if(s.labelTarget)return{level:10};var c=_e(i,function(u){return ye(s,[u.type])});return c&&c.order||{level:1}}function a(s){var c=s.order;if(c||(s.order=c=r(s)),!c)throw new Error("no order for <"+s.id+">");return c}function o(s,c,u){for(var l=c;l&&!ye(l,u);)l=l.parent;if(!l)throw new Error("no parent for <"+s.id+"> in <"+(c&&c.id)+">");return l}this.getOrdering=function(s,c){if(s.labelTarget)return{parent:t.getRootElement(),index:-1};var u=a(s);u.containers&&(c=o(s,c,u.containers));var l=c.children.indexOf(s),p=yg(c.children,function(h){return!s.labelTarget&&h.labelTarget?!1:u.level<a(h).level});return p!==-1&&l!==-1&&l<p&&(p-=1),{index:p,parent:c}}}bu.$inject=["eventBus","canvas","translate"];Z(bu,Lo);var w1={__depends__:[Ba],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",bu]};function De(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}De.$inject=["eventBus","injector"];De.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)};De.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),r=this._fire(e,"canExecute",n);if(r===void 0){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r};De.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};De.prototype.undo=function(){var e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};De.prototype.redo=function(){var e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};De.prototype.register=function(e,t){this._setHandler(e,t)};De.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)};De.prototype.canUndo=function(){return!!this._getUndoAction()};De.prototype.canRedo=function(){return!!this._getRedoAction()};De.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};De.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};De.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})};De.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i=t?[e+"."+t,t]:[e],r,a,o;for(n=this._eventBus.createEvent(n),r=0;(a=i[r])&&(o=this._eventBus.fire("commandStack."+a,n),!n.cancelBubble);r++);return o};De.prototype._createId=function(){return this._uid++};De.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};De.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,a=this._getHandler(i);if(!a)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),a.preExecute&&a.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),a.execute&&n._markDirty(a.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),a.postExecute&&a.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)};De.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};De.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:Tl("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};De.prototype._markDirty=function(e){var t=this._currentExecution;!e||(e=fe(e)?e:[e],t.dirty=t.dirty.concat(e))};De.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};De.prototype._revertedAction=function(e){this._stackIdx--};De.prototype._getHandler=function(e){return this._handlerMap[e]};De.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var S1={commandStack:["type",De]},T1=new tc("tt");function R1(e){var t=Ce('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function C1(e,t,n){I(e.style,{left:t+"px",top:n+"px"})}function xu(e,t){e.style.display=t===!1?"none":""}var fv="djs-tooltip",_u="."+fv;function ht(e,t){this._eventBus=e,this._canvas=t,this._ids=T1,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=R1(t.getContainer());var n=this;_t.bind(this._tooltipRoot,_u,"mousedown",function(i){i.stopPropagation()}),_t.bind(this._tooltipRoot,_u,"mouseover",function(i){n.trigger("mouseover",i)}),_t.bind(this._tooltipRoot,_u,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}ht.$inject=["eventBus","canvas"];ht.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=I({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};ht.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(xt(n,"data-tooltip-id"));!i||(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};ht.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};ht.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};ht.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};ht.prototype.remove=function(e){var t=this.get(e);t&&(Qt(t.html),Qt(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};ht.prototype.show=function(){xu(this._tooltipRoot)};ht.prototype.hide=function(){xu(this._tooltipRoot,!1)};ht.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};ht.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,r=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),Pt(n)&&(n=Ce(n)),i=Ce('<div data-tooltip-id="'+t+'" class="'+fv+'" style="position: absolute">'),i.appendChild(n),e.type&&je(i).add("djs-tooltip-"+e.type),e.className&&je(i).add(e.className),e.htmlContainer=i,r.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};ht.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;C1(n,t.x,t.y)};ht.prototype._updateTooltipVisibilty=function(e){C(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,r=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(r=!1),xu(i,r))})};ht.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};var P1={__init__:["tooltips"],tooltips:["type",ht]};function Yi(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(!!e){for(var n;n=e[0];)t(n);return e}}var A1=250,hv=1400;function wu(e,t,n){U.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",hv,function(r){var a=r.context,o=a.shapes,s=a.validatedShapes;a.shapes=dv(o),a.validatedShapes=dv(s)}),i&&t.on("shape.move.start",A1,function(r){var a=r.context,o=a.shapes,s=[];C(o,function(c){C(c.labels,function(u){!u.hidden&&a.shapes.indexOf(u)===-1&&s.push(u),c.labelTarget&&s.push(c)})}),C(s,function(c){i.makeDraggable(a,c,!0)})}),this.preExecuted("elements.move",hv,function(r){var a=r.context,o=a.closure,s=o.enclosedElements,c=[];C(s,function(u){C(u.labels,function(l){s[l.id]||c.push(l)})}),o.addAll(c)}),this.preExecute(["connection.delete","shape.delete"],function(r){var a=r.context,o=a.connection||a.shape;Yi(o.labels,function(s){n.removeShape(s,{nested:!0})})}),this.execute("shape.delete",function(r){var a=r.context,o=a.shape,s=o.labelTarget;s&&(a.labelTargetIndex=Os(s.labels,o),a.labelTarget=s,o.labelTarget=null)}),this.revert("shape.delete",function(r){var a=r.context,o=a.shape,s=a.labelTarget,c=a.labelTargetIndex;s&&(ke(s.labels,o,c),o.labelTarget=s)})}Z(wu,U);wu.$inject=["injector","eventBus","modeling"];function dv(e){return se(e,function(t){return e.indexOf(t.labelTarget)===-1})}var M1={__init__:["labelSupport"],labelSupport:["type",wu]},D1=251,vv=1401,mv="attach-ok";function Su(e,t,n,i,r){U.call(this,t);var a=e.get("movePreview",!1);t.on("shape.move.start",vv,function(o){var s=o.context,c=s.shapes,u=s.validatedShapes;s.shapes=N1(c),s.validatedShapes=O1(u)}),a&&t.on("shape.move.start",D1,function(o){var s=o.context,c=s.shapes,u=Tu(c);C(u,function(l){a.makeDraggable(s,l,!0),C(l.labels,function(p){a.makeDraggable(s,p,!0)})})}),a&&t.on("shape.move.start",function(o){var s=o.context,c=s.shapes;if(c.length===1){var u=c[0],l=u.host;l&&(n.addMarker(l,mv),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(l,mv)}))}}),this.preExecuted("elements.move",vv,function(o){var s=o.context,c=s.closure,u=s.shapes,l=Tu(u);C(l,function(p){c.add(p,c.topLevel[p.host.id])})}),this.postExecuted("elements.move",function(o){var s=o.context,c=s.shapes,u=s.newHost,l;u&&c.length!==1||(u?l=c:l=se(c,function(p){var h=p.host;return I1(p)&&!k1(c,h)}),C(l,function(p){r.updateAttachment(p,u)}))}),this.postExecuted("elements.move",function(o){var s=o.context.shapes;C(s,function(c){C(c.attachers,function(u){C(u.outgoing.slice(),function(l){var p=i.allowed("connection.reconnect",{connection:l,source:l.source,target:l.target});p||r.removeConnection(l)}),C(u.incoming.slice(),function(l){var p=i.allowed("connection.reconnect",{connection:l,source:l.source,target:l.target});p||r.removeConnection(l)})})})}),this.postExecute("shape.create",function(o){var s=o.context,c=s.shape,u=s.host;u&&r.updateAttachment(c,u)}),this.postExecute("shape.replace",function(o){var s=o.context,c=s.oldShape,u=s.newShape;Yi(c.attachers,function(l){var p=i.allowed("elements.move",{target:u,shapes:[l]});p==="attach"?r.updateAttachment(l,u):r.removeShape(l)}),u.attachers.length&&C(u.attachers,function(l){var p=kd(l,c,u);r.moveShape(l,p,l.parent)})}),this.postExecute("shape.resize",function(o){var s=o.context,c=s.shape,u=s.oldBounds,l=s.newBounds,p=c.attachers,h=s.hints||{};h.attachSupport!==!1&&C(p,function(f){var d=kd(f,u,l);r.moveShape(f,d,f.parent),C(f.labels,function(y){r.moveShape(y,d,y.parent)})})}),this.preExecute("shape.delete",function(o){var s=o.context.shape;Yi(s.attachers,function(c){r.removeShape(c)}),s.host&&r.updateAttachment(s,null)})}Z(Su,U);Su.$inject=["injector","eventBus","canvas","rules","modeling"];function Tu(e){return la(Ye(e,function(t){return t.attachers||[]}))}function N1(e){var t=Tu(e);return bg("id",e,t)}function O1(e){var t=Ei(e,"id");return se(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function I1(e){return!!e.host}function k1(e,t){return e.indexOf(t)!==-1}var L1={__depends__:[on],__init__:["attachSupport"],attachSupport:["type",Su]},B1=250;function hi(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}hi.$inject=["eventBus","dragging"];hi.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};hi.prototype.isActive=function(e){return e&&this._active===e};hi.prototype.length=function(e){return this._tools.length};hi.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};hi.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(a){var o=a.context;if(!o.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),C(t,function(a){r.push(a+".ended"),r.push(a+".canceled")}),n.on(r,B1,function(a){!this._active||$1(a)||this.setActive(null)},this)};function $1(e){var t=e.originalEvent&&e.originalEvent.target;return t&&ei(t,'.group[data-group="tools"]')}var Bo={__depends__:[bn],__init__:["toolManager"],toolManager:["type",hi]};function F1(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function j1(e,t){var n=[];return C(e.concat(t),function(i){var r=i.incoming,a=i.outgoing;C(r.concat(a),function(o){var s=o.source,c=o.target;(Fr(e,s)||Fr(e,c)||Fr(t,s)||Fr(t,c))&&(Fr(n,o)||n.push(o))})}),n}function Fr(e,t){return e.indexOf(t)!==-1}function H1(e,t,n){var i=e.x,r=e.y,a=e.width,o=e.height,s=n.x,c=n.y;switch(t){case"n":return{x:i,y:r+c,width:a,height:o-c};case"s":return{x:i,y:r,width:a,height:o+c};case"w":return{x:i+s,y:r,width:a-s,height:o};case"e":return{x:i,y:r,width:a+s,height:o};default:throw new Error("unknown direction: "+t)}}var Ru=Math.abs,z1=Math.round,wn={x:"width",y:"height"},gv="crosshair",$o={n:"top",w:"left",s:"bottom",e:"right"},G1=1500,yv={n:"s",w:"e",s:"n",e:"w"},Fo=20;function Sn(e,t,n,i,r,a,o){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=r,this._toolManager=a,this._mouse=o;var s=this;a.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(c){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(c.originalEvent)})}),n.on("spaceTool.move",G1,function(c){var u=c.context,l=u.initialized;l||(l=u.initialized=s.init(c,u)),l&&bv(c)}),n.on("spaceTool.end",function(c){var u=c.context,l=u.axis,p=u.direction,h=u.movingShapes,f=u.resizingShapes,d=u.start;if(!!u.initialized){bv(c);var y={x:0,y:0};y[l]=z1(c["d"+l]),s.makeSpace(h,f,y,p,d),n.once("spaceTool.ended",function(x){s.activateSelection(x.originalEvent,!0,!0)})}})}Sn.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];Sn.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:gv,data:{context:{reactivate:n}},trapClick:!1})};Sn.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:gv,data:{context:{}}})};Sn.prototype.makeSpace=function(e,t,n,i,r){return this._modeling.createSpace(e,t,n,i,r)};Sn.prototype.init=function(e,t){var n=Ru(e.dx)>Ru(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(Ru(i)<5)return!1;i<0&&(i*=-1),Li(e)&&(i*=-1);var a=F1(n,i),o=this._canvas.getRootElement(),s=ma(o,!0),c=this.calculateAdjustments(s,n,i,r),u=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:a,shapes:c.resizingShapes,start:r}),l=V1(c,n,a,r,u);return I(t,c,{axis:n,direction:a,spaceToolConstraints:l,start:r}),Va("resize-"+(n==="x"?"ew":"ns")),!0};Sn.prototype.calculateAdjustments=function(e,t,n,i){var r=this._rules,a=[],o=[];return C(e,function(s){if(!(!s.parent||Pu(s))){var c=s[t],u=c+s[wn[t]];if(n>0&&c>i||n<0&&u<i)return a.push(s);if(c<i&&u>i&&r.allowed("shape.resize",{shape:s}))return o.push(s)}}),{movingShapes:a,resizingShapes:o}};Sn.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Sn.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};function Ev(e){return{top:e.top-Fo,right:e.right+Fo,bottom:e.bottom+Fo,left:e.left-Fo}}function bv(e){var t=e.context,n=t.spaceToolConstraints;if(!!n){var i,r;ae(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),ae(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),ae(n.top)&&(r=Math.max(e.y,n.top),e.dy=e.dy+r-e.y,e.y=r),ae(n.bottom)&&(r=Math.min(e.y,n.bottom),e.dy=e.dy+r-e.y,e.y=r)}}function V1(e,t,n,i,r){var a=e.movingShapes,o=e.resizingShapes;if(!!o.length){var s={},c,u;return C(o,function(l){var p=ee(l),h=se(l.children,function(A){return!Pu(A)&&!xv(A)&&!Cu(a,A)&&!Cu(o,A)}),f=se(l.children,function(A){return!Pu(A)&&!xv(A)&&Cu(a,A)}),d,y,x;h.length&&(y=Ev(ee(Qe(h))),d=i-p[$o[n]]+y[$o[n]],n==="n"?s.bottom=u=ae(u)?Math.min(u,d):d:n==="w"?s.right=u=ae(u)?Math.min(u,d):d:n==="s"?s.top=c=ae(c)?Math.max(c,d):d:n==="e"&&(s.left=c=ae(c)?Math.max(c,d):d)),f.length&&(x=Ev(ee(Qe(f))),d=i-x[$o[yv[n]]]+p[$o[yv[n]]],n==="n"?s.bottom=u=ae(u)?Math.min(u,d):d:n==="w"?s.right=u=ae(u)?Math.min(u,d):d:n==="s"?s.top=c=ae(c)?Math.max(c,d):d:n==="e"&&(s.left=c=ae(c)?Math.max(c,d):d));var D=r&&r[l.id];D&&(n==="n"?(d=i+l[wn[t]]-D[wn[t]],s.bottom=u=ae(u)?Math.min(u,d):d):n==="w"?(d=i+l[wn[t]]-D[wn[t]],s.right=u=ae(u)?Math.min(u,d):d):n==="s"?(d=i-l[wn[t]]+D[wn[t]],s.top=c=ae(c)?Math.max(c,d):d):n==="e"&&(d=i-l[wn[t]]+D[wn[t]],s.left=c=ae(c)?Math.max(c,d):d))}),s}}function Cu(e,t){return e.indexOf(t)!==-1}function Pu(e){return!!e.waypoints}function xv(e){return!!e.labelTarget}var Au="djs-dragging",_v="djs-resizing",W1=250,jo=Math.max;function wv(e,t,n,i,r){function a(o,s){C(o,function(c){r.addDragger(c,s),n.addMarker(c,Au)})}e.on("spaceTool.selection.start",function(o){var s=n.getLayer("space"),c=o.context,u={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},l=Q("g");H(l,i.cls("djs-crosshair-group",["no-events"])),ne(s,l);var p=Q("path");H(p,"d",u.x),he(p).add("djs-crosshair"),ne(l,p);var h=Q("path");H(h,"d",u.y),he(h).add("djs-crosshair"),ne(l,h),c.crosshairGroup=l}),e.on("spaceTool.selection.move",function(o){var s=o.context.crosshairGroup;vt(s,o.x,o.y)}),e.on("spaceTool.selection.cleanup",function(o){var s=o.context,c=s.crosshairGroup;c&&Be(c)}),e.on("spaceTool.move",W1,function(o){var s=o.context,c=s.line,u=s.axis,l=s.movingShapes,p=s.resizingShapes;if(!!s.initialized){if(!s.dragGroup){var h=n.getLayer("space");c=Q("path"),H(c,"d","M0,0 L0,0"),he(c).add("djs-crosshair"),ne(h,c),s.line=c;var f=Q("g");H(f,i.cls("djs-drag-group",["no-events"])),ne(n.getActiveLayer(),f),a(l,f);var d=s.movingConnections=t.filter(function(b){var _=!1;C(l,function($){C($.outgoing,function(z){b===z&&(_=!0)})});var M=!1;C(l,function($){C($.incoming,function(z){b===z&&(M=!0)})});var N=!1;C(p,function($){C($.outgoing,function(z){b===z&&(N=!0)})});var P=!1;return C(p,function($){C($.incoming,function(z){b===z&&(P=!0)})}),U1(b)&&(_||N)&&(M||P)});a(d,f),s.dragGroup=f}if(!s.frameGroup){var y=Q("g");H(y,i.cls("djs-frame-group",["no-events"])),ne(n.getActiveLayer(),y);var x=[];C(p,function(b){var _=r.addFrame(b,y),M=_.getBBox();x.push({element:_,initialBounds:M}),n.addMarker(b,_v)}),s.frameGroup=y,s.frames=x}var D={x:"M"+o.x+", -10000 L"+o.x+", 10000",y:"M -10000, "+o.y+" L 10000, "+o.y};H(c,{d:D[u]});var A={x:"y",y:"x"},w={x:o.dx,y:o.dy};w[A[s.axis]]=0,vt(s.dragGroup,w.x,w.y),C(s.frames,function(b){var _=b.element,M=b.initialBounds,N,P;s.direction==="e"?H(_,{width:jo(M.width+w.x,5)}):(N=jo(M.width-w.x,5),H(_,{width:N,x:M.x+M.width-N})),s.direction==="s"?H(_,{height:jo(M.height+w.y,5)}):(P=jo(M.height-w.y,5),H(_,{height:P,y:M.y+M.height-P}))})}}),e.on("spaceTool.cleanup",function(o){var s=o.context,c=s.movingShapes,u=s.movingConnections,l=s.resizingShapes,p=s.line,h=s.dragGroup,f=s.frameGroup;C(c,function(d){n.removeMarker(d,Au)}),C(u,function(d){n.removeMarker(d,Au)}),h&&(Be(p),Be(h)),C(l,function(d){n.removeMarker(d,_v)}),f&&Be(f)})}wv.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];function U1(e){return e.waypoints}var Sv={__init__:["spaceToolPreview"],__depends__:[bn,on,Bo,Tr,Pr],spaceTool:["type",Sn],spaceToolPreview:["type",wv]};function Lt(e){this._model=e}Lt.$inject=["moddle"];Lt.prototype._needsId=function(e){return ye(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};Lt.prototype._ensureId=function(e){var t;m(e,"bpmn:Activity")?t="Activity":m(e,"bpmn:Event")?t="Event":m(e,"bpmn:Gateway")?t="Gateway":ye(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};Lt.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};Lt.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};Lt.prototype.createDiShape=function(e,t,n){return this.create("bpmndi:BPMNShape",I({bpmnElement:e,bounds:this.createDiBounds(t)},n))};Lt.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};Lt.prototype.createDiWaypoints=function(e){var t=this;return Ye(e,function(n){return t.createDiWaypoint(n)})};Lt.prototype.createDiWaypoint=function(e){return this.create("dc:Point",zt(e,["x","y"]))};Lt.prototype.createDiEdge=function(e,t,n){return this.create("bpmndi:BPMNEdge",I({bpmnElement:e},n))};Lt.prototype.createDiPlane=function(e){return this.create("bpmndi:BPMNPlane",{bpmnElement:e})};function gt(e,t,n,i){U.call(this,e),this._bpmnFactory=t,this._translate=i;var r=this;function a(f){var d=f.context,y=d.hints||{},x;!d.cropped&&y.createElementsBehavior!==!1&&(x=d.connection,x.waypoints=n.getCroppedWaypoints(x),d.cropped=!0)}this.executed(["connection.layout","connection.create"],a),this.reverted(["connection.layout"],function(f){delete f.context.cropped});function o(f){var d=f.context;r.updateParent(d.shape||d.connection,d.oldParent)}function s(f){var d=f.context,y=d.shape||d.connection,x=d.parent||d.newParent;r.updateParent(y,x)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Bt(o)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Bt(s));function c(f){var d=f.context,y=d.oldRoot,x=y.children;C(x,function(D){m(D,"bpmn:BaseElement")&&r.updateParent(D)})}this.executed(["canvas.updateRoot"],c),this.reverted(["canvas.updateRoot"],c);function u(f){var d=f.context.shape;!m(d,"bpmn:BaseElement")||r.updateBounds(d)}this.executed(["shape.move","shape.create","shape.resize"],Bt(function(f){f.context.shape.type!=="label"&&u(f)})),this.reverted(["shape.move","shape.create","shape.resize"],Bt(function(f){f.context.shape.type!=="label"&&u(f)})),e.on("shape.changed",function(f){f.element.type==="label"&&u({context:{shape:f.element}})});function l(f){r.updateConnection(f.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Bt(l)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Bt(l));function p(f){r.updateConnectionWaypoints(f.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Bt(p)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Bt(p)),this.executed("connection.reconnect",Bt(function(f){var d=f.context,y=d.connection,x=d.oldSource,D=d.newSource,A=K(y),w=K(x),b=K(D);A.conditionExpression&&!ye(b,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(d.oldConditionExpression=A.conditionExpression,delete A.conditionExpression),x!==D&&w.default===A&&(d.oldDefault=w.default,delete w.default)})),this.reverted("connection.reconnect",Bt(function(f){var d=f.context,y=d.connection,x=d.oldSource,D=d.newSource,A=K(y),w=K(x),b=K(D);d.oldConditionExpression&&(A.conditionExpression=d.oldConditionExpression),d.oldDefault&&(w.default=d.oldDefault,delete b.default)}));function h(f){r.updateAttachment(f.context)}this.executed(["element.updateAttachment"],Bt(h)),this.reverted(["element.updateAttachment"],Bt(h))}Z(gt,U);gt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];gt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};gt.prototype.updateParent=function(e,t){if(!(e instanceof Sa)&&!(m(e,"bpmn:DataStoreReference")&&e.parent&&m(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,r=n&&n.businessObject,a=r&&r.di;m(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,r,t&&t.businessObject),m(e,"bpmn:DataOutputAssociation")&&(e.source?r=e.source.businessObject:r=null),m(e,"bpmn:DataInputAssociation")&&(e.target?r=e.target.businessObject:r=null),this.updateSemanticParent(i,r),m(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,r),this.updateDiParent(i.di,a)}};gt.prototype.updateBounds=function(e){var t=e.businessObject.di,n=e instanceof Sa?this._getLabel(t):t,i=n.bounds;i||(i=this._bpmnFactory.createDiBounds(),n.set("bounds",i)),I(i,{x:e.x,y:e.y,width:e.width,height:e.height})};gt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,r;m(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),Ie(i,e)),m(t,"bpmn:Lane")&&(r=t.get("flowNodeRef"),ke(r,e))}};gt.prototype.updateDiConnection=function(e,t,n){e.sourceElement&&e.sourceElement.bpmnElement!==t&&(e.sourceElement=t&&t.di),e.targetElement&&e.targetElement.bpmnElement!==n&&(e.targetElement=n&&n.di)};gt.prototype.updateDiParent=function(e,t){if(t&&!m(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(Ie(n,e),e.$parent=null)}};function Y1(e){for(;e&&!m(e,"bpmn:Definitions");)e=e.$parent;return e}gt.prototype.getLaneSet=function(e){var t,n;return m(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(m(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};gt.prototype.updateSemanticParent=function(e,t,n){var i,r=this._translate;if(e.$parent!==t&&!((m(e,"bpmn:DataInput")||m(e,"bpmn:DataOutput"))&&(m(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(m(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(m(e,"bpmn:FlowElement")){if(t){if(m(t,"bpmn:Participant"))t=t.processRef;else if(m(t,"bpmn:Lane"))do t=t.$parent.$parent;while(m(t,"bpmn:Lane"))}i="flowElements"}else if(m(e,"bpmn:Artifact")){for(;t&&!m(t,"bpmn:Process")&&!m(t,"bpmn:SubProcess")&&!m(t,"bpmn:Collaboration");)if(m(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(m(e,"bpmn:MessageFlow"))i="messageFlows";else if(m(e,"bpmn:Participant")){i="participants";var a=e.processRef,o;a&&(o=Y1(e.$parent||t),e.$parent&&(Ie(o.get("rootElements"),a),a.$parent=null),t&&(ke(o.get("rootElements"),a),a.$parent=o))}else m(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":m(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(r("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var s;if(e.$parent&&(s=e.$parent.get(i),Ie(s,e)),t?(s=t.get(i),s.push(e),e.$parent=t):e.$parent=null,n){var c=n.get(i);Ie(s,e),t&&(c||(c=[],t.set(i,c)),c.push(e))}}};gt.prototype.updateConnectionWaypoints=function(e){e.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};gt.prototype.updateConnection=function(e){var t=e.connection,n=K(t),i=K(t.source),r=K(t.target),a;if(m(n,"bpmn:DataAssociation"))m(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=i,a=e.parent||e.newParent||r,this.updateSemanticParent(n,r,a)):m(n,"bpmn:DataOutputAssociation")&&(a=e.parent||e.newParent||i,this.updateSemanticParent(n,i,a),n.targetRef=r);else{var o=m(n,"bpmn:SequenceFlow");n.sourceRef!==i&&(o&&(Ie(n.sourceRef&&n.sourceRef.get("outgoing"),n),i&&i.get("outgoing")&&i.get("outgoing").push(n)),n.sourceRef=i),n.targetRef!==r&&(o&&(Ie(n.targetRef&&n.targetRef.get("incoming"),n),r&&r.get("incoming")&&r.get("incoming").push(n)),n.targetRef=r)}this.updateConnectionWaypoints(t),this.updateDiConnection(n.di,i,r)};gt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function Bt(e){return function(t){var n=t.context,i=n.shape||n.connection;m(i,"bpmn:BaseElement")&&e(t)}}function Wn(e,t,n){mn.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}Z(Wn,mn);Wn.$inject=["bpmnFactory","moddle","translate"];Wn.prototype.baseCreate=mn.prototype.create;Wn.prototype.create=function(e,t){return e==="label"?this.baseCreate(e,I({type:"label"},mr,t)):this.createBpmnElement(e,t)};Wn.prototype.createBpmnElement=function(e,t){var n,i=this._translate;t=t||{};var r=t.businessObject;if(!r){if(!t.type)throw new Error(i("no shape type specified"));r=this._bpmnFactory.create(t.type)}r.di||(e==="root"?r.di=this._bpmnFactory.createDiPlane(r,[],{id:r.id+"_di"}):e==="connection"?r.di=this._bpmnFactory.createDiEdge(r,[],{id:r.id+"_di"}):r.di=this._bpmnFactory.createDiShape(r,{},{id:r.id+"_di"})),m(r,"bpmn:Group")&&(t=I({isFrame:!0},t)),t.di&&(I(r.di,t.di),delete t.di),q1(r,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&Tv(r.di,t,"isExpanded"),m(r,"bpmn:ExclusiveGateway")&&(r.di.isMarkerVisible=!0);var a,o;return t.eventDefinitionType&&(a=r.get("eventDefinitions")||[],o=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(o.condition=this._bpmnFactory.create("bpmn:FormalExpression")),a.push(o),o.$parent=r,r.eventDefinitions=a,delete t.eventDefinitionType),n=this._getDefaultSize(r),t=I({businessObject:r,id:r.id},n,t),this.baseCreate(e,t)};Wn.prototype._getDefaultSize=function(e){return m(e,"bpmn:SubProcess")?Se(e)?{width:350,height:200}:{width:100,height:80}:m(e,"bpmn:Task")?{width:100,height:80}:m(e,"bpmn:Gateway")?{width:50,height:50}:m(e,"bpmn:Event")?{width:36,height:36}:m(e,"bpmn:Participant")?Se(e)?{width:600,height:250}:{width:400,height:60}:m(e,"bpmn:Lane")?{width:400,height:100}:m(e,"bpmn:DataObjectReference")?{width:36,height:50}:m(e,"bpmn:DataStoreReference")?{width:50,height:50}:m(e,"bpmn:TextAnnotation")?{width:100,height:30}:m(e,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Wn.prototype.createParticipantShape=function(e){return Ze(e)||(e={isExpanded:e}),e=I({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function q1(e,t,n){C(n,function(i){t[i]!==void 0&&Tv(e,t,i)})}function Tv(e,t,n){e[n]=t[n],delete t[n]}function Ho(e,t){this._modeling=e,this._canvas=t}Ho.$inject=["modeling","canvas"];Ho.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;C(n,function(r){var a={x:0,y:0};i.left?a.x=i.left-r.x:i.right?a.x=i.right-r.width-r.x:i.center?a.x=i.center-Math.round(r.width/2)-r.x:i.top?a.y=i.top-r.y:i.bottom?a.y=i.bottom-r.height-r.y:i.middle&&(a.y=i.middle-Math.round(r.height/2)-r.y),t.moveElements([r],a,r.parent)})};Ho.prototype.postExecute=function(e){};function zo(e){this._modeling=e}zo.$inject=["modeling"];zo.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,r=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:r.attach}),e.shape=i};zo.prototype.postExecute=function(e){var t=e.hints||{};K1(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function K1(e,t){return Jn(e.outgoing,function(n){return n.target===t})}function Go(e,t){this._canvas=e,this._layouter=t}Go.$inject=["canvas","layouter"];Go.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,a=e.parentIndex,o=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,o)),this._canvas.addConnection(t,r,a),t};Go.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var Vo=Math.round;function Mu(e){this._modeling=e}Mu.$inject=["modeling"];Mu.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,r=e.position,a=e.hints,o=this._modeling;C(t,function(l){ae(l.x)||(l.x=0),ae(l.y)||(l.y=0)});var s=Qe(t);C(t,function(l){Rv(l)&&(l.waypoints=Ye(l.waypoints,function(p){return{x:Vo(p.x-s.x-s.width/2+r.x),y:Vo(p.y-s.y-s.height/2+r.y)}})),I(l,{x:Vo(l.x-s.x-s.width/2+r.x),y:Vo(l.y-s.y-s.height/2+r.y)})});var c=Gl(t),u={};C(t,function(l){if(Rv(l)){u[l.id]=ae(i)?o.createConnection(u[l.source.id],u[l.target.id],i,l,l.parent||n,a):o.createConnection(u[l.source.id],u[l.target.id],l,l.parent||n,a);return}var p=I({},a);c.indexOf(l)===-1&&(p.autoResize=!1),u[l.id]=ae(i)?o.createShape(l,zt(l,["x","y","width","height"]),l.parent||n,i,p):o.createShape(l,zt(l,["x","y","width","height"]),l.parent||n,p)}),e.elements=ms(u)};function Rv(e){return!!e.waypoints}var Cv=Math.round;function Un(e){this._canvas=e}Un.$inject=["canvas"];Un.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?I(t,n):I(t,{x:n.x-Cv(t.width/2),y:n.y-Cv(t.height/2)}),this._canvas.addShape(t,i,r),t};Un.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function jr(e){Un.call(this,e)}Z(jr,Un);jr.$inject=["canvas"];var X1=Un.prototype.execute;jr.prototype.execute=function(e){var t=e.shape;return Q1(t),t.labelTarget=e.labelTarget,X1.call(this,e)};var Z1=Un.prototype.revert;jr.prototype.revert=function(e){return e.shape.labelTarget=null,Z1.call(this,e)};function Q1(e){["width","height"].forEach(function(t){typeof e[t]=="undefined"&&(e[t]=0)})}function Wo(e,t){this._canvas=e,this._modeling=t}Wo.$inject=["canvas","modeling"];Wo.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=Os(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};Wo.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,ke(n.children,t,i),this._canvas.addConnection(t,n),t};function Du(e,t){this._modeling=e,this._elementRegistry=t}Du.$inject=["modeling","elementRegistry"];Du.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;C(i,function(r){!n.get(r.id)||(r.waypoints?t.removeConnection(r):t.removeShape(r))})};function Hr(e,t){this._canvas=e,this._modeling=t}Hr.$inject=["canvas","modeling"];Hr.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;Yi(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Yi(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),Yi(n.children,function(i){J1(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};Hr.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=Os(i.children,n),t.removeShape(n),n};Hr.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return ke(i.children,n,r),t.addShape(n,i),n};function J1(e){return e.waypoints}function Uo(e){this._modeling=e}Uo.$inject=["modeling"];var Pv={x:"y",y:"x"};Uo.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function a(x,D){x.range.min=Math.min(D[i],x.range.min),x.range.max=Math.max(D[i]+D[r],x.range.max)}function o(x){return x[i]+x[r]/2}function s(x){return x.length-1}function c(x){return x.max-x.min}function u(x,D){var A={y:0};A[i]=x-o(D),A[i]&&(A[Pv[i]]=0,t.moveElements([D],A,D.parent))}var l=n[0],p=s(n),h=n[p],f,d,y=0;C(n,function(x,D){var A,w,b;if(x.elements.length<2){D&&D!==n.length-1&&(a(x,x.elements[0]),y+=c(x.range));return}A=jt(x.elements,i),w=A[0],D===p&&(w=A[s(A)]),b=o(w),x.range=null,C(A,function(_){if(u(b,_),x.range===null){x.range={min:_[i],max:_[i]+_[r]};return}a(x,_)}),D&&D!==n.length-1&&(y+=c(x.range))}),d=Math.abs(h.range.min-l.range.max),f=Math.round((d-y)/(n.length-1)),!(f<n.length-1)&&C(n,function(x,D){var A={},w;x===l||x===h||(w=n[D-1],x.range.max=0,C(x.elements,function(b,_){A[Pv[i]]=0,A[i]=w.range.max-b[i]+f,x.range.min!==b[i]&&(A[i]+=b[i]-x.range.min),A[i]&&t.moveElements([b],A,b.parent),x.range.max=Math.max(b[i]+b[r],_?x.range.max:0)}))})};Uo.prototype.postExecute=function(e){};function Yo(e,t){this._layouter=e,this._canvas=t}Yo.$inject=["layouter","canvas"];Yo.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return I(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};Yo.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function Nu(){}Nu.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,a=t.parent;return e.oldParent=a,e.oldParentIndex=Ie(a.children,t),ke(i.children,t,r),t.parent=i,C(t.waypoints,function(o){o.x+=n.x,o.y+=n.y,o.original&&(o.original.x+=n.x,o.original.y+=n.y)}),t};Nu.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,a=e.delta;return Ie(n.children,t),ke(i.children,t,r),t.parent=i,C(t.waypoints,function(o){o.x-=a.x,o.y-=a.y,o.original&&(o.original.x-=a.x,o.original.y-=a.y)}),t};function Ou(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Ou.prototype.add=function(e,t){return this.addAll([e],t)};Ou.prototype.addAll=function(e,t){var n=ry(e,!!t,this);return I(this,n),this};function zr(e){this._modeling=e}zr.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};zr.prototype.moveClosure=function(e,t,n,i,r){var a=this._modeling,o=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,l=!1;r&&r.parent===n&&(l=!0),C(o,function(p){a.moveShape(p,t,u[p.id]&&!l&&n,{recurse:!1,layout:!1})}),C(s,function(p){var h=!!o[p.source.id],f=!!o[p.target.id];c[p.id]&&h&&f?a.moveConnection(p,t,u[p.id]&&!l&&n):a.layoutConnection(p,{connectionStart:h&&tu(p,p.source,t),connectionEnd:f&&nu(p,p.target,t)})})};zr.prototype.getClosure=function(e){return new Ou().addAll(e,!0)};function qo(e){this._helper=new zr(e)}qo.$inject=["modeling"];qo.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};qo.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function di(e){this._modeling=e,this._helper=new zr(e)}di.$inject=["modeling"];di.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,a=t.parent;return e.oldBounds=zt(t,["x","y","width","height"]),e.oldParent=a,e.oldParentIndex=Ie(a.children,t),ke(i.children,t,r),I(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};di.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;i.layout!==!1&&(C(t.incoming,function(a){r.layoutConnection(a,{connectionEnd:nu(a,t,n)})}),C(t.outgoing,function(a){r.layoutConnection(a,{connectionStart:tu(a,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};di.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return ke(n.children,t,i),I(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t};di.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};di.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function Gr(e){this._modeling=e}Gr.$inject=["modeling"];Gr.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return fe(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};Gr.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,r=e.dockingOrPoints,a=e.hints||{},o={};a.connectionStart&&(o.connectionStart=a.connectionStart),a.connectionEnd&&(o.connectionEnd=a.connectionEnd),a.layoutConnection!==!1&&(n&&(!i||a.docking==="source")&&(o.connectionStart=o.connectionStart||Av(fe(r)?r[0]:r)),i&&(!n||a.docking==="target")&&(o.connectionEnd=o.connectionEnd||Av(fe(r)?r[r.length-1]:r)),a.newWaypoints&&(o.waypoints=a.newWaypoints),this._modeling.layoutConnection(t,o))};Gr.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};function Av(e){return e.original||e}function Tn(e,t){this._modeling=e,this._rules=t}Tn.$inject=["modeling","rules"];Tn.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,r=e.oldShape,a=e.newData,o=e.hints||{},s;function c(d,y,x){return i.allowed("connection.reconnect",{connection:x,source:d,target:y})}var u={x:a.x,y:a.y},l={x:r.x,y:r.y,width:r.width,height:r.height};s=e.newShape=e.newShape||t.createShape(a,u,r.parent,o),r.host&&n.updateAttachment(s,r.host);var p;o.moveChildren!==!1&&(p=r.children.slice(),n.moveElements(p,{x:0,y:0},s,o));var h=r.incoming.slice(),f=r.outgoing.slice();C(h,function(d){var y=d.source,x=c(y,s,d);x&&t.reconnectEnd(d,s,Co(d,s,l),o)}),C(f,function(d){var y=d.target,x=c(s,y,d);x&&t.reconnectStart(d,s,Ro(d,s,l),o)})};Tn.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};Tn.prototype.execute=function(e){};Tn.prototype.revert=function(e){};Tn.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};Tn.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};Tn.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function Vr(e){this._modeling=e}Vr.$inject=["modeling"];Vr.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},I(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};Vr.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,r=e.hints||{};r.layout!==!1&&(C(n.incoming,function(a){t.layoutConnection(a,{connectionEnd:Co(a,n,i)})}),C(n.outgoing,function(a){t.layoutConnection(a,{connectionStart:Ro(a,n,i)})}))};Vr.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return I(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function Yn(e){this._modeling=e}Yn.$inject=["modeling"];Yn.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,r=e.resizingShapes,a=e.start,o={};this.moveShapes(i,t),C(r,function(s){o[s.id]=tT(s)}),this.resizeShapes(r,t,n),this.updateConnectionWaypoints(j1(i,r),t,n,a,i,r,o)};Yn.prototype.execute=function(){};Yn.prototype.revert=function(){};Yn.prototype.moveShapes=function(e,t){var n=this;C(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};Yn.prototype.resizeShapes=function(e,t,n){var i=this;C(e,function(r){var a=H1(r,n,t);i._modeling.resizeShape(r,a,null,{attachSupport:!1,autoResize:!1,layout:!1})})};Yn.prototype.updateConnectionWaypoints=function(e,t,n,i,r,a,o){var s=this,c=r.concat(a);C(e,function(u){var l=u.source,p=u.target,h=eT(u),f=Dv(n),d={labelBehavior:!1};qn(c,l)&&qn(c,p)?(h=Ye(h,function(y){return Nv(y,i,n)&&(y[f]=y[f]+t[f]),y.original&&Nv(y.original,i,n)&&(y.original[f]=y.original[f]+t[f]),y}),s._modeling.updateWaypoints(u,h,{labelBehavior:!1})):(qn(c,l)||qn(c,p))&&(qn(r,l)?d.connectionStart=tu(u,l,t):qn(r,p)?d.connectionEnd=nu(u,p,t):qn(a,l)?d.connectionStart=Ro(u,l,o[l.id]):qn(a,p)&&(d.connectionEnd=Co(u,p,o[p.id])),s._modeling.layoutConnection(u,d))})};function Mv(e){return I({},e)}function eT(e){return Ye(e.waypoints,function(t){return t=Mv(t),t.original&&(t.original=Mv(t.original)),t})}function Dv(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function Nv(e,t,n){var i=Dv(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function qn(e,t){return e.indexOf(t)!==-1}function tT(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function Ko(e){this._modeling=e}Ko.$inject=["modeling"];Ko.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=Ov(n),t.collapsed=!t.collapsed;var i=Iv(n,t.collapsed);return[t].concat(i)};Ko.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,r=kv(i,n);return t.collapsed=!t.collapsed,[t].concat(r)};function Ov(e){var t={};return C(e,function(n){t[n.id]=n.hidden,n.children&&(t=I({},t,Ov(n.children)))}),t}function Iv(e,t){var n=[];return C(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(Iv(i.children,i.collapsed||t)))}),n}function kv(e,t){var n=[];return C(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(kv(i.children,t)))}),n}function Xo(e){this._modeling=e}Xo.$inject=["modeling"];Xo.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=Lv(i,t),Bv(n,t),t.host=n,t};Xo.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,Lv(n,t),Bv(i,t,r),t};function Lv(e,t){return Ie(e&&e.attachers,t)}function Bv(e,t,n){if(!!e){var i=e.attachers;i||(e.attachers=i=[]),ke(i,t,n)}}function Iu(){}Iu.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};Iu.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Te(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Te.$inject=["eventBus","elementFactory","commandStack"];Te.prototype.getHandlers=function(){return{"shape.append":zo,"shape.create":Un,"shape.delete":Hr,"shape.move":di,"shape.resize":Vr,"shape.replace":Tn,"shape.toggleCollapse":Ko,spaceTool:Yn,"label.create":jr,"connection.create":Go,"connection.delete":Wo,"connection.move":Nu,"connection.layout":Yo,"connection.updateWaypoints":Iu,"connection.reconnect":Gr,"elements.create":Mu,"elements.move":qo,"elements.delete":Du,"elements.distribute":Uo,"elements.align":Ho,"element.updateAttachment":Xo}};Te.prototype.registerHandlers=function(e){C(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Te.prototype.moveShape=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=null);var a={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",a)};Te.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Te.prototype.moveElements=function(e,t,n,i){i=i||{};var r=i.attach,a=n,o;r===!0?(o=n,a=n.parent):r===!1&&(o=null);var s={shapes:e,delta:t,newParent:a,newHost:o,hints:i};this._commandStack.execute("elements.move",s)};Te.prototype.moveConnection=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=void 0);var a={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",a)};Te.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Te.prototype.createConnection=function(e,t,n,i,r,a){typeof n=="object"&&(a=r,r=i,i=n,n=void 0),i=this._create("connection",i);var o={source:e,target:t,parent:r,parentIndex:n,connection:i,hints:a};return this._commandStack.execute("connection.create",o),o.connection};Te.prototype.createShape=function(e,t,n,i,r){typeof i!="number"&&(r=i,i=void 0),r=r||{};var a=r.attach,o,s;e=this._create("shape",e),a?(o=n.parent,s=n):o=n;var c={position:t,shape:e,parent:o,parentIndex:i,host:s,hints:r};return this._commandStack.execute("shape.create",c),c.shape};Te.prototype.createElements=function(e,t,n,i,r){fe(e)||(e=[e]),typeof i!="number"&&(r=i,i=void 0),r=r||{};var a={position:t,elements:e,parent:n,parentIndex:i,hints:r};return this._commandStack.execute("elements.create",a),a.elements};Te.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape};Te.prototype.appendShape=function(e,t,n,i,r){r=r||{},t=this._create("shape",t);var a={source:e,position:n,target:i,shape:t,connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",a),a.shape};Te.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Te.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Te.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Te.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Te.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Te.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Te.prototype.resizeShape=function(e,t,n,i){var r={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)};Te.prototype.createSpace=function(e,t,n,i,r){var a={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:r};this._commandStack.execute("spaceTool",a)};Te.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Te.prototype.reconnect=function(e,t,n,i,r){var a={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:r||{}};this._commandStack.execute("connection.reconnect",a)};Te.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,I(i,{docking:"source"}))};Te.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,I(i,{docking:"target"}))};Te.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Te.prototype._create=function(e,t){return t instanceof cr?t:this._elementFactory.create(e,t)};Te.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function Wr(e){this._elementRegistry=e}Wr.$inject=["elementRegistry"];Wr.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var r=e.changed||this.getVisualReferences(n).concat(t),a=e.oldProperties||nT(n,pa(i));return $v(n,i),e.oldProperties=a,e.changed=r,r};Wr.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return $v(n,t),i};Wr.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return m(e,"bpmn:DataObject")?iT(e,t):[]};function nT(e,t){return bt(t,function(n,i){return n[i]=e.get(i),n},{})}function $v(e,t){C(t,function(n,i){e.set(i,n)})}function iT(e,t){return t.filter(function(n){return m(n,"bpmn:DataObjectReference")&&K(n).dataObjectRef===e})}var Ur="default",Rn="id",Fv="di",rT={width:0,height:0};function Yr(e,t,n,i,r){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=r}Yr.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];Yr.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var r=this._elementRegistry,a=this._moddle.ids,o=t.businessObject,s=uT(e.properties),c=e.oldProperties||aT(o,s);return jv(s,o)&&(a.unclaim(o[Rn]),r.updateId(t,s[Rn]),a.claim(s[Rn],o)),Ur in s&&(s[Ur]&&n.push(r.get(s[Ur].id)),o[Ur]&&n.push(r.get(o[Ur].id))),Hv(o,s),e.oldProperties=c,e.changed=n,n};Yr.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&K(n).name;if(!!i){var r=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,r,rT)}};Yr.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,r=t.businessObject,a=this._elementRegistry,o=this._moddle.ids;return Hv(r,i),jv(n,r)&&(o.unclaim(n[Rn]),a.updateId(t,i[Rn]),o.claim(i[Rn],r)),e.changed};function jv(e,t){return Rn in e&&e[Rn]!==t[Rn]}function aT(e,t){var n=pa(t);return bt(n,function(i,r){return r!==Fv?i[r]=e.get(r):i[r]=oT(e.di,pa(t.di)),i},{})}function oT(e,t){return bt(t,function(n,i){return n[i]=e.get(i),n},{})}function Hv(e,t){C(t,function(n,i){i!==Fv?e.set(i,n):e.di&&sT(e.di,n)})}function sT(e,t){C(t,function(n,i){e.set(i,n)})}var cT=["default"];function uT(e){var t=I({},e);return cT.forEach(function(n){n in e&&(t[n]=K(t[n]))}),t}function Zo(e,t){this._canvas=e,this._modeling=t}Zo.$inject=["canvas","modeling"];Zo.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=t.getRootElement(),a=r.businessObject,o=a.$parent,s=a.di;t.setRootElement(n,!0),ke(o.rootElements,i),i.$parent=o,Ie(o.rootElements,a),a.$parent=null,a.di=null,s.bpmnElement=i,i.di=s,e.oldRoot=r};Zo.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=e.oldRoot,a=r.businessObject,o=i.$parent,s=i.di;t.setRootElement(r,!0),Ie(o.rootElements,i),i.$parent=null,ke(o.rootElements,a),a.$parent=o,i.di=null,s.bpmnElement=a,a.di=s};function ku(e,t){this._modeling=e,this._spaceTool=t}ku.$inject=["modeling","spaceTool"];ku.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,r=e.location,a=Yt(i),o=a===i,s=o?i:i.parent,c=li(s);c.length||n.createShape({type:"bpmn:Lane"},{x:i.x+Gi,y:i.y,width:i.width-Gi,height:i.height},s);var u=[];ti(a,function(y){return u.push(y),y.label&&u.push(y.label),y===i?[]:se(y.children,function(x){return x!==i})});var l=r==="top"?-120:120,p=r==="top"?i.y:i.y+i.height,h=p+(r==="top"?10:-10),f=r==="top"?"n":"s",d=t.calculateAdjustments(u,"y",l,h);t.makeSpace(d.movingShapes,d.resizingShapes,{x:0,y:l},f,h),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(o?Gi:0),y:p-(r==="top"?120:0),width:i.width-(o?Gi:0),height:120},s)};function Lu(e,t){this._modeling=e,this._translate=t}Lu.$inject=["modeling","translate"];Lu.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,r=e.count,a=li(i),o=a.length;if(o>r)throw new Error(n("more than {count} child lanes",{count:r}));var s=Math.round(i.height/r),c,u,l,p,h;for(h=0;h<r;h++)c=i.y+h*s,h===r-1?u=i.height-s*h:u=s,l={x:i.x+Gi,y:c,width:i.width-Gi,height:u},h<o?t.resizeShape(a[h],l):(p={type:"bpmn:Lane"},t.createShape(p,l,i))};function qr(e,t){this._modeling=e,this._spaceTool=t}qr.$inject=["modeling","spaceTool"];qr.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};qr.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=J0(e,t);n.resizeShape(e,t),i.forEach(function(r){n.resizeShape(r.shape,r.newBounds)})};qr.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=ee(e),r=ee(t),a=Bh(r,i),o=Yt(e),s=[],c=[];ti(o,function(d){return s.push(d),(m(d,"bpmn:Lane")||m(d,"bpmn:Participant"))&&c.push(d),d.children});var u,l,p,h,f;(a.bottom||a.top)&&(u=a.bottom||a.top,l=e.y+(a.bottom?e.height:0)+(a.bottom?-10:10),p=a.bottom?"s":"n",h=a.top>0||a.bottom<0?-u:u,f=n.calculateAdjustments(s,"y",h,l),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:u},p)),(a.left||a.right)&&(u=a.right||a.left,l=e.x+(a.right?e.width:0)+(a.right?-10:100),p=a.right?"e":"w",h=a.left>0||a.right<0?-u:u,f=n.calculateAdjustments(c,"x",h,l),n.makeSpace(f.movingShapes,f.resizingShapes,{x:u,y:0},p))};var Kr="flowNodeRef",Bu="lanes";function Xr(e){this._elementRegistry=e}Xr.$inject=["elementRegistry"];Xr.prototype.computeUpdates=function(e,t){var n=[],i=[],r={},a=[];function o(l,p){var h=ee(p),f={x:l.x+l.width/2,y:l.y+l.height/2};return f.x>h.left&&f.x<h.right&&f.y>h.top&&f.y<h.bottom}function s(l){n.indexOf(l)===-1&&(a.push(l),n.push(l))}function c(l){var p=Yt(l);return r[p.id]||(r[p.id]=so(p)),r[p.id]}function u(l){if(!l.parent)return[];var p=c(l);return p.filter(function(h){return o(l,h)}).map(function(h){return h.businessObject})}return t.forEach(function(l){var p=Yt(l);if(!(!p||n.indexOf(p)!==-1)){var h=p.children.filter(function(f){return m(f,"bpmn:FlowNode")});h.forEach(s),n.push(p)}}),e.forEach(s),a.forEach(function(l){var p=l.businessObject,h=p.get(Bu),f=h.slice(),d=u(l);i.push({flowNode:p,remove:f,add:d})}),t.forEach(function(l){var p=l.businessObject;l.parent||p.get(Kr).forEach(function(h){i.push({flowNode:h,remove:[p],add:[]})})}),i};Xr.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,r=i.get(Bu);n.remove.forEach(function(a){Ie(r,a),Ie(a.get(Kr),i)}),n.add.forEach(function(a){ke(r,a),ke(a.get(Kr),i)})})};Xr.prototype.revert=function(e){var t=e.updates;t.forEach(function(n){var i=n.flowNode,r=i.get(Bu);n.add.forEach(function(a){Ie(r,a),Ie(a.get(Kr),i)}),n.remove.forEach(function(a){ke(r,a),ke(a.get(Kr),i)})})};function Qo(e){this._moddle=e}Qo.$inject=["moddle"];Qo.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;r?t.claim(n,i):t.unclaim(n)};Qo.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;r?t.unclaim(n):t.claim(n,i)};var lT={fill:void 0,stroke:void 0};function $u(e){this._commandStack=e,this._normalizeColor=function(t){if(!!t){if(Pt(t)){var n=pT(t);if(n)return n}throw new Error("invalid color value: "+t)}}}$u.$inject=["commandStack"];$u.prototype.postExecute=function(e){var t=e.elements,n=e.colors||lT,i=this,r={};"fill"in n&&I(r,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&I(r,{"border-color":this._normalizeColor(n.stroke)}),C(t,function(a){var o=fT(a)?zt(r,["border-color"]):r;hT(o),i._commandStack.execute("element.updateProperties",{element:a,properties:{di:o}})})};function pT(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function fT(e){return!!e.waypoints}function hT(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var dT={width:0,height:0};function zv(e,t){function n(s,c){var u=s.label||s,l=s.labelTarget||s;return Ob(u,c),[u,l]}function i(s){var c=s.element,u=c.businessObject,l=s.newLabel;if(!tt(c)&&Ii(c)&&!$a(c)&&!Gv(l)){var p=7,h=Fa(c);h={x:h.x,y:h.y+p},e.createLabel(c,h,{id:u.id+"_label",businessObject:u})}}function r(s){return s.oldLabel=Gt(s.element),n(s.element,s.newLabel)}function a(s){return n(s.element,s.oldLabel)}function o(s){var c=s.element,u=c.label||c,l=s.newLabel,p=s.newBounds,h=s.hints||{};if(!(!tt(u)&&!m(u,"bpmn:TextAnnotation"))){if(tt(u)&&Gv(l)){h.removeShape!==!1&&e.removeShape(u,{unsetLabel:!1});return}var f=Gt(u);typeof p=="undefined"&&(p=t.getExternalLabelBounds(u,f)),p&&e.resizeShape(u,p,dT)}}this.preExecute=i,this.execute=r,this.revert=a,this.postExecute=o}zv.$inject=["modeling","textRenderer"];function Gv(e){return!e||!e.trim()}function it(e,t,n,i){Te.call(this,e,t,n),this._bpmnRules=i}Z(it,Te);it.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];it.prototype.getHandlers=function(){var e=Te.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=Wr,e["element.updateProperties"]=Yr,e["canvas.updateRoot"]=Zo,e["lane.add"]=ku,e["lane.resize"]=qr,e["lane.split"]=Lu,e["lane.updateRefs"]=Xr,e["id.updateClaim"]=Qo,e["element.setColor"]=$u,e["element.updateLabel"]=zv,e};it.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};it.prototype.connect=function(e,t,n,i){var r=this._bpmnRules;if(n||(n=r.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};it.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};it.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};it.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};it.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};it.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};it.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};it.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};it.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};it.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};it.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};it.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function Vv(){}Vv.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||ce(t.source||e.source),t.connectionEnd||ce(t.target||e.target)]};var Jo=20,vT=5,es=Math.round,Wv=20,mT={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function gT(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function yT(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function Uv(e,t,n){var i=Je(t,e,vT),r=n.split(":")[0],a=es((t.x-e.x)/2+e.x),o=es((t.y-e.y)/2+e.y),s,c,u=yT(r,i),l=/h|r|l/.test(r),p=!1,h=!1;return u?(s=l?{x:a,y:e.y}:{x:e.x,y:o},c=l?"h:h":"v:v"):(p=gT(i,r),c=l?"h:v":"v:h",p?l?(h=o===e.y,s={x:e.x+Jo*(/l/.test(r)?-1:1),y:h?o+Jo:o}):(h=a===e.x,s={x:h?a+Jo:a,y:e.y+Jo*(/t/.test(r)?-1:1)}):s={x:a,y:o}),{waypoints:Fu(e,s,c).concat(s),directions:c,turnNextDirections:h}}function ET(e,t,n){return Uv(e,t,n)}function bT(e,t,n){var i=Uv(t,e,Yv(n));return{waypoints:i.waypoints.slice().reverse(),directions:Yv(i.directions),turnNextDirections:i.turnNextDirections}}function xT(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var r=n+":"+i,a=Fu(e.waypoints[e.waypoints.length-1],t.waypoints[0],r);return{waypoints:a,directions:r}}function Yv(e){return e.split(":").reverse().join(":")}function _T(e,t,n){var i=es((t.x-e.x)/2+e.x),r=es((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Fu(e,t,n){if(n=n||"h:h",!DT(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Kv(n)){var i=ET(e,t,n),r=bT(e,t,n),a=xT(i,r);return[].concat(i.waypoints,a.waypoints,r.waypoints)}return _T(e,t,n)}function wT(e,t,n){var i=Fu(e,t,n);return i.unshift(e),i.push(t),Zv(i)}function ST(e,t,n,i,r){var a=r&&r.preferredLayouts||[],o=Eg(a,"straight")[0]||"h:h",s=mT[o]||0,c=Je(e,t,s),u=MT(c,o);n=n||ce(e),i=i||ce(t);var l=u.split(":"),p=Xv(n,e,l[0],NT(c)),h=Xv(i,t,l[1],c);return wT(p,h,u)}function TT(e,t,n,i,r,a){fe(n)&&(r=n,a=i,n=ce(e),i=ce(t)),a=I({preferredLayouts:[]},a),r=r||[];var o=a.preferredLayouts,s=o.indexOf("straight")!==-1,c;return c=s&&CT(e,t,n,i,a),c||(c=a.connectionEnd&&AT(t,e,i,r),c)||(c=a.connectionStart&&PT(e,t,n,r),c)?c:!a.connectionStart&&!a.connectionEnd&&r&&r.length?r:ST(e,t,n,i,a)}function RT(e,t,n){return e>=t&&e<=n}function qv(e,t,n){var i={x:"width",y:"height"};return RT(t[e],n[e],n[e]+n[i[e]])}function CT(e,t,n,i,r){var a={},o,s;return s=Je(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(o="x"),/left|right/.test(s)&&(o="y"),r.preserveDocking==="target"?qv(o,i,e)?(a[o]=i[o],[{x:a.x!==void 0?a.x:n.x,y:a.y!==void 0?a.y:n.y,original:{x:a.x!==void 0?a.x:n.x,y:a.y!==void 0?a.y:n.y}},{x:i.x,y:i.y}]):null:qv(o,n,t)?(a[o]=n[o],[{x:n.x,y:n.y},{x:a.x!==void 0?a.x:i.x,y:a.y!==void 0?a.y:i.y,original:{x:a.x!==void 0?a.x:i.x,y:a.y!==void 0?a.y:i.y}}]):null):null}function PT(e,t,n,i){return ju(e,t,n,i)}function AT(e,t,n,i){var r=i.slice().reverse();return r=ju(e,t,n,r),r?r.reverse():null}function ju(e,t,n,i){function r(l){return l.length<3?!0:l.length>4?!1:!!_e(l,function(p,h){var f=l[h-1];return f&&or(p,f)<3})}function a(l,p,h){var f=vn(p,l);switch(f){case"v":return{x:h.x,y:l.y};case"h":return{x:l.x,y:h.y}}return{x:l.x,y:l.y}}function o(l,p,h){var f;for(f=l.length-2;f!==0;f--)if(Kl(l[f],p,Wv)||Kl(l[f],h,Wv))return l.slice(f);return l}if(r(i))return null;var s=i[0],c=i.slice(),u;return c[0]=n,c[1]=a(c[1],s,n),u=o(c,e,t),u!==c&&(c=ju(e,t,n,u)),c&&vn(c)?null:c}function MT(e,t){if(Kv(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function DT(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function Kv(e){return e&&/t|r|b|l/.test(e)}function NT(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function Xv(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Zv(e){return e.reduce(function(t,n,i){var r=t[t.length-1],a=e[i+1];return Is(r,a,n,0)||t.push(n),t},[])}var OT=-10,IT=40,Hu={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},ts={top:"t",right:"r",bottom:"b",left:"l"};function zu(){}Z(zu,Vv);zu.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,r=t.waypoints||e.waypoints,a=t.connectionStart,o=t.connectionEnd,s,c;return a||(a=Qv(r&&r[0],n)),o||(o=Qv(r&&r[r.length-1],i)),(m(e,"bpmn:Association")||m(e,"bpmn:DataAssociation"))&&r&&!Jv(n,i)?[].concat([a],r.slice(1,-1),[o]):(m(e,"bpmn:MessageFlow")?s=LT(n,i):(m(e,"bpmn:SequenceFlow")||Jv(n,i))&&(n===i?s={preferredLayouts:VT(n,e)}:m(n,"bpmn:BoundaryEvent")?s={preferredLayouts:WT(n,i,o)}:Zr(n)||Zr(i)?s=$T(n):m(n,"bpmn:Gateway")?s={preferredLayouts:["v:h"]}:m(i,"bpmn:Gateway")?s={preferredLayouts:["h:v"]}:s={preferredLayouts:["h:h"]}),s&&(s=I(s,t),c=Zv(TT(n,i,a,o,r,s))),c||[a,o])};function kT(e){var t=e.host;return Je(ce(e),t,OT)}function LT(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:BT(e,t)}}function BT(e,t){return m(t,"bpmn:Participant")?"source":m(e,"bpmn:Participant")?"target":Zr(t)?"source":Zr(e)||m(t,"bpmn:Event")?"target":m(e,"bpmn:Event")?"source":null}function $T(e){return{preferredLayouts:["straight","h:h"],preserveDocking:FT(e)}}function FT(e){return Zr(e)?"target":"source"}function Qv(e,t){return e?e.original||e:ce(t)}function Jv(e,t){return m(t,"bpmn:Activity")&&m(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Zr(e){return m(e,"bpmn:SubProcess")&&Se(e)}function Qr(e,t){return e===t}function jT(e,t){return t.indexOf(e)!==-1}function Jr(e){var t=/right|left/.exec(e);return t&&t[0]}function vi(e){var t=/top|bottom/.exec(e);return t&&t[0]}function HT(e,t){return Hu[e]===t}function zT(e,t){var n=Jr(e),i=Hu[n];return t.indexOf(i)!==-1}function GT(e,t){var n=vi(e),i=Hu[n];return t.indexOf(i)!==-1}function Gu(e){return e==="right"||e==="left"}function VT(e,t){var n=t.waypoints,i=n&&n.length&&Je(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function WT(e,t,n){var i=ce(e),r=ce(t),a=kT(e),o,s,c=Qr(e.host,t),u=jT(a,["top","right","bottom","left"]),l=Je(r,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return c?UT(a,u,e,t,n):(o=YT(a,l,u),s=qT(a,l,u),[o+":"+s])}function UT(e,t,n,i,r){var a=t?e:vi(e),o=ts[a],s;return t?Gu(e)?s=em("y",n,i,r)?"h":"b":s=em("x",n,i,r)?"v":"l":s="v",[o+":"+s]}function em(e,t,n,i){var r=IT;return!(Vu(e,i,n,r)||Vu(e,i,{x:n.x+n.width,y:n.y+n.height},r)||Vu(e,i,ce(t),r))}function Vu(e,t,n,i){return Math.abs(t[e]-n[e])<i}function YT(e,t,n){return n?ts[e]:Qr(vi(e),vi(t))||HT(Jr(e),Jr(t))?ts[vi(e)]:ts[Jr(e)]}function qT(e,t,n){return n?Gu(e)?zT(e,t)||Qr(e,t)?"h":"v":GT(e,t)||Qr(e,t)?"v":"h":Gu(t)||Qr(vi(e),vi(t))&&Jr(t)?"h":"v"}function tm(e){return I({original:e.point.original||e.point},e.actual)}function Kn(e,t){this._elementRegistry=e,this._graphicsFactory=t}Kn.$inject=["elementRegistry","graphicsFactory"];Kn.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),a=e.waypoints.slice(i.idx+1,r.idx);return a.unshift(tm(i)),a.push(tm(r)),a};Kn.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,r,a,o;return r=n?0:i.length-1,a=i[r],o=this._getIntersection(t,e,n),{point:a,actual:o||a,idx:r}};Kn.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return Fs(i,r,n)};Kn.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};Kn.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};Kn.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var KT={__init__:["modeling","bpmnUpdater"],__depends__:[t1,b1,_1,w1,Ih,S1,P1,M1,L1,nn,td,Sv],bpmnFactory:["type",Lt],bpmnUpdater:["type",gt],elementFactory:["type",Wn],modeling:["type",it],layouter:["type",zu],connectionDocking:["type",Kn]},XT=500,ZT=1250,QT=1500,ns=Math.round;function JT(e){return{x:e.x+ns(e.width/2),y:e.y+ns(e.height/2)}}function nm(e,t,n,i,r){function a(s,c,u,l){return r.allowed("elements.move",{shapes:s,delta:c,position:u,target:l})}e.on("shape.move.start",QT,function(s){var c=s.context,u=s.shape,l=i.get().slice();l.indexOf(u)===-1&&(l=[u]),l=eR(l),I(c,{shapes:l,validatedShapes:l,shape:u})}),e.on("shape.move.start",ZT,function(s){var c=s.context,u=c.validatedShapes,l;if(l=c.canExecute=a(u),!l)return!1}),e.on("shape.move.move",XT,function(s){var c=s.context,u=c.validatedShapes,l=s.hover,p={x:s.dx,y:s.dy},h={x:s.x,y:s.y},f;if(f=a(u,p,h,l),c.delta=p,c.canExecute=f,f===null){c.target=null;return}c.target=l}),e.on("shape.move.end",function(s){var c=s.context,u=c.delta,l=c.canExecute,p=l==="attach",h=c.shapes;if(l===!1)return!1;u.x=ns(u.x),u.y=ns(u.y),!(u.x===0&&u.y===0)&&n.moveElements(h,u,c.target,{primaryShape:c.shape,attach:p})}),e.on("element.mousedown",function(s){if(!!jn(s)){var c=ki(s);if(!c)throw new Error("must supply DOM mousedown event");return o(c,s.element)}});function o(s,c,u,l){if(Ze(u)&&(l=u,u=!1),!(c.waypoints||!c.parent)){var p=JT(c);return t.init(s,p,"shape.move",{cursor:"grabbing",autoActivate:u,data:{shape:c,context:l||{}}}),!0}}this.start=o}nm.$inject=["eventBus","dragging","modeling","selection","rules"];function eR(e){var t=Ei(e,"id");return se(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var im=499,Wu="djs-dragging",rm="drop-ok",am="drop-not-ok",om="new-parent",sm="attach-ok";function cm(e,t,n,i){function r(c){var u=a(c),l=tR(u);return l}function a(c){var u=ma(c,!0),l=Ye(u,function(p){return(p.incoming||[]).concat(p.outgoing||[])});return la(u.concat(l))}function o(c,u){[sm,rm,am,om].forEach(function(l){l===u?t.addMarker(c,l):t.removeMarker(c,l)})}function s(c,u,l){i.addDragger(u,c.dragGroup),l&&t.addMarker(u,Wu),c.allDraggedElements?c.allDraggedElements.push(u):c.allDraggedElements=[u]}e.on("shape.move.start",im,function(c){var u=c.context,l=u.shapes,p=u.allDraggedElements,h=r(l);if(!u.dragGroup){var f=Q("g");H(f,n.cls("djs-drag-group",["no-events"]));var d=t.getActiveLayer();ne(d,f),u.dragGroup=f}h.forEach(function(y){i.addDragger(y,u.dragGroup)}),p?p=la([p,a(l)]):p=a(l),C(p,function(y){t.addMarker(y,Wu)}),u.allDraggedElements=p,u.differentParents=nR(l)}),e.on("shape.move.move",im,function(c){var u=c.context,l=u.dragGroup,p=u.target,h=u.shape.parent,f=u.canExecute;p&&(f==="attach"?o(p,sm):u.canExecute&&p&&p.id!==h.id?o(p,om):o(p,u.canExecute?rm:am)),vt(l,c.dx,c.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(c){var u=c.context,l=u.target;l&&o(l,null)}),e.on("shape.move.cleanup",function(c){var u=c.context,l=u.allDraggedElements,p=u.dragGroup;C(l,function(h){t.removeMarker(h,Wu)}),p&&Be(p)}),this.makeDraggable=s}cm.$inject=["eventBus","canvas","styles","previewSupport"];function tR(e){var t=se(e,function(n){return iR(n)?_e(e,Ht({id:n.source.id}))&&_e(e,Ht({id:n.target.id})):!0});return t}function nR(e){return nr(Ei(e,function(t){return t.parent&&t.parent.id}))!==1}function iR(e){return e.waypoints}var rR={__depends__:[gr,nn,rf,on,bn,Tr],__init__:["move","movePreview"],move:["type",nm],movePreview:["type",cm]},um=".djs-palette-toggle",lm=".entry",aR=um+", "+lm,Uu="djs-palette-",oR="shown",Yu="open",pm="two-column",sR=1e3;function Fe(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var r=i.tool;n.updateToolHighlight(r)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}Fe.$inject=["eventBus","canvas"];Fe.prototype.registerProvider=function(e,t){t||(t=e,e=sR),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};Fe.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(uR,{})};Fe.prototype._rebuild=function(){if(!!this._diagramInitialized){var e=this._getProviders();!e.length||(this._container||this._init(),this._update())}};Fe.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=Ce(Fe.HTML_MARKUP);n.appendChild(i),je(n).add(Uu+oR),_t.bind(i,aR,"click",function(r){var a=r.delegateTarget;if(ha(a,um))return e.toggle();e.trigger("click",r)}),te.bind(i,"mousedown",function(r){r.stopPropagation()}),_t.bind(i,lm,"dragstart",function(r){e.trigger("dragstart",r)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};Fe.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};Fe.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,r,a=je(n),o=je(t);"twoColumn"in e?r=e.twoColumn:r=this._needsCollapse(t.clientHeight,this._entries||{}),a.toggle(pm,r),o.toggle(Uu+pm,r),"open"in e&&(a.toggle(Yu,e.open),o.toggle(Uu+Yu,e.open)),i.fire("palette.changed",{twoColumn:r,open:this.isOpen()})};Fe.prototype._update=function(){var e=Oe(".djs-palette-entries",this._container),t=this._entries=this.getEntries();fa(e),C(t,function(n,i){var r=n.group||"default",a=Oe("[data-group="+r+"]",e);a||(a=Ce('<div class="group" data-group="'+r+'"></div>'),e.appendChild(a));var o=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=Ce(o);a.appendChild(s),n.separator||(xt(s,"data-action",i),n.title&&xt(s,"title",n.title),n.className&&cR(s,n.className),n.imageUrl&&s.appendChild(Ce('<img src="'+n.imageUrl+'">')))}),this.open()};Fe.prototype.trigger=function(e,t,n){var i=this._entries,r,a,o,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();r=i[xt(s,"data-action")],!!r&&(a=r.action,o=t.originalEvent||t,at(a)?e==="click"&&a(o,n):a[e]&&a[e](o,n),t.preventDefault())};Fe.prototype._layoutChanged=function(){this._toggleState({})};Fe.prototype._needsCollapse=function(e,t){var n=20+10+20,i=Object.keys(t).length*46;return e<i+n};Fe.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};Fe.prototype.open=function(){this._toggleState({open:!0})};Fe.prototype.toggle=function(e){this.isOpen()?this.close():this.open()};Fe.prototype.isActiveTool=function(e){return e&&this._activeTool===e};Fe.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=Oe(".djs-palette-entries",this._container),this._toolsContainer=Oe("[data-group=tools]",t)),n=this._toolsContainer,C(n.children,function(i){var r=i.getAttribute("data-action");if(!!r){var a=je(i);r=r.replace("-tool",""),a.contains("entry")&&r===e?a.add("highlighted-entry"):a.remove("highlighted-entry")}})};Fe.prototype.isOpen=function(){return je(this._container).has(Yu)};Fe.prototype._getParentContainer=function(){return this._canvas.getContainer()};Fe.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function cR(e,t){var n=je(e),i=fe(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}function uR(e,t){var n=t.getPaletteEntries();return at(n)?n(e):(C(n,function(i,r){e[r]=i}),e)}var lR={__init__:["palette"],palette:["type",Fe]},fm="crosshair";function mi(e,t,n,i,r,a,o){this._selection=r,this._dragging=n,this._mouse=o;var s=this,c={create:function(u){var l=t.getActiveLayer(),p;p=u.frame=Q("rect"),H(p,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),ne(l,p)},update:function(u){var l=u.frame,p=u.bbox;H(l,{x:p.x,y:p.y,width:p.width,height:p.height})},remove:function(u){u.frame&&Be(u.frame)}};a.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(u){var l=u.originalEvent.target;!u.hover&&!(l instanceof SVGElement)||e.once("lasso.selection.ended",function(){s.activateLasso(u.originalEvent,!0)})}),e.on("lasso.end",function(u){var l=qu(u),p=i.filter(function(h){return h});s.select(p,l)}),e.on("lasso.start",function(u){var l=u.context;l.bbox=qu(u),c.create(l)}),e.on("lasso.move",function(u){var l=u.context;l.bbox=qu(u),c.update(l)}),e.on("lasso.cleanup",function(u){var l=u.context;c.remove(l)}),e.on("element.mousedown",1500,function(u){if(!!ef(u))return s.activateLasso(u.originalEvent),!0})}mi.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];mi.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:fm,data:{context:{}}})};mi.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:fm,data:{context:{}}})};mi.prototype.select=function(e,t){var n=ay(e,t);this._selection.select(ms(n))};mi.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};mi.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function qu(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}var pR={__depends__:[Bo,Pr],__init__:["lassoTool"],lassoTool:["type",mi]},Ku=1500,hm="grab";function qi(e,t,n,i,r,a){this._dragging=n,this._mouse=a;var o=this,s=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",Ku,function(c){if(!!Li(c))return o.activateMove(c.originalEvent,!0),!1}),s&&s.addListener(Ku,function(c){if(!(!dm(c.keyEvent)||o.isActive())){var u=o._mouse.getLastMoveEvent();o.activateMove(u,!!u)}},"keyboard.keydown"),s&&s.addListener(Ku,function(c){!dm(c.keyEvent)||!o.isActive()||o.toggle()},"keyboard.keyup"),e.on("hand.end",function(c){var u=c.originalEvent.target;if(!c.hover&&!(u instanceof SVGElement))return!1;e.once("hand.ended",function(){o.activateMove(c.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(c){var u=t.viewbox().scale;t.scroll({dx:c.dx*u,dy:c.dy*u})}),e.on("hand.move.end",function(c){var u=c.context,l=u.reactivate;return!Li(c)&&l&&e.once("hand.move.ended",function(p){o.activateHand(p.originalEvent,!0,!0)}),!1})}qi.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];qi.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:hm,data:{context:n||{}}})};qi.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:hm,data:{context:{reactivate:n}}})};qi.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};qi.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function dm(e){return Vt(" ",e)}var fR={__depends__:[Bo,Pr],__init__:["handTool"],handTool:["type",qi]},vm="connect-ok",mm="connect-not-ok";function Ki(e,t,n,i,r,a,o){var s=this;this._dragging=t,this._rules=a,this._mouse=o,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(c){var u=c.context,l=c.hover,p=u.canStartConnect=s.canStartConnect(l);p!==null&&(u.startTarget=l,i.addMarker(l,p?vm:mm))}),e.on(["global-connect.out","global-connect.cleanup"],function(c){var u=c.context.startTarget,l=c.context.canStartConnect;u&&i.removeMarker(u,l?vm:mm)}),e.on(["global-connect.ended"],function(c){var u=c.context,l=u.startTarget,p={x:c.x,y:c.y},h=s.canStartConnect(l);if(!!h)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,l,p)}),!1})}Ki.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];Ki.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};Ki.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};Ki.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};Ki.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};var hR={__depends__:[Sc,on,bn,Bo,Pr],globalConnect:["type",Ki]};function Xu(e,t,n,i,r,a,o,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=r,this._handTool=a,this._globalConnect=o,this._translate=s,e.registerProvider(this)}Xu.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];Xu.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,r=this._spaceTool,a=this._lassoTool,o=this._handTool,s=this._globalConnect,c=this._translate;function u(h,f,d,y,x){function D(w){var b=i.createShape(I({type:h},x));x&&(b.businessObject.di.isExpanded=x.isExpanded),n.start(w,b)}var A=h.replace(/^bpmn:/,"");return{group:f,className:d,title:y||c("Create {type}",{type:A}),action:{dragstart:D,click:D}}}function l(h){var f=i.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),d=i.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:f});n.start(h,[f,d],{hints:{autoSelect:[d]}})}function p(h){n.start(h,i.createParticipantShape())}return I(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:c("Activate the hand tool"),action:{click:function(h){o.activateHand(h)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:c("Activate the lasso tool"),action:{click:function(h){a.activateSelection(h)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:c("Activate the create/remove space tool"),action:{click:function(h){r.activateSelection(h)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:c("Activate the global connect tool"),action:{click:function(h){s.start(h)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":u("bpmn:StartEvent","event","bpmn-icon-start-event-none",c("Create StartEvent")),"create.intermediate-event":u("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",c("Create Intermediate/Boundary Event")),"create.end-event":u("bpmn:EndEvent","event","bpmn-icon-end-event-none",c("Create EndEvent")),"create.exclusive-gateway":u("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",c("Create Gateway")),"create.task":u("bpmn:Task","activity","bpmn-icon-task",c("Create Task")),"create.data-object":u("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",c("Create DataObjectReference")),"create.data-store":u("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",c("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:c("Create expanded SubProcess"),action:{dragstart:l,click:l}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:c("Create Pool/Participant"),action:{dragstart:p,click:p}},"create.group":u("bpmn:Group","artifact","bpmn-icon-group",c("Create Group"))}),t};var dR={__depends__:[lR,Qa,Sv,pR,fR,hR,Ba],__init__:["paletteProvider"],paletteProvider:["type",Xu]},vR=250;function Zu(e,t,n,i,r){U.call(this,e);function a(s){var c=s.canExecute.replacements;C(c,function(u){var l=u.oldElementId,p={type:u.newElementType};if(!s.visualReplacements[l]){var h=t.get(l);I(p,{x:h.x,y:h.y});var f=n.createShape(p);i.addShape(f,h.parent);var d=Oe('[data-element-id="'+Ec(h.id)+'"]',s.dragGroup);d&&H(d,{display:"none"});var y=r.addDragger(f,s.dragGroup);s.visualReplacements[l]=y,i.removeShape(f)}})}function o(s){var c=s.visualReplacements;C(c,function(u,l){var p=Oe('[data-element-id="'+Ec(l)+'"]',s.dragGroup);p&&H(p,{display:"inline"}),u.remove(),c[l]&&delete c[l]})}e.on("shape.move.move",vR,function(s){var c=s.context,u=c.canExecute;c.visualReplacements||(c.visualReplacements={}),u&&u.replacements?a(c):o(c)})}Zu.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];Z(Zu,U);var mR={__depends__:[Tr],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Zu]},gR=1250,Qu=40,yR=20,ER=10,gm=20,ym=["x","y"],bR=Math.abs;function Em(e){e.on(["connect.hover","connect.move","connect.end"],gR,function(t){var n=t.context,i=n.canExecute,r=n.start,a=n.hover,o=n.source,s=n.target;t.originalEvent&&Rt(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&a&&xR(t,a,TR(a)),a&&SR(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=Dt(r),ye(a,["bpmn:Event","bpmn:Gateway"])&&bm(t,Dt(a)),ye(a,["bpmn:Task","bpmn:SubProcess"])&&_R(t,a),m(o,"bpmn:BoundaryEvent")&&s===o.host&&wR(t)):xm(i,"bpmn:MessageFlow")?(m(r,"bpmn:Event")&&(n.connectionStart=Dt(r)),m(a,"bpmn:Event")&&bm(t,Dt(a))):n.connectionStart=n.initialConnectionStart)})}Em.$inject=["eventBus"];function xR(e,t,n){ym.forEach(function(i){var r=_m(i,t);e[i]<t[i]+n?ze(e,i,t[i]+n):e[i]>t[i]+r-n&&ze(e,i,t[i]+r-n)})}function _R(e,t){var n=Dt(t);ym.forEach(function(i){RR(e,t,i)&&ze(e,i,n[i])})}function wR(e){var t=e.context,n=t.source,i=t.target;if(!CR(t)){var r=Dt(n),a=Je(r,i,-10),o=[];/top|bottom/.test(a)&&o.push("x"),/left|right/.test(a)&&o.push("y"),o.forEach(function(s){var c=e[s],u;bR(c-r[s])<Qu&&(c>r[s]?u=r[s]+Qu:u=r[s]-Qu,ze(e,s,u))})}}function bm(e,t){ze(e,"x",t.x),ze(e,"y",t.y)}function xm(e,t){return e&&e.type===t}function SR(e,t){return Jn(t,function(n){return xm(e,n)})}function _m(e,t){return e==="x"?t.width:t.height}function TR(e){return m(e,"bpmn:Task")?ER:yR}function RR(e,t,n){return e[n]>t[n]+gm&&e[n]<t[n]+_m(n,t)-gm}function CR(e){var t=e.hover,n=e.source;return t&&n&&t===n}function Xn(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}Xn.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};Xn.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};Xn.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};Xn.prototype.getSnapLocations=function(){return this._snapLocations};Xn.prototype.setSnapLocations=function(e){this._snapLocations=e};Xn.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new is,n.initDefaults(this._defaultSnaps)),n};function is(e){this._snapValues={}}is.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};is.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&H_(e[n],r[n],i)};is.prototype.initDefaults=function(e){var t=this;C(e||{},function(n,i){C(n,function(r){t.add(i,r)})})};var PR=1250;function cn(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(r){i.initSnap(r)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],PR,function(r){var a=r.context,o=a.shape,s=a.snapContext,c=a.target;if(!(r.originalEvent&&Rt(r.originalEvent))&&!(zi(r)||!c)){var u=s.pointsForTarget(c);u.initialized||(u=i.addSnapTargetPoints(u,o,c),u.initialized=!0),n.snap(r,u)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}cn.$inject=["elementRegistry","eventBus","snapping"];cn.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,r=n.snapContext;r||(r=n.snapContext=new Xn);var a;t.get(i.id)?a=Dt(i,e):a={x:e.x+Dt(i).x,y:e.y+Dt(i).y};var o={x:a.x-i.width/2,y:a.y-i.height/2},s={x:a.x+i.width/2,y:a.y+i.height/2};return r.setSnapOrigin("mid",{x:a.x-e.x,y:a.y-e.y}),Ju(i)||(r.setSnapOrigin("top-left",{x:o.x-e.x,y:o.y-e.y}),r.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),r};cn.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return C(i,function(r){if(Ju(r)){Ju(t)&&e.add("mid",Dt(r));return}if(AR(r)){if(r.waypoints.length<3)return;var a=r.waypoints.slice(1,-1);C(a,function(o){e.add("mid",o)});return}e.add("mid",Dt(r))}),!ae(t.x)||!ae(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",Dt(t)),e};cn.prototype.getSnapTargets=function(e,t){return ah(t).filter(function(n){return!MR(n)})};function AR(e){return!!e.waypoints}function MR(e){return!!e.hidden}function Ju(e){return!!e.labelTarget}var wm=1500;function Xi(e,t){t.invoke(cn,this),e.on(["create.move","create.end"],wm,IR),e.on(["create.move","create.end","shape.move.move","shape.move.end"],wm,function(n){var i=n.context,r=i.canExecute,a=i.target,o=r&&(r==="attach"||r.attach);o&&!zi(n)&&DR(n,a)})}Z(Xi,cn);Xi.$inject=["eventBus","injector"];Xi.prototype.initSnap=function(e){var t=cn.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return C(n.outgoing,function(r){var a=r.waypoints[0];a=a.original||a,t.setSnapOrigin(r.id+"-docking",Tm(a,i,e))}),C(n.incoming,function(r){var a=r.waypoints[r.waypoints.length-1];a=a.original||a,t.setSnapOrigin(r.id+"-docking",Tm(a,i,e))}),m(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};Xi.prototype.addSnapTargetPoints=function(e,t,n){cn.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);C(i,function(a){(OR(a)||NR([t,a],"bpmn:TextAnnotation"))&&(e.add("top-left",ih(a)),e.add("bottom-right",rh(a)))});var r=this._elementRegistry;return C(t.incoming,function(a){if(r.get(t.id)){Sm(i,a.source)||e.add("mid",ce(a.source));var o=a.waypoints[0];e.add(a.id+"-docking",o.original||o)}}),C(t.outgoing,function(a){if(r.get(t.id)){Sm(i,a.target)||e.add("mid",ce(a.target));var o=a.waypoints[a.waypoints.length-1];e.add(a.id+"-docking",o.original||o)}}),m(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};Xi.prototype.getSnapTargets=function(e,t){return cn.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!m(n,"bpmn:Lane")})};function DR(e,t){var n=ee(t),i=Kd(e,t),r=e.context,a=r.shape,o;a.parent?o={x:0,y:0}:o=ce(a),/top/.test(i)?ze(e,"y",n.top-o.y):/bottom/.test(i)&&ze(e,"y",n.bottom-o.y),/left/.test(i)?ze(e,"x",n.left-o.x):/right/.test(i)&&ze(e,"x",n.right-o.x)}function NR(e,t){return e.every(function(n){return m(n,t)})}function OR(e){return m(e,"bpmn:SubProcess")&&Se(e)?!0:m(e,"bpmn:Participant")}function IR(e){var t=e.context,n=t.createConstraints;if(!!n){var i=n.top,r=n.right,a=n.bottom,o=n.left;(o&&o>=e.x||r&&r<=e.x)&&ze(e,"x",e.x),(i&&i>=e.y||a&&a<=e.y)&&ze(e,"y",e.y)}}function Sm(e,t){return e.indexOf(t)!==-1}function Tm(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var kR=1250;function ea(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],kR,function(i){var r=i.context,a=r.shape,o=a.parent,s=r.direction,c=r.snapContext;if(!(i.originalEvent&&Rt(i.originalEvent))&&!zi(i)){var u=c.pointsForTarget(o);u.initialized||(u=n.addSnapTargetPoints(u,a,o,s),u.initialized=!0),jR(s)&&ze(i,"x",i.x),HR(s)&&ze(i,"y",i.y),t.snap(i,u)}}),e.on(["resize.cleanup"],function(){t.hide()})}ea.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=t.snapContext;r||(r=t.snapContext=new Xn);var a=Rm(n,i);return r.setSnapOrigin("corner",{x:a.x-e.x,y:a.y-e.y}),r};ea.prototype.addSnapTargetPoints=function(e,t,n,i){var r=this.getSnapTargets(t,n);return C(r,function(a){e.add("corner",rh(a)),e.add("corner",ih(a))}),e.add("corner",Rm(t,i)),e};ea.$inject=["eventBus","snapping"];ea.prototype.getSnapTargets=function(e,t){return ah(t).filter(function(n){return!LR(n,e)&&!BR(n)&&!$R(n)&&!FR(n)})};function Rm(e,t){var n=ce(e),i=ee(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function LR(e,t){return e.host===t}function BR(e){return!!e.waypoints}function $R(e){return!!e.hidden}function FR(e){return!!e.labelTarget}function jR(e){return e==="n"||e==="s"}function HR(e){return e==="e"||e==="w"}var zR=7,GR=1e3;function Zn(e){this._canvas=e,this._asyncHide=Rl(pt(this.hide,this),GR)}Zn.$inject=["canvas"];Zn.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,r=i.getSnapLocations(),a={x:zi(e,"x"),y:zi(e,"y")};C(r,function(o){var s=i.getSnapOrigin(o),c={x:e.x+s.x,y:e.y+s.y};if(C(["x","y"],function(u){var l;a[u]||(l=t.snap(c,o,u,zR),l!==void 0&&(a[u]={value:l,originValue:l-s[u]}))}),a.x&&a.y)return!1}),this.showSnapLine("vertical",a.x&&a.x.value),this.showSnapLine("horizontal",a.y&&a.y.value),C(["x","y"],function(o){var s=a[o];Ze(s)&&ze(e,o,s.originValue)})};Zn.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=Q("path");return H(n,{d:"M0,0 L0,0"}),he(n).add("djs-snap-line"),ne(t,n),{update:function(i){ae(i)?e==="horizontal"?H(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):H(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):H(n,{display:"none"})}}};Zn.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};Zn.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};Zn.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};Zn.prototype.hide=function(){C(this._snapLines,function(e){e.update()})};var VR={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",cn],resizeSnapping:["type",ea],snapping:["type",Zn]},WR={__depends__:[VR],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",Em],createMoveSnapping:["type",Xi]};function ie(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=Ce(ie.BOX_HTML),this._searchInput=Oe(ie.INPUT_SELECTOR,this._container),this._resultsContainer=Oe(ie.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}ie.$inject=["canvas","eventBus","overlays","selection"];ie.prototype._bindEvents=function(){var e=this;function t(n,i,r,a){e._eventMaps.push({el:n,type:r,listener:_t.bind(n,i,r,a)})}t(document,"html","click",function(n){e.close()}),t(this._container,ie.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,ie.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,ie.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,ie.INPUT_SELECTOR,"keydown",function(n){n.keyCode===38&&n.preventDefault(),n.keyCode===40&&n.preventDefault()}),t(this._container,ie.INPUT_SELECTOR,"keyup",function(n){if(n.keyCode===27)return e.close();if(n.keyCode===13){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(n.keyCode===38)return e._scrollToDirection(!0);if(n.keyCode===40)return e._scrollToDirection();n.keyCode===37||n.keyCode===39||e._search(n.delegateTarget.value)})};ie.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){_t.unbind(e.el,e.type,e.listener)})};ie.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(!!n.length){n.forEach(function(r){var a=r.element.id,o=t._createResultNode(r,a);t._results[a]={element:r.element,node:o}});var i=Oe(ie.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};ie.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(!!t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};ie.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};ie.prototype._clearResults=function(){fa(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};ie.prototype._getCurrentResult=function(){return Oe(ie.RESULT_SELECTED_SELECTOR,this._resultsContainer)};ie.prototype._createResultNode=function(e,t){var n=Ce(ie.RESULT_HTML);return e.primaryTokens.length>0&&Cm(n,e.primaryTokens,ie.RESULT_PRIMARY_HTML),Cm(n,e.secondaryTokens,ie.RESULT_SECONDARY_HTML),xt(n,ie.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};ie.prototype.registerProvider=function(e){this._searchProvider=e};ie.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,je(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};ie.prototype.close=function(){!this.isOpen()||(this._unbindEvents(),this._open=!1,je(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};ie.prototype.toggle=function(){this.isOpen()?this.close():this.open()};ie.prototype.isOpen=function(){return this._open};ie.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&je(t).remove(ie.RESULT_SELECTED_CLASS);var n=xt(e,ie.RESULT_ID_ATTRIBUTE),i=this._results[n].element;je(e).add(ie.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};ie.prototype._select=function(e){var t=xt(e,ie.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};ie.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=Qe(e),n=UR(t);this._overlayId=this._overlays.add(e,n)}};function UR(e){var t=6,n=e.width+t*2,i=e.height+t*2,r=["width: "+n+"px","height: "+i+"px"].join("; ");return{position:{bottom:i-t,right:n-t},show:!0,html:'<div style="'+r+'" class="'+ie.OVERLAY_CLASS+'"></div>'}}function Cm(e,t,n){var i=YR(t),r=Ce(n);r.innerHTML=i,e.appendChild(r)}function YR(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+ie.RESULT_HIGHLIGHT_CLASS+'">'+Hf(n.matched)+"</strong>":t+=Hf(n.normal)}),t!==""?t:null}ie.CONTAINER_SELECTOR=".djs-search-container";ie.INPUT_SELECTOR=".djs-search-input input";ie.RESULTS_CONTAINER_SELECTOR=".djs-search-results";ie.RESULT_SELECTOR=".djs-search-result";ie.RESULT_SELECTED_CLASS="djs-search-result-selected";ie.RESULT_SELECTED_SELECTOR="."+ie.RESULT_SELECTED_CLASS;ie.RESULT_ID_ATTRIBUTE="data-result-id";ie.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";ie.OVERLAY_CLASS="djs-search-overlay";ie.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';ie.RESULT_HTML='<div class="djs-search-result"></div>';ie.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';ie.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var qR={__depends__:[nc,nn],searchPad:["type",ie]};function el(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}el.$inject=["elementRegistry","searchPad","canvas"];el.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=se(n,function(i){return i!==t}),n=Ye(n,function(i){return{primaryTokens:Am(Gt(i),e),secondaryTokens:Am(i.id,e),element:i}}),n=se(n,function(i){return Pm(i.primaryTokens)||Pm(i.secondaryTokens)}),n=jt(n,function(i){return Gt(i.element)+i.element.id}),n};function Pm(e){var t=se(e,function(n){return!!n.matched});return t.length>0}function Am(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(r!==0&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}var KR={__depends__:[qR],__init__:["bpmnSearch"],bpmnSearch:["type",el]},XR='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function un(e){dr.call(this,e)}Z(un,dr);un.Viewer=Hn;un.NavigatedViewer=br;un.prototype.createDiagram=Di(function(){return this.importXML(XR)});un.prototype._interactionModules=[df,yf,Xx,xf];un.prototype._modelingModules=[Qx,d_,R_,b_,G_,Sc,K_,ew,Mh,Qa,iw,ow,ww,Rw,Cw,Nw,Gw,KT,rR,dR,mR,sd,WR,KR];un.prototype._modules=[].concat(Hn.prototype._modules,un.prototype._interactionModules,un.prototype._modelingModules);const qt=sg({activeElement:null,businessObject:null,activeBindDefine:null,isActive:!1});function Mm(e,t){if(!qt||!t)return;qt.activeElement=t;const n=e.get(t.element.id);qt.businessObject=n?n.businessObject:{},qt.isActive=!0,qt.activeBindDefine=null}const Dm={modeler:null,state:qt,getState(){return this.state},initModeler(e){this.modeler=new un(e);const t=this.modeler.get("elementRegistry");["element.click","shape.added"].forEach(n=>{Dm.addEventListener(n,function(i){const r=i.element||i.context.element;r&&(!qt.activeElement||qt.activeElement.id!==r.id)&&(qt.businessObject=null,wl().then(()=>{Mm(t,i)}))})})},getModeler(){return this.modeler},refresh(){qt.businessObject=null,wl().then(()=>{Mm(this.modeler.get("elementRegistry"),qt.activeElement)})},getShape(){return this.getShapeById(this.getState().activeElement.element.id)},getShapeById(e){return this.getModeler().get("elementRegistry").get(e)},getBpmnFactory(){return this.modeler.get("bpmnFactory")},createElement(e,t,n,i){const r=this.getBpmnFactory().create(e,n);this.getModeling().updateProperties(this.getShape(),{[t]:i?[r]:r})},importXML(e){return this.modeler.importXML(e)},getXML(){return new Promise((e,t)=>{this.getModeler().saveXML({format:!0}).then(n=>{e(n)}).catch(n=>{t(n)})})},getSVG(){return new Promise((e,t)=>{this.getModeler().saveSVG().then(n=>{e(n)}).catch(n=>{t(n)})})},getModeling(){return this.getModeler().get("modeling")},getActiveElement(){return this.getState().activeElement},getActiveElementName(){return""},getBusinessObject(){return this.getState().businessObject},addEventListener(e,t){this.getModeler().get("eventBus").on(e,function(n){t(n)})},updateExtensionElements(e,t){var s,c;const n=this.getModeler().get("moddle"),i=this.getShape(),r=(s=this.getBusinessObject())==null?void 0:s.extensionElements,a=((c=r==null?void 0:r.values)==null?void 0:c.filter(u=>u.$type!==e).map(u=>cg(u)))||[],o=n.create("bpmn:ExtensionElements",{values:a.concat(t instanceof Array?t:[t])});this.getModeling().updateProperties(i,{extensionElements:o})}},ZR=vg("div",{id:"modeler-container",style:{height:"1000px"}},null,-1),QR={name:"WfDemo1",inheritAttrs:!1};function JR(e){const t=`<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="sid-38422fae-e03e-43a3-bef4-bd33b32041b2" targetNamespace="http://bpmn.io/bpmn" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="5.1.2">
<process id="Process_1" isExecutable="false">
    <startEvent id="StartEvent_1y45yut" name="\u5F00\u59CB">
    <outgoing>SequenceFlow_0h21x7r</outgoing>
    </startEvent>
    <task id="Task_1hcentk">
    <incoming>SequenceFlow_0h21x7r</incoming>
    </task>
    <sequenceFlow id="SequenceFlow_0h21x7r" sourceRef="StartEvent_1y45yut" targetRef="Task_1hcentk" />
</process>
<bpmndi:BPMNDiagram id="BpmnDiagram_1">
    <bpmndi:BPMNPlane id="BpmnPlane_1" bpmnElement="Process_1">
    <bpmndi:BPMNShape id="StartEvent_1y45yut_di" bpmnElement="StartEvent_1y45yut">
        <omgdc:Bounds x="152" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
        <omgdc:Bounds x="160" y="145" width="22" height="14" />
        </bpmndi:BPMNLabel>
    </bpmndi:BPMNShape>
    <bpmndi:BPMNShape id="Task_1hcentk_di" bpmnElement="Task_1hcentk">
        <omgdc:Bounds x="240" y="80" width="100" height="80" />
    </bpmndi:BPMNShape>
    <bpmndi:BPMNEdge id="SequenceFlow_0h21x7r_di" bpmnElement="SequenceFlow_0h21x7r">
        <omgdi:waypoint x="188" y="120" />
        <omgdi:waypoint x="240" y="120" />
    </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
</bpmndi:BPMNDiagram>
</definitions>`,n=Dm;return lg(()=>{n.initModeler({container:"#modeler-container"}),n.importXML(t).then(i=>{i.length&&console.warn("importSuccess warnings",i)}).catch(i=>{console.warn("importFail errors ",i)})}),(i,r)=>(pg(),fg(dg(og),{class:"ztable",contentFullHeight:""},{default:hg(()=>[ZR]),_:1}))}const uC=ug(xl(bl({},QR),{setup:JR}));export{uC as default};
