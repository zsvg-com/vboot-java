var H=Object.defineProperty,$=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var k=(m,r,a)=>r in m?H(m,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):m[r]=a,j=(m,r)=>{for(var a in r||(r={}))N.call(r,a)&&k(m,a,r[a]);if(A)for(var a of A(r))J.call(r,a)&&k(m,a,r[a]);return m},R=(m,r)=>$(m,O(r));var C=(m,r,a)=>new Promise((h,F)=>{var w=_=>{try{f(a.next(_))}catch(c){F(c)}},v=_=>{try{f(a.throw(_))}catch(c){F(c)}},f=_=>_.done?h(_.value):Promise.resolve(_.value).then(w,v);f((a=a.apply(m,r)).next())});import{A as P,P as D,a0 as g,B as S,a1 as T,a6 as o,w as e,u as s,a4 as q,r as W,H as U,J as I,F as z,G,bF as L,ae as B,bA as E}from"./vendor.8e08a5be.js";import{P as M}from"./index.4a6d20cf.js";import{u as X,B as K,a as Q}from"./index.b3a760e0.js";import{ah as y,k as Y}from"./index.1f50be75.js";import{h as Z}from"./edit.6fd2a5d5.js";import{a as ee,d as te,e as ae}from"./list.20bccedc.js";/* empty css               *//* empty css                */import"./useWindowSizeFn.2016176c.js";import"./useContentViewHeight.78015564.js";/* empty css               */const ue=P({emits:["success","register"],setup(m,{emit:r}){const a=D({loadingText:"",url:"/sys/job/main",data:{},rules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}]}}),[h,{setDrawerProps:F,changeLoading:w,closeDrawer:v}]=X(f=>C(this,null,function*(){a.loadingText="\u52A0\u8F7D\u4E2D",w(!0),f.record.id?a.data=yield y.get({url:a.url+"/one/"+f.record.id}):(a.data=f.record,a.data.avtag=!0),w(!1)}));return(f,_)=>{const c=g("vxe-input"),p=g("vxe-form-item"),u=g("vxe-radio"),l=g("vxe-radio-group"),x=g("vxe-textarea"),d=g("vxe-option"),V=g("vxe-select"),i=g("vxe-switch"),b=g("vxe-form");return S(),T(s(K),q(f.$attrs,{loadingText:s(a).loadingText,showFooter:"",title:"\u5B9A\u65F6\u4EFB\u52A1",width:"70%",onOk:_[0]||(_[0]=t=>s(Z)(f.$refs.xForm,s(a),r,s(F),s(w),s(v))),onRegister:s(h)}),{default:o(()=>[e(b,{"title-colon":"",ref:(t,n)=>{n.xForm=t},"title-align":"right","title-width":"100",data:s(a).data,rules:s(a).rules},{default:o(()=>[e(p,{title:"\u4EFB\u52A1\u540D\u79F0",field:"name","item-render":{},span:"12","title-width":"150"},{default:o(({data:t})=>[e(c,{modelValue:t.name,"onUpdate:modelValue":n=>t.name=n,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u4EFB\u52A1\u4EE3\u7801",field:"code","item-render":{},span:"12","title-width":"150"},{default:o(({data:t})=>[e(c,{modelValue:t.code,"onUpdate:modelValue":n=>t.code=n,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u8BF7\u6C42\u7C7B\u578B",field:"retyp","item-render":{},span:"12","title-width":"150"},{default:o(t=>[e(l,{modelValue:t.data.retyp,"onUpdate:modelValue":n=>t.data.retyp=n},{default:o(()=>[e(u,{label:0,content:"Run"}),e(u,{label:1,content:"Get"}),e(u,{label:2,content:"Post"}),e(u,{label:3,content:"Put"}),e(u,{label:4,content:"Delete"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u4EFB\u52A1\u8868\u8FBE\u5F0F",field:"cron","item-render":{},span:"12","title-width":"150"},{default:o(({data:t})=>[e(c,{modelValue:t.cron,"onUpdate:modelValue":n=>t.cron=n,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u8BF7\u6C42\u5730\u5740",field:"reurl","item-render":{},span:"24","title-width":"150"},{default:o(({data:t})=>[e(c,{modelValue:t.reurl,"onUpdate:modelValue":n=>t.reurl=n,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u8BF7\u6C42\u5934",field:"rehea","item-render":{},span:"24","title-width":"150"},{default:o(({data:t})=>[e(c,{modelValue:t.rehea,"onUpdate:modelValue":n=>t.rehea=n,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u8BF7\u6C42\u53C2\u6570",field:"repar","item-render":{},span:"24","title-width":"150"},{default:o(({data:t})=>[e(x,{modelValue:t.repar,"onUpdate:modelValue":n=>t.repar=n,autosize:{minRows:4,maxRows:6},clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u6267\u884C\u7C7B\u578B",field:"extyp","item-render":{},span:"12","title-width":"150"},{default:o(({data:t})=>[e(V,{modelValue:t.extyp,"onUpdate:modelValue":n=>t.extyp=n},{default:o(()=>[e(d,{value:0,label:"\u5E76\u884C\u6267\u884C"}),e(d,{value:1,label:"\u4E32\u884C\u6267\u884C"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u4EFB\u52A1\u5907\u6CE8",field:"notes","item-render":{},span:"24","title-width":"150"},{default:o(({data:t})=>[e(x,{modelValue:t.notes,"onUpdate:modelValue":n=>t.notes=n,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",autosize:{minRows:4,maxRows:6},clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u662F\u5426\u53EF\u7528",field:"avtag","item-render":{},span:"12","title-width":"150"},{default:o(({data:t})=>[e(i,{modelValue:t.avtag,"onUpdate:modelValue":n=>t.avtag=n,"open-label":"\u662F","close-label":"\u5426"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{title:"\u6392\u5E8F\u53F7",field:"ornum","item-render":{},span:"12","title-width":"150"},{default:o(({data:t})=>[e(c,{modelValue:t.ornum,"onUpdate:modelValue":n=>t.ornum=n,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","rules"])]),_:1},16,["loadingText","onRegister"])}}}),oe=B("\u67E5 \u8BE2"),le=B("\u65B0 \u589E"),ne=B("\u5220 \u9664"),ie=B("\u542F \u7528"),se=B("\u7981 \u7528"),re=["onClick"],de={class:"ant-tag ant-tag-success"},me={class:"ant-tag ant-tag-warning"},ce={name:"SysJobMain",inheritAttrs:!1};function pe(m){const r=W({}),a=D({name:""});Y();const h=D({id:"/sys/job/main",highlightHoverRow:!0,checkboxConfig:{},height:"auto",pagerConfig:{pageSize:window.innerHeight<610?8:window.innerHeight>900?16:10},toolbarConfig:{slots:{buttons:"tbtns"}},proxyConfig:{ajax:{query:({page:u})=>{const l=Object.assign({},a);return l.page=`${u.currentPage}`,l.pageSize=`${u.pageSize}`,y.get({url:"/sys/job/main",params:l})}}},columns:[{type:"checkbox",align:"center",width:42,fixed:"left"},{type:"seq",align:"center",width:50,fixed:"left"},{field:"name",title:"\u4EFB\u52A1\u540D\u79F0",width:200,fixed:"left",slots:{default:"name_default"}},{field:"code",title:"\u4EFB\u52A1\u4EE3\u7801",width:200},{field:"reurl",title:"\u8BF7\u6C42\u5730\u5740",width:200},{field:"cron",title:"\u6267\u884C\u8868\u8FBE\u5F0F",width:200},{field:"crtim",title:"\u521B\u5EFA\u65F6\u95F4",width:140},{field:"avtag",title:"\u72B6\u6001",width:60,align:"center",slots:{default:"avtag_default"}},{field:"notes",title:"\u5907\u6CE8"},{title:"\u64CD\u4F5C",width:60,align:"center",slots:{default:"operate"}}]}),F=()=>{r.value.commitProxy("query")},w=u=>C(this,null,function*(){(yield E.modal.confirm("\u786E\u5B9A\u7ACB\u5373\u6267\u884C\u4E00\u6B21\u5417\uFF1F"))==="confirm"&&(yield y.post({url:"/sys/job/main/once/"+u}))}),v=u=>C(this,null,function*(){let l=u.id;u.params&&u.params.url&&(l=u.params.url);const x=u.getCheckboxRecords();if(x.length==0){yield E.modal.message({content:"\u8BF7\u9009\u62E9\u540E\u518D\u8FDB\u884C\u542F\u52A8",status:"warning"});return}let d="";for(const i of x)d+=i.id+",";(yield E.modal.confirm("\u60A8\u786E\u5B9A\u8981\u542F\u52A8\u5417\uFF1F"))==="confirm"&&(yield y.post({url:l+"/start/"+d.substr(0,d.length-1)}),yield u.commitProxy("query"))}),f=u=>C(this,null,function*(){let l=u.id;u.params&&u.params.url&&(l=u.params.url);const x=u.getCheckboxRecords();if(x.length==0){yield E.modal.message({content:"\u8BF7\u9009\u62E9\u540E\u518D\u8FDB\u884C\u7981\u7528",status:"warning"});return}let d="";for(const i of x)d+=i.id+",";(yield E.modal.confirm("\u60A8\u786E\u5B9A\u8981\u7981\u7528\u5417\uFF1F"))==="confirm"&&(yield y.post({url:l+"/stop/"+d.substr(0,d.length-1)}),yield u.commitProxy("query"))}),[_,{openDrawer:c}]=Q();function p(){F()}return(u,l)=>{const x=g("vxe-input"),d=g("vxe-button"),V=g("vxe-grid");return S(),T(s(M),{class:"ztable",contentFullHeight:""},{default:o(()=>[e(V,q({ref:(i,b)=>{b.xGrid=i,r.value=i}},s(h)),{tbtns:o(()=>[e(x,{modelValue:s(a).name,"onUpdate:modelValue":l[0]||(l[0]=i=>s(a).name=i),placeholder:"\u8F93\u5165\u540D\u79F0\u67E5\u8BE2"},null,8,["modelValue"]),e(d,{onClick:F,status:"primary"},{default:o(()=>[oe]),_:1}),e(d,{onClick:l[1]||(l[1]=i=>s(ee)({},s(c)))},{default:o(()=>[le]),_:1}),e(d,{onClick:l[2]||(l[2]=i=>s(te)(u.$refs.xGrid))},{default:o(()=>[ne]),_:1}),e(d,{onClick:l[3]||(l[3]=i=>v(u.$refs.xGrid))},{default:o(()=>[ie]),_:1}),e(d,{onClick:l[4]||(l[4]=i=>f(u.$refs.xGrid))},{default:o(()=>[se]),_:1})]),name_default:o(({row:i})=>[U("span",{style:{cursor:"pointer",color:"#3e9ece"},onClick:b=>s(ae)({id:i.id},s(c))},I(i.name),9,re)]),avtag_default:o(({row:i})=>[z(U("span",de,"\u542F\u7528",512),[[G,i.avtag===!0]]),z(U("span",me,"\u7981\u7528",512),[[G,i.avtag===!1]])]),operate:o(({row:i})=>[e(s(L),{onClick:b=>w(i.id),style:{"font-size":"15px"},title:"\u7ACB\u5373\u6267\u884C\u4E00\u6B21"},null,8,["onClick"])]),_:1},16),e(ue,{onRegister:s(_),onSuccess:p},null,8,["onRegister"])]),_:1})}}const Ee=P(R(j({},ce),{setup:pe}));export{Ee as default};
